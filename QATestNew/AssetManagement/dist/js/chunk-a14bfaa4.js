(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a14bfaa4"],{"0936":function(t,e,a){var i=a("bff4");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var s=a("499e").default;s("ecd20a66",i,!0,{sourceMap:!1,shadowMode:!1})},"924b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("section",{staticClass:"main-content"},[e("div",{staticClass:"theme-primary partition"},[e("span",{staticClass:"p-name text-white"},[t._v(" "+t._s(t.$t("NewProductTypeRequest"))+" ")]),e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white",attrs:{href:"/AssetRequisition/NewAssetRequisitionListing","data-toggle-tooltip":"tooltip","data-original-title":"Back to list"}},[e("i",{staticClass:"fa fa-angle-double-left pr-2"}),e("br"),e("span",[t._v(t._s(t.$t("Backtolist")))])])])]),e("div",{staticClass:"border p-3"},[e("Form",{ref:"AddReqForm"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 px-0"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Location"))),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{staticClass:"w-100",attrs:{name:"Location",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("tree-view",{class:{"is-invalid":a[0]},attrs:{options:t.options,placeholder:"Select Location","show-count":!0},model:{value:t.LocationValue,callback:function(e){t.LocationValue=e},expression:"LocationValue"}}),a[0]?e("span",{staticClass:"invalid-feedback d-block",attrs:{name:"Location"}},[t._v(t._s(a[0]))]):t._e()]}}])})],1)]),e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("ProductName"))),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"Product Name",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.txtproductName,expression:"txtproductName"}],class:{"form-control":!0,"is-invalid":a[0]},attrs:{maxlength:"100",type:"text"},domProps:{value:t.txtproductName},on:{input:function(e){e.target.composing||(t.txtproductName=e.target.value)}}}),a[0]?e("span",{staticClass:"invalid-feedback d-block",attrs:{name:"Product Name"}},[t._v(t._s(a[0]))]):t._e()]}}])})],1)]),e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("ProductType")))]),e("Field",{staticClass:"w-100",attrs:{name:"AssetTypeId"}},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedProductValue,expression:"selectedProductValue"}],staticClass:"form-control",attrs:{name:"AssetTypeId"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedProductValue=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v(t._s(t.$t("Select")))]),t._l(t.AssetType,(function(a){return e("option",{key:a,domProps:{value:a.ASSETID}},[t._v(" "+t._s(a.ASSETTYPE)+" ")])}))],2)])],1)]),e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("RequestedQuantity"))),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"Quantity",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.txtrequestQuantity,expression:"txtrequestQuantity"}],class:{"form-control":!0,"is-invalid":a[0]},attrs:{type:"number",min:"1",maxlength:"8"},domProps:{value:t.txtrequestQuantity},on:{input:function(e){e.target.composing||(t.txtrequestQuantity=e.target.value)}}}),a[0]?e("span",{staticClass:"invalid-feedback d-block",attrs:{name:"Quantity"}},[t._v(t._s(a[0]))]):t._e()]}}])})],1)])])]),e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 px-0"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"Description"}},[t._v(t._s(t.$t("Description"))),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{staticClass:"w-100",attrs:{name:"description",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:a}){return[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.txtDescription,expression:"txtDescription"}],staticClass:"form-control",class:{"form-control":!0,"is-invalid":a[0]},attrs:{name:"description",type:"text",placeholder:"Description",rows:"5",maxlength:"250"},domProps:{value:t.txtDescription},on:{input:function(e){e.target.composing||(t.txtDescription=e.target.value)}}}),a[0]?e("span",{staticClass:"invalid-feedback d-block",attrs:{name:"description"}},[t._v(t._s(a[0]))]):t._e()]}}])})],1)]),e("AddQuotes",{on:{quotes:t.quotes,quoteItemDelete:t.quoteItemDelete}})],1),e("OnlinePurchase",{on:{purchases:t.purchases,purchaseDeleteItem:t.purchaseDeleteItem,purchaseLinkDeleteItem:t.purchaseLinkDeleteItem}}),e("div",{staticClass:"col-lg-12 mb-3"},[e("div",{staticClass:"row flex-row-reverse"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success pr-2 mr-2",attrs:{href:"javascript:;"},on:{click:function(e){return t.saveNewRequisition(t.values,t.errors,"ACT")}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save")))]),e("a",{staticClass:"btn btn-success pr-2 mr-2",attrs:{href:"javascript:;"},on:{click:function(e){return t.saveNewRequisitionAsDraft("Draft")}}},[e("i",{staticClass:"fa fa-save pr-2"}),t._v(" Save As Draft ")]),e("a",{staticClass:"btn btn-danger mr-2",attrs:{href:"/AssetRequisition/NewAssetRequisitionListing","data-original-title":"Cancel"}},[e("i",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel")))])]),e("div",{staticClass:"col-lg-6 py-2"},[e("span",{staticClass:"mandatory"},[t._v(t._s(t.$t("Required")))])])])])],1)])},s=[],r=(a("14d9"),function(){var t=this,e=t._self._c;return e("section",[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"col-lg-12 mt-3 px-0"},[e("div",{staticClass:"heading-border mb-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v("Add Quotes")]),e("small",{staticClass:"float-right"},[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.addRow()}}},[e("i",{staticClass:"fa fa-plus pr-1"}),t._v("Add Row ")])])])]),e("Form",{ref:"AddQuoteForm"},t._l(t.newDynamicField,(function(a,i){return e("div",{key:i,staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-3 px-0"},[e("div",{staticClass:"row addQuoteRows"},[e("div",{staticClass:"col-lg-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Vendor:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{staticClass:"w-100",attrs:{name:"Vendor"+(i+1),rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("select",{directives:[{name:"model",rawName:"v-model",value:a.getVenderValue,expression:"item.getVenderValue"}],class:{"Vendor form-control w-100":!0,"is-invalid":i[0]},attrs:{name:"Vendor"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"getVenderValue",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:""}},[t._v("Select")]),t._l(t.venderList,(function(a){return e("option",{key:a,domProps:{value:a.Value}},[t._v(" "+t._s(a.Text)+" ")])}))],2)]}}],null,!0)}),e("input",{directives:[{name:"model",rawName:"v-model",value:a.quoteId,expression:"item.quoteId"}],staticClass:"hdnquoteId",attrs:{type:"hidden",value:"0"},domProps:{value:a.quoteId},on:{input:function(e){e.target.composing||t.$set(a,"quoteId",e.target.value)}}})],1)])]),e("div",{staticClass:"input-group-append",staticStyle:{cursor:"pointer"}},[e("span",{staticClass:"input-group-text border-0 bg-transparent p-0 pl-2"},[e("a",{staticClass:"round-icon-small btn-dark theme-primary round-icon-small AddQuoteVendor",on:{click:t.Addvendor}},[e("i",{staticClass:"fa fa-plus pt-7 AddQuoteVendor",attrs:{id:"AddQuoteVendor",title:"Add Vendor",onclick:"AddVendor('quote');"}})])])]),e("div",{staticClass:"col-md-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Requested Quantity:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{attrs:{name:"RequestQuantity"+(i+1),rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:a.txtrequestQuantity,expression:"item.txtrequestQuantity"}],class:{"RequestQuantity form-control":!0,"is-invalid":i[0]},attrs:{type:"number",min:"1"},domProps:{value:a.txtrequestQuantity},on:{keyup:function(e){return t.calculateTotalQuantity(a)},input:function(e){e.target.composing||t.$set(a,"txtrequestQuantity",e.target.value)}}})]}}],null,!0)})],1)])]),e("div",{staticClass:"col-md-1"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Currency:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{staticClass:"w-100",attrs:{name:"Currency"+(i+1),rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:s}){return[e("select",{directives:[{name:"model",rawName:"v-model",value:a.getCurrencyValue,expression:"item.getCurrencyValue"}],class:{"Currency form-control w-100":!0,"is-invalid":s[0]},attrs:{name:"Currency"+(i+1)},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"getCurrencyValue",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:""}},[t._v("Select")]),t._l(t.currencyList,(function(a,i){return e("option",{key:i,domProps:{value:a.CurrencyId}},[t._v(" "+t._s(a.Currency)+" ")])}))],2)]}}],null,!0)})],1)])]),e("div",{staticClass:"col-lg-1 pl-0"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Unit Price:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"UnitPrice"+(i+1),rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:a.txtUnitPrice,expression:"item.txtUnitPrice"}],class:{"UnitPrice form-control":!0,"is-invalid":i[0]},attrs:{type:"number",min:"1"},domProps:{value:a.txtUnitPrice},on:{keyup:function(e){return t.calculateTotalQuantity(a)},input:function(e){e.target.composing||t.$set(a,"txtUnitPrice",e.target.value)}}})]}}],null,!0)})],1)]),e("div",{staticClass:"col-lg-1 pl-0"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Total Price:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{staticClass:"totalPrice form-control",attrs:{name:"totalPrice"+(i+1),id:"totalPrice"+(i+1),type:"text",disabled:""},domProps:{value:a.txtTotalPrice}})])]),e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Upload Quote:")]),e("div",{staticClass:"input-group"},[e("div",{staticClass:"input-group"},[e("div",{staticClass:"custom-file"},[e("input",{staticStyle:{position:"absolute",clip:"rect(0px, 0px, 0px, 0px)"},attrs:{type:"file",name:"FileSrc"+(i+1),id:"flFile"+(i+1),"data-file":"multi",tabindex:"-1"},on:{change:function(e){return t.setFile(e,i)}}}),e("div",{staticClass:"bootstrap-filestyle input-group"},[e("input",{staticClass:"form-control disabled",attrs:{type:"text",disabled:""},domProps:{value:a.fileName}}),e("div",{staticClass:"input-group-append",staticStyle:{cursor:"pointer"}},[e("span",{staticClass:"group-span-filestyle input-group-btn input-group-text bg-white",attrs:{tabindex:"0"}},[e("label",{staticClass:"mb-0 font-weight-normal",attrs:{title:"Click here to select a file.",for:"flFile"+(i+1)}},[t._v("Choose File")])]),e("span",{staticClass:"input-group-text border-0 bg-transparent p-0 pl-2"},[e("a",{staticClass:"round-icon-small btn-danger-light",attrs:{href:"javascript:;",title:"Clear"},on:{click:function(e){return t.Clear(a.count)}}},[e("i",{staticClass:"fa fa-undo"})]),e("a",{staticClass:"btn btn-danger theme-primary removefield ml-1",attrs:{href:"javascript:void;"},on:{click:function(e){return t.removeRow(a.count,a)}}},[e("i",{staticClass:"fa fa-times pt-7",attrs:{title:""}})])])])])])])])])])])])})),0),t.isShowvendor?e("AddVendorPopUp"):t._e()],1)],1)}),n=[],o=a("1115"),u=function(){var t=this,e=t._self._c;return e("section",[e("div",{staticClass:"my-popups"},[e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v(" "+t._s(t.$t("Add vendor"))+" ")]),e("button",{staticClass:"close",attrs:{type:"button",title:"Close"},on:{click:function(e){return t.closePopup()}}},[e("em",{staticClass:"fa fa-times"})])]),e("div",{staticClass:"modal-body"},[e("dynamic-form",{attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.Addvendor}})],1)])])])])])},l=[],c={components:{AddQuotes:g},data(){return{CountryData:[],FormSchema:[{layoutType:"double",Data:[{astype:"TextField",label:this.$t("Vendor"),name:"Vendor",value:"",placeholder:"",validationRules:{required:!0}},{astype:"TextField",label:this.$t("Contact Person"),name:"ContactPerson",value:"",validationRules:{required:!1},placeholder:""}]},{layoutType:"Single",Data:[{astype:"TextAreaField",label:this.$t("Description"),name:"Description",value:"",placeholder:"",validationRules:{required:!1}}]},{layoutType:"double",group_name:"Product Type",Data:[{astype:"TextField",label:this.$t("Street"),name:"Street",value:"",placeholder:"",validationRules:{required:!1}},{astype:"TextField",label:this.$t("State"),name:"State",value:"",validationRules:{required:!1},placeholder:""}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("City"),name:"City",value:"",placeholder:"",validationRules:{required:!1}},{astype:"SelectField",label:this.$t("Country"),name:"Country",value:"",placeholder:"",validationRules:{required:!1},config:{options:[]}}]},{layoutType:"double",Data:[{astype:"TextField",label:this.$t("Zip code"),name:"Zipcode",value:"",placeholder:"",validationRules:{required:!1}},{astype:"TextField",label:this.$t("Phone Number"),name:"Phonenumber",value:"",validationRules:{required:!1},placeholder:""}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.closePopup}]}},created(){this.GetCountryDDL()},methods:{Addvendor:function(t){var e=this,a={Vendor:t.Vendor,vendorOwner:t.ContactPerson,Description:t.Description,Street:t.Street,state:t.State,city:t.City,country:t.Country,zipcode:t.Zipcode,phone_number:t.Phonenumber},i=JSON.stringify(a);o["a"].Addvendor(i).then(t=>{"insert"==t.data.data.status?(e.ShowAlert(e.$t("AddedSuccessvendor",[e.$t("Group_Item")]),"success",!0,e.$t("Alert")),e.closePopup()):(e.ShowAlert(e.$t("Vendorexist"),"failure",!0,e.$t("Alert")),e.closePopup()),e.$parent.getVendorlist()})},closePopup(){var t=this;t.$parent.CloseAddVendorModel()},GetCountryDDL:function(){var t="moduleName=CRM&type=COUNTRIES";o["a"].GetCountryDDL(t).then(t=>{this.CountryData=t.data.DATA,this.CountryData.forEach(t=>{var e={name:t.name,value:t.value};this.FormSchema[3].Data[1].config.options.push(e)})})}}},d=c,p=a("2877"),h=Object(p["a"])(d,u,l,!1,null,null,null),m=h.exports,v={components:{AddVendorPopUp:m},data(){return{newDynamicField:[{quoteId:0,getVenderValue:"",txtrequestQuantity:"",getCurrencyValue:"",txtUnitPrice:"",txtTotalPrice:"",uploadQuote:"",fileName:"",count:1}],quotes:{},specificCount:null,venderList:[],currencyList:[],purchases:[],isShowvendor:!1,isLoading:!1,quoteData:[]}},async created(){var t=this;await t.getVendorlist(),await t.getCurrencylist(),"ProductTypeList"==this.$route.params.reqForm&&(this.productItem=this.$route.params.items,null!=this.productItem&&""!=this.productItem&&"undefined"!=this.productItem&&await t.UpdateRequisition(this.productItem.AssetRequisitionId))},methods:{UpdateRequisition:async function(t){try{var e=this;e.isLoading=!0;var a="id="+t,i=await o["a"].UpdateRequisition(a);null!=i.data&&(e.newDynamicField=[],e.quoteData=JSON.parse(i.data.QuoteNewRequisitionList),e.quoteData.forEach((t,e)=>{t.count=e+1}),e.quoteData.forEach(t=>{var a={quoteId:t.quoteId,getVenderValue:t.vendorId,txtrequestQuantity:t.quantity,getCurrencyValue:t.currencyId,txtUnitPrice:t.price,txtTotalPrice:t.totalPrice,uploadQuote:t.quote,fileName:t.quote_file_name,count:t.count};e.newDynamicField.push(a);let i={quoteId:t.quoteId,quoteVendor:t.vendorId,quoteQuantity:t.quantity,quoteAmount:t.currencyId,quotePrice:t.price,quoteTotalPrice:t.totalPrice,uploadQuote:t.quote,fileName:t.quote_file_name};e.$emit("quotes",i)}),e.isLoading=!1)}catch(s){console.error("Error in UpdateRequisition:",s)}finally{e.isLoading=!1}},CloseAddVendorModel(){var t=this;t.isShowvendor=!1},Addvendor(){this.isShowvendor=!0},handleVendorChange(){console.log("Vendor value changed:",this.item.getVenderValue)},setFile:function(t,e){var a=this;a.isLoading=!0;var i=new FormData;i.append("Files",t.target.files[0]),a.newDynamicField.forEach(t=>{const s=a.newDynamicField.find(t=>t.count===e+1);null!=s&&(o["a"].UploadNewAssetTypeQuoteFiles(i).then(t=>{null!=t.data?(a.isLoading=!1,s.uploadQuote=t.data.filepath,s.fileName=t.data.fileName):(a.isLoading=!1,a.ShowAlert(a.$t("Something Went Wrong"),"failure",a.$t("Alert")))}),a.quotes={quoteId:0,quoteVendor:s.getVenderValue,quoteQuantity:s.txtrequestQuantity,quoteAmount:s.txtUnitPrice,quotePrice:s.getCurrencyValue,quoteTotalPrice:s.txtTotalPrice,uploadQuote:s.uploadQuote,fileName:s.fileName})}),a.$emit("quotes",a.quotes)},Clear(t){var e=this;e.newDynamicField.forEach(e=>{e.count==t&&(e.fileName="")})},async getVendorlist(){await o["a"].GetCrmVendor().then(t=>{null!=t.data&&(this.venderList=t.data)})},async getCurrencylist(){await o["a"].GetCurrency().then(t=>{null!=t.data&&(this.currencyList=t.data)})},calculateTotalQuantity(t){var e=this;e.specificCount=t.count,e.newDynamicField.forEach(a=>{a.count==e.specificCount&&(a.txtTotalPrice=t.txtrequestQuantity*t.txtUnitPrice)});const a=e.newDynamicField.find(t=>t.count==e.specificCount);null!=a&&(e.quotes={quoteId:0,quoteVendor:a.getVenderValue,quoteQuantity:a.txtrequestQuantity,quoteAmount:a.txtUnitPrice,quotePrice:a.getCurrencyValue,quoteTotalPrice:a.txtTotalPrice,uploadQuote:a.uploadQuote,fileName:a.fileName}),e.$emit("quotes",e.quotes)},addRow(){var t=this;t.quotes={},t.$refs.AddQuoteForm.validate().then(e=>{if(e){let e={getVenderValue:"",txtrequestQuantity:"",getCurrencyValue:"",txtUnitPrice:"",txtTotalPrice:"",uploadQuote:"",fileName:"",count:1};e.count=t.newDynamicField.length+1,t.newDynamicField.push(e)}else t.ShowAlert(t.$t("Please correct the highlighted errors"),"failure",t.$t("Alert"))})},removeRow(t,e){var a=this;const i=a.newDynamicField.findIndex(e=>e.count===t);return-1!==i&&(a.newDynamicField.splice(i,1),a.$emit("quoteItemDelete",e)),!0}}},f=v,y=Object(p["a"])(f,r,n,!1,null,null,null),g=y.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-lg-12 mt-3 px-0"},[e("div",{staticClass:"heading-border mb-2"},[e("h5",{staticClass:"h5"},[e("span",{attrs:{id:"TabHeading2"}},[t._v("Online Purchase")]),e("small",{staticClass:"float-right"},[e("a",{staticClass:"addPurchaseLinkRows",attrs:{href:"javascript:;",title:""},on:{click:t.showRow}},[e("i",{staticClass:"fa fa-plus pr-1"}),t._v("Add Row ")])])])]),e("Form",{ref:"AddOnlineForm"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"isVisible"}],staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mt-3"},t._l(t.newDynamicField,(function(a,i){return e("div",{key:i.count,staticClass:"row addOnlinePurchaseRows"},[e("div",{staticClass:"col-lg-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Vendor:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{staticClass:"w-100",attrs:{name:"Vendor"+(t.index+1),rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("select",{directives:[{name:"model",rawName:"v-model",value:a.purchase_vendor,expression:"item.purchase_vendor"}],class:{"Vendor form-control w-100":!0,"is-invalid":i[0]},attrs:{name:"Vendor"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"purchase_vendor",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:""}},[t._v("Select")]),t._l(t.venderList,(function(a){return e("option",{key:a,domProps:{value:a.Value}},[t._v(" "+t._s(a.Text)+" ")])}))],2),e("input",{directives:[{name:"model",rawName:"v-model",value:a.purchase_id,expression:"item.purchase_id"}],staticClass:"hdnpurchase_id",attrs:{type:"hidden",value:"0"},domProps:{value:a.purchase_id},on:{input:function(e){e.target.composing||t.$set(a,"purchase_id",e.target.value)}}})]}}],null,!0)})],1)])]),e("div",{staticClass:"input-group-append",staticStyle:{cursor:"pointer"}},[e("span",{staticClass:"input-group-text border-0 bg-transparent p-0 pl-2"},[e("a",{staticClass:"round-icon-small btn-dark theme-primary round-icon-small AddQuoteVendor",on:{click:t.Addvendor}},[e("i",{staticClass:"fa fa-plus pt-7 AddQuoteVendor",attrs:{id:"AddQuoteVendor",title:"Add Vendor",onclick:"AddVendor('quote');"}})])])]),e("div",{staticClass:"col-lg-2"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Requested Quantity:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{attrs:{name:"Request Quantity",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:a.txtpurchaseQuantity,expression:"item.txtpurchaseQuantity"}],class:{"RequestQuantity form-control":!0,"is-invalid":i[0]},attrs:{type:"number",min:"1"},domProps:{value:a.txtpurchaseQuantity},on:{keyup:function(e){return t.calculateTotalQuantity(a)},input:function(e){e.target.composing||t.$set(a,"txtpurchaseQuantity",e.target.value)}}})]}}],null,!0)})],1)])]),e("div",{staticClass:"col-md-1"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Currency:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("div",{staticClass:"input-group"},[e("Field",{staticClass:"w-100",attrs:{name:"Currency",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("select",{directives:[{name:"model",rawName:"v-model",value:a.getCurrencyValue,expression:"item.getCurrencyValue"}],class:{"Currency form-control w-100":!0,"is-invalid":i[0]},attrs:{name:"Currency"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"getCurrencyValue",e.target.multiple?i:i[0])}}},[e("option",{attrs:{value:""}},[t._v("Select")]),t._l(t.currencyList,(function(a,i){return e("option",{key:i,domProps:{value:a.CurrencyId}},[t._v(" "+t._s(a.Currency)+" ")])}))],2)]}}],null,!0)})],1)])]),e("div",{staticClass:"col-lg-1 pl-0"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Unit Price:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"Unit Price",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function({errors:i}){return[e("input",{directives:[{name:"model",rawName:"v-model",value:a.priceAmount,expression:"item.priceAmount"}],class:{"UnitPrice form-control":!0,"is-invalid":i[0]},attrs:{type:"number",min:"1"},domProps:{value:a.priceAmount},on:{keyup:function(e){return t.calculateTotalQuantity(a)},input:function(e){e.target.composing||t.$set(a,"priceAmount",e.target.value)}}})]}}],null,!0)})],1)]),e("div",{staticClass:"col-lg-1 pl-0"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Total Price:"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.purchasePrice,expression:"item.purchasePrice"}],staticClass:"totalPrice form-control TotalPrice",attrs:{type:"text",disabled:""},domProps:{value:a.purchasePrice},on:{input:function(e){e.target.composing||t.$set(a,"purchasePrice",e.target.value)}}})])]),t._l(a.purchaseDynamicField,(function(i,s){return e("div",{key:"A"+s,staticClass:"purchaseDynamicField col-lg-3"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Purchase Link"),e("span",{staticClass:"text-danger"})]),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.purchase_link,expression:"purchase.purchase_link"}],staticClass:"purchaseLink form-control",attrs:{type:"text",name:"purchaseLink"},domProps:{value:i.purchase_link},on:{keyup:function(e){return t.purchaseUrlData(a,i)},input:function(e){e.target.composing||t.$set(i,"purchase_link",e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:i.purchase_link_id,expression:"purchase.purchase_link_id"}],staticClass:"purchase_link_id",attrs:{type:"hidden"},domProps:{value:i.purchase_link_id},on:{input:function(e){e.target.composing||t.$set(i,"purchase_link_id",e.target.value)}}}),e("div",{staticClass:"input-group-append",staticStyle:{cursor:"pointer"}},[e("span",{staticClass:"group-span-filestyle input-group-btn input-group-text bg-grey"},[e("a",{staticClass:"mb-0 font-weight-normal",attrs:{title:"Click here to copy link."}},[e("i",{staticClass:"fa fa-copy"})])]),e("span",{staticClass:"input-group-text border-0 bg-transparent p-0 pl-2"},[0==parseInt(s)?e("a",{staticClass:"round-icon-small btn-dark theme-primary round-icon-small",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.addLinkRow(a.count)}}},[e("i",{staticClass:"fa fa-plus pt-7"})]):t._e(),t._v("   "),e("a",{staticClass:"btn btn-danger theme-primary removefield",attrs:{href:"javascript:void;"},on:{click:function(e){return t.removeRow(a,i)}}},[e("i",{staticClass:"fa fa-times pt-7",attrs:{title:""}})])])])])])])}))],2)})),0)]),t.isShowvendor?e("AddVendorPopUp"):t._e()],1)},C=[],A={components:{AddVendorPopUp:m},data(){return{isShowvendor:!1,isVisible:!1,newDynamicField:[{purchase_id:0,purchase_vendor:"",txtpurchaseQuantity:"",getCurrencyValue:"",purchasePrice:"",priceAmount:"",count:1,purchaseDynamicField:[{purchase_link_id:0,purchase_link:"",pcount:1}]}],specificCount:null,venderList:[],currencyList:[],purchaseData:{},pushaseEditFieldsData:[],purchaseEditField:[],Pushlink:[]}},async created(){var t=this;await t.getVendorlist(),await t.getCurrencylist(),"ProductTypeList"==this.$route.params.reqForm&&(this.productItem=this.$route.params.items,null!=this.productItem&&""!=this.productItem&&"undefined"!=this.productItem&&await t.UpdateRequisition(this.productItem.AssetRequisitionId))},methods:{UpdateRequisition:async function(t){var e=this;e.isLoading=!0;try{const a=await o["a"].UpdateRequisition("id="+t);null!==a.data&&(e.newDynamicField=[],e.purchaseEditField=[],e.purchaseEditFieldsData=JSON.parse(a.data.PurchaseNewRequisitionList),e.purchaseEditFieldsData.forEach((t,e)=>{t.count=e+1;var a=JSON.parse(t.links);let i=[];a.forEach((t,e)=>{let a={purchase_link_id:t.purchaseLinkId,purchase_link:t.purchaseLink,pcount:e+1};i.push(a)}),t.purchaseDynamicField=i}),e.purchaseEditFieldsData.forEach(t=>{var a={purchase_id:0,purchase_vendor:"",txtpurchaseQuantity:"",getCurrencyValue:"",purchasePrice:"",priceAmount:"",purchaseDynamicField:[]};a.purchase_id=t.purchaseId,a.purchase_vendor=t.vendorId,a.txtpurchaseQuantity=t.quantity,a.getCurrencyValue=t.currencyId,a.purchasePrice=t.totalPrice,a.priceAmount=t.price,a.purchaseDynamicField=t.purchaseDynamicField,a.count=t.count,e.newDynamicField.push(a),t.purchaseDynamicField.forEach(t=>{e.Pushlink.push({purchase_link_id:t.purchase_link_id,purchase_link:t.purchase_link})});let i={purchase_id:t.purchaseId,purchase_vendor:t.vendorId,purchaseQuantity:t.quantity,purchasePrice:t.currencyId,ppriceAmount:t.totalPrice,purchaseTotalPrice:t.totalPrice,purchaselinks:e.Pushlink};e.$emit("purchases",i),e.isVisible=!0}),e.isLoading=!1)}catch(a){console.error("Error in UpdateRequisition:",a)}finally{e.isLoading=!1}},async getVendorlist(){await o["a"].GetCrmVendor().then(t=>{null!=t.data&&(this.venderList=t.data)})},async getCurrencylist(){await o["a"].GetCurrency().then(t=>{null!=t.data&&(this.currencyList=t.data)})},Addvendor(){this.isShowvendor=!0},CloseAddVendorModel(){var t=this;t.isShowvendor=!1},calculateTotalQuantity(t){var e=this;e.specificCount=t.count,e.newDynamicField.forEach(a=>{a.count==e.specificCount&&(a.purchasePrice=t.txtpurchaseQuantity*t.priceAmount)});const a=e.newDynamicField.find(t=>t.count===e.specificCount);if(null!=a){let t=[];a.purchaseDynamicField.map(e=>{let a={purchase_link_id:e.purchase_link_id,purchase_link:e.purchase_link};t.push(a)}),e.purchaseData={purchase_id:a.purchase_id?a.purchase_id:0,purchase_vendor:a.purchase_vendor,purchaseQuantity:a.txtpurchaseQuantity,purchasePrice:a.getCurrencyValue,ppriceAmount:a.priceAmount,purchaseTotalPrice:a.purchasePrice,purchaselinks:t},e.$emit("purchases",e.purchaseData)}},purchaseUrlData(t,e){var a=this;const i=a.newDynamicField.find(e=>e.count===t.count);if(null!=i){let t=[];i.purchaseDynamicField.map(e=>{let a={purchase_link_id:e.purchase_link_id,purchase_link:e.purchase_link};t.push(a)}),a.purchaseData={purchase_id:i.purchase_id?i.purchase_id:0,purchase_vendor:i.purchase_vendor,purchaseQuantity:i.txtpurchaseQuantity,purchasePrice:i.getCurrencyValue,ppriceAmount:i.priceAmount,purchaseTotalPrice:i.purchasePrice,purchaselinks:t},a.$emit("purchases",a.purchaseData)}},showRow(){var t=this;t.$refs.AddOnlineForm.validate().then(e=>{if(0==t.isVisible)return t.isVisible=!0;if(e){let e={purchase_vendor:"",txtpurchaseQuantity:"",getCurrencyValue:"",purchasePrice:"",priceAmount:"",count:1,purchaseDynamicField:[{purchase_link_id:0,purchase_link:"",pcount:1}]};e.count=t.newDynamicField.length+1,t.newDynamicField.push(e)}else t.ShowAlert(t.$t("Please correct the highlighted errors"),"failure",t.$t("Alert"))})},addLinkRow(t){var e=this;e.specificCount=t,e.isVisible=!0;let a={};const i=e.newDynamicField.find(t=>t.count===e.specificCount);null!=i&&(a={purchase_link_id:0,purchase_link:"",pcount:e.newDynamicField[0].purchaseDynamicField.length+1},e.newDynamicField.forEach(t=>{t.count==e.specificCount&&t.purchaseDynamicField.push(a)}));let s=[];i.purchaseDynamicField.map(t=>{let e={purchase_link_id:t.purchase_link_id,purchase_link:t.purchase_link};s.push(e)}),e.purchaseData={purchase_id:0,purchase_vendor:i.purchase_vendor,purchaseQuantity:i.txtpurchaseQuantity,purchasePrice:i.getCurrencyValue,ppriceAmount:i.priceAmount,purchaseTotalPrice:i.purchasePrice,purchaselinks:s},e.$emit("purchases",e.purchaseData)},removeRow(t,e){var a=this;let i=t.count;a.newDynamicField.forEach(s=>t.purchaseDynamicField.forEach((r,n)=>{if(s.count==i)if(1===s.purchaseDynamicField.length){const e=a.newDynamicField.findIndex(t=>t.count===i);if(-1!==e)return a.newDynamicField.splice(e,1),void a.$emit("purchaseDeleteItem",t)}else if(r.pcount===e.pcount)return s.purchaseDynamicField.splice(n,1),void a.$emit("purchaseLinkDeleteItem",s)}))}}},q=A,w=Object(p["a"])(q,_,C,!1,null,null,null),x=w.exports,P=a("ca17"),b=a.n(P),D=(a("542c"),{components:{AddQuotes:g,OnlinePurchase:x,"tree-view":b.a},data(){return{options:[],LocationValue:null,txtDescription:"",txtrequestQuantity:null,txtproductName:"",AssetType:[],selectedProductValue:null,isLoading:!1,qoutesArray:[],purchaseArray:[],productItem:"",updateItemArray:[],updateRequistionId:0}},async created(){var t=this;await t.GetLocationByCompanyId(),await t.GetAssetType(),"ProductTypeList"==this.$route.params.reqForm&&(this.productItem=this.$route.params.items,null!=this.productItem&&""!=this.productItem&&"undefined"!=this.productItem&&(t.txtrequestQuantity=this.productItem.Quantity,t.txtproductName=this.productItem.ProductName,t.txtDescription=this.productItem.Description,t.selectedProductValue=this.productItem.AssetTypeId,t.updateRequistionId=this.productItem.AssetRequisitionId,await t.UpdateRequisition(this.productItem.AssetRequisitionId)))},methods:{UpdateRequisition:async function(t){var e=this;e.isLoading=!0;var a="id="+t;await o["a"].UpdateRequisition(a).then(t=>{null!=t.data&&(e.updateItemArray=t.data,e.LocationValue=e.updateItemArray.location_id),e.isLoading=!1})},GetLocationByCompanyId:async function(){var t=this,e="reqForm=assetassignment";await o["a"].GetLocationByuserId(e).then(e=>{t.FindalLocationArray=[],e.data.data.forEach(a=>{var i=t.FindalLocationArray.filter((function(t){return t.COMPANY_LOCATION_ID==a.COMPANY_LOCATION_ID}));if(0==i.length&&null==a.PARENT_LOCATION_ID){let i=a.COMPANY_LOCATION_ID,s=t.getChildLocation(i,a,e.data.data);t.FindalLocationArray.push(s)}}),t.options=t.FindalLocationArray})},getChildLocation:function(t,e,a){let i=this,s={};s={id:e.COMPANY_LOCATION_ID,label:e.LOCATION_NAME};let r=s;var n=a.filter((function(e){return e.PARENT_LOCATION_ID==t}));let o=[];return n.forEach(t=>{let e=t.COMPANY_LOCATION_ID;var r=o.filter((function(e){return e.COMPANY_LOCATION_ID==t.COMPANY_LOCATION_ID}));if(0==r.length){var n=a.filter((function(t){return t.PARENT_LOCATION_ID==e}));if(null!=n&&n.length>0){let s=i.getChildLocation(e,t,a);o.push(s)}else s={id:""+t.COMPANY_LOCATION_ID,label:""+t.LOCATION_NAME},o.push(s)}}),r.children=o,r},async GetAssetType(){var t=this;t.isLoading=!0;var e="type=ITEMCODE&issueTo=&locationId=";await o["a"].GetAssetTypeCustom(e).then(e=>{t.AssetType=JSON.parse(e.data),t.isLoading=!1})},quoteItemDelete:function(t){var e=this;const a=e.qoutesArray.findIndex(e=>e.quoteVendor==t.getVenderValue);-1!==a&&e.qoutesArray.splice(a,1)},quotes:function(t){var e=this;if(0!=e.qoutesArray.length){const a=e.qoutesArray.findIndex(e=>e.quoteVendor==t.quoteVendor);return-1!==a&&e.qoutesArray.splice(a,1),void e.qoutesArray.push(t)}e.qoutesArray.push(t)},purchaseLinkDeleteItem(t){var e=this;const a=e.purchaseArray.find(e=>e.purchase_vendor==t.purchase_vendor);if(null!=a){let i=[];t.purchaseDynamicField.map(t=>{let e={purchase_link_id:t.purchase_link_id,purchase_link:t.purchase_link};i.push(e)});let s={purchase_id:a.purchase_id?a.purchase_id:0,purchase_vendor:t.purchase_vendor,purchaseQuantity:t.txtpurchaseQuantity,purchasePrice:t.getCurrencyValue,ppriceAmount:t.priceAmount,purchaseTotalPrice:t.purchasePrice,purchaselinks:i};const r=e.purchaseArray.findIndex(e=>e.purchase_vendor==t.purchase_vendor);-1!==r&&e.purchaseArray.splice(r,1),e.purchaseArray.push(s)}console.log("vm.purchaseArray",e.purchaseArray)},purchaseDeleteItem(t){var e=this;const a=e.purchaseArray.findIndex(e=>e.purchase_vendor==t.purchase_vendor);-1!==a&&e.purchaseArray.splice(a,1)},purchases:function(t){var e=this;if(0!=e.purchaseArray.length){const a=e.purchaseArray.findIndex(e=>e.purchase_vendor==t.purchase_vendor);return-1!==a&&e.purchaseArray.splice(a,1),void e.purchaseArray.push(t)}e.purchaseArray.push(t)},saveNewRequisition(t,e,a){let i=a;var s=this;s.isLoading=!0;var r=new FormData;s.$refs.AddReqForm.validate().then(t=>{if(t){let t={RequisitionId:s.updateRequistionId?s.updateRequistionId:0,location:s.LocationValue,productname:s.txtproductName,productType:s.selectedProductValue,quantity:s.txtrequestQuantity,description:s.txtDescription,status:i,quotes:s.qoutesArray,purchases:s.purchaseArray};r.append("postString",JSON.stringify(t)),o["a"].AddUpdateNewRequisition(r).then(t=>"add"==t.data.msg?(s.isLoading=!1,s.ShowAlert(s.$t("New Product type Request successfully Added"),"Success",s.$t("Alert")),s.$router.push({path:"/AssetRequisition/NewAssetRequisitionListing"})):"update"==t.data.msg?(s.isLoading=!1,s.ShowAlert(s.$t("New Product type Request successfully Updated"),"Success",s.$t("Alert")),s.$router.push({path:"/AssetRequisition/NewAssetRequisitionListing"})):(s.isLoading=!1,s.ShowAlert(s.$t("New Product type Request failed"),"failure",s.$t("Alert"))))}else s.ShowAlert(s.$t("Please correct the highlighted errors"),"failure",s.$t("Alert"))})},saveNewRequisitionAsDraft(t){let e=t;var a=this;a.isLoading=!0;var i=new FormData;a.$refs.AddReqForm.validate().then(t=>{if(t){let t={RequisitionId:a.updateRequistionId?a.updateRequistionId:0,location:a.LocationValue,productname:a.txtproductName,productType:a.selectedProductValue,quantity:a.txtrequestQuantity,description:a.txtDescription,status:e,purchases:a.purchaseArray,quotes:a.qoutesArray};i.append("postString",JSON.stringify(t)),o["a"].AddUpdateNewRequisition(i).then(t=>"add"==t.data.msg?(a.isLoading=!1,a.ShowAlert(a.$t("New Product type Request Add as draft "),"Success",a.$t("Alert")),a.$router.push({path:"/AssetRequisition/NewAssetRequisitionListing"})):"update"==t.data.msg?(a.isLoading=!1,a.ShowAlert(a.$t("New Product type Request update as draft "),"Success",a.$t("Alert")),a.$router.push({path:"/AssetRequisition/NewAssetRequisitionListing"})):(a.isLoading=!1,a.ShowAlert(a.$t("New Product type Request failed"),"failure",a.$t("Alert"))))}})}}}),k=D,I=(a("f437"),Object(p["a"])(k,i,s,!1,null,"df266916",null));e["default"]=I.exports},bff4:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,".vue-treeselect__control[data-v-df266916]{border:none;height:24px;padding:0}.vue-treeselect--searchable .vue-treeselect__input-container[data-v-df266916]{padding:0!important}.vue-treeselect__placeholder[data-v-df266916]{color:#303030!important}.vue-treeselect__control-arrow[data-v-df266916]{color:#000}.vue-treeselect__placeholder[data-v-df266916]{line-height:24px}",""]),t.exports=e},f437:function(t,e,a){"use strict";a("0936")}}]);
//# sourceMappingURL=chunk-a14bfaa4.js.map