(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b72148e"],{"6c0e":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-popups"},[t("loader",{attrs:{"is-visible":e.isLoading}}),t("div",{staticClass:"modal d-block"},[t("div",{staticClass:"modal-dialog modal-dialog-centered"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header theme-primary partition-full"},[t("h4",{staticClass:"modal-title"},[e._v(e._s(e.$t("ServiceAppointment")))]),t("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(t){return e.Close()}}},[t("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t("div",{staticClass:"modal-body",staticStyle:{"max-height":"70vh",overflow:"auto"}},[t("Form",{ref:"AddService"},[t("dynamic-form",{ref:"AddTicketForm",attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},on:{OnSubmit:e.OnSubmit}})],1),t("div",{staticClass:"row"},[t("div",{staticClass:"col-lg-6"},[t("div",{staticClass:"py-2"},[t("small",{staticClass:"text-danger"},[e._v(e._s(e.$t("MandatoryString")))])])])])],1)])])])],1)},i=[],o=(a("14d9"),a("9769")),r={props:{SchduleObj:{Type:Object,required:!0},callfrom:{Type:String,required:!0}},data(){return{isLoading:!1,WorkOrderListData:[],StaticObj:{layoutType:"double",Data:[{astype:"MultiSelectField",label:this.$t("ServiceResource"),name:"ServiceResource",value:"",mode:"tag",placeholder:"",validationRules:{required:!1},config:{options:[]}},{astype:"MultiSelectField",label:this.$t("Service Crew"),name:"ServiceCrew",value:"",mode:"tag",placeholder:"",validationRules:{required:!1},config:{options:[]}}]},FormSchema:[],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>Submit"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.Close}],resourceList:[],crewList:[],SAData:[],isFsmLocating:"",SAFormSchema:[],StatusId:"1001",StatusData:[],DurationData:[],Id:0,ServiceAppointmentList:[],JsonObj:[],TicketNumber:""}},created:async function(){null!=this.SchduleObj?("ServiceAppointment"==this.callfrom?this.TicketNumber=this.SchduleObj.SA_Related_Object_Id:this.TicketNumber=this.SchduleObj.ticket_number,this.Id=this.SchduleObj.SA_Id,await this.getForm(),await this.getResourceCrewData(null==this.Id?0:this.Id)):await this.getForm(),await this.getResourceList(),await this.getcrewList()},methods:{Close(){this.$parent.showPopupAddServiceAppointment=!1},getResourceCrewData:async function(e){var t,a,s=this,i=[],r=[],n="SA_ID="+e;await o["a"].getResourceCrewData(n).then(e=>{$.each(e.data.result.data,(function(s,i){t=$.grep(e.data.result.data,(function(e,t){return"RESOURCE"==e.ResourceType})),a=$.grep(e.data.result.data,(function(e,t){return"CREW"==e.ResourceType}))})),void 0!=t&&t.forEach(e=>{let t={label:e.name,value:e.value};i.push(t),s.FormSchema[2].Data[0].value=i}),void 0!=a&&a.forEach(e=>{let t={label:e.name,value:e.value};r.push(t),s.FormSchema[2].Data[1].value=r})})},getResourceList:async function(){var e="moduleName=Ticketing&type=FSM_SA_RESOURCENAME&refId=";await o["a"].GetDDLData(e).then(e=>{this.resourceList=e.data.DATA,this.resourceList.forEach(e=>{let t={name:e.name,value:e.value};this.FormSchema[2].Data[0].config.options.push(t)})})},getcrewList:async function(){var e="moduleName=Ticketing&type=FSM_CREWNAME&refId=";await o["a"].GetDDLData(e).then(e=>{this.crewList=e.data.DATA,this.crewList.forEach(e=>{let t={name:e.name,value:e.value};this.FormSchema[2].Data[1].config.options.push(t)})})},async getForm(){var e=this;e.isLoading=!0;var t=null==e.Id?0:e.Id,a=`recordId=${t}&moduleName=Ticketing&subModuleCode=SERVICE_APPOINTMENT`;await o["a"].GetDynamicForm(a).then(t=>{e.isLoading=!1,e.FormSchema=e.$refs.AddTicketForm.ConvertCustomFieldIntoDynamicFormObj(t.data.data),e.FormSchema.forEach((t,a)=>{t.Data.forEach((a,s)=>{if("General Information"==t.group_name){if("SA_Description"==a.name&&(a.astype="TextAreaField"),"SA_Status"==a.name&&""==a.value&&(a.value="1001"),"WorkOrder"==e.callfrom){if("SA_Related_Object_Id"==a.name){const t=a.config.options.filter(t=>t.value==e.SchduleObj.ticket_id);t.length>0&&(a.value={value:t[0].value,label:t[0].name}),a.disabled=!0,a.config.onSearchChange=e.onSearch}"SA_WorkOrder_Id"==a.name&&(a.value=e.SchduleObj.id,a.disabled=!0)}if("ServiceAppointment"==e.callfrom&&"SA_Related_Object_Id"==a.name){const t=a.config.options.filter(e=>e.value==a.value);t.length>0&&(a.value={value:t[0].value,label:t[0].name}),a.config.onSearchChange=e.onSearch}}"Scheduled Times"==t.group_name?"ArrivalWindowStartTime"!=a.name&&"ArrivalWindowEndTime"!=a.name&&"SA_Scheduled_StartTime"!=a.name&&"SA_Scheduled_EndTime"!=a.name||(a.astype="DateField",a.config={mode:"DateTime",format:"MM/DD/YYYY h:mm A"}):"ArrivalWindowStartTime"==a.name||"SA_Scheduled_StartTime"==a.name?(a.config={mode:"DateTime",format:"MM/DD/YYYY h:mm A"},a.config.onChange=e.GetStartData):"ArrivalWindowEndTime"!=a.name&&"SA_Scheduled_EndTime"!=a.name||(a.config={mode:"DateTime",format:"MM/DD/YYYY h:mm A"},a.config.minDate=""),a.config.onChange=e.onChangeEventForFields})}),e.FormSchema.push(e.StaticObj)})},GetStartData:function(e,t){},onChangeEventForFields:function(e,t,a){var s=this;"SA_Related_Object_Id"==t.name&&setTimeout((function(){s.GetDropDownData("SA_TICKET_WORKORDERS",t,null)}),1e3)},GetDropDownData:function(e,t,a){var s=this,i=`id=&moduleName=TICKETING&type=${e}&search=&refId=${"undefined"===typeof t.value.value?"":t.value.value}`;o["a"].GetDDLData(i).then(e=>{s.FormSchema[0].Data[2].config.options=[],""!=e.data&&e.data.DATA.forEach(e=>{let t={value:e.value,name:e.name};s.FormSchema[0].Data[2].config.options.push(t)})})},onSearch:function(e,t,a){var s=this;s.searchSelectData(a,s,t)},searchSelectData:function(e,t,a){this.ShowSearchData(e,t,a)},ShowSearchData:async function(e,t,a){var s=this,i=`id=&&moduleName=Ticketing&type=SA_TICKET_NUMBER&search=${e}&refId=`;"undefined"==typeof a&&(a=0),s.FormSchema[0].Data[1].config.options=[],await o["a"].GetDDLDataFSM(i).then((function(e){e.data&&(s.JsonObj=e.data,null!=s.JsonObj&&e.data.result.DATA.forEach(e=>{var t={value:e.value,name:e.name};s.FormSchema[0].Data[1].config.options.push(t)}))}))},OnSubmit(e){var t=this;t.isLoading=!0;var a=t.$refs.AddTicketForm.ConvertDynamicFormObjToCustomFieldObj(t.FormSchema),s="",i="",r="";a.forEach(e=>{"SA_WorkOrder_Id"==e.field_name&&(t.isBlank(e.field_value)||(r=e.field_value)),"SA_Id"==e.field_name&&(t.id,e.field_value=e.field_value),"SA_Related_Object_Id"==e.field_name&&(t.isBlank(e.field_value)||(e.field_value=e.field_value.value)),"ArrivalWindowStartTime"==e.field_name&&(t.isBlank(e.field_value)||(e.field_value=t.$options.filters.formatDateTime(e.field_value))),"ArrivalWindowEndTime"==e.field_name&&(t.isBlank(e.field_value)||(e.field_value=t.$options.filters.formatDateTime(e.field_value))),"SA_Scheduled_StartTime"==e.field_name&&(t.isBlank(e.field_value)||(e.field_value=t.$options.filters.formatDateTime(e.field_value))),"SA_Scheduled_EndTime"==e.field_name&&(t.isBlank(e.field_value)||(e.field_value=t.$options.filters.formatDateTime(e.field_value)))}),e.ServiceResource.forEach((e,t)=>{0==t?i=e.value:i+=","+e.value});var n=i;e.ServiceCrew.forEach((e,t)=>{0==t?s=e.value:s+=","+e.value});var c=s,l={data:a,serviceResourceId:n,serviceCrewId:c},d=JSON.stringify(l);if(null!=r||""!=r){var u=`Id=${r}&SA_Id=${null==t.Id?0:t.Id}&reqfrom=AddServiceAppointment`;o["a"].GetServiceAppointmentByWorkOrderId(u).then(e=>{if(t.ServiceAppointmentList=[],t.isLoading=!1,null!=e.data&&""!=e.data&&"Success"==e.data.status){t.ServiceAppointmentList=e.data.result.DATA;var a="";if($.each(t.ServiceAppointmentList,(function(e,t){a+=t.SA_NUMBER+","})),""!=a){var s=t.$t("ServiceAppointmentCancel")+"("+a+")"+t.$t("ConfirmServiceAppointmentCancel");t.confirmR(s,!0,null,(function(){o["a"].AddEditServiceAppointment(d).then(e=>{1==e.data.CODE?t.Id>0?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("ServiceAppointment")]),"success",!0,t.$t("Alert")),t.Close(),t.$parent.fetchRecords()):(t.ShowAlert(t.$t("AddedSuccess",[t.$t("ServiceAppointment")]),"success",!0,t.$t("Alert")),t.Close(),t.$parent.fetchRecords()):t.ShowAlert(t.$t("AddedError",[t.$t("ServiceAppointment")]),"failure",!0,t.$t("Alert")),t.isLoading=!1})}))}else o["a"].AddEditServiceAppointment(d).then(e=>{1==e.data.CODE?t.Id>0?(t.ShowAlert(t.$t("UpdatedSuccess",[t.$t("ServiceAppointment")]),"success",!0,t.$t("Alert")),t.Close(),t.$parent.fetchRecords()):(t.ShowAlert(t.$t("AddedSuccess",[t.$t("ServiceAppointment")]),"success",!0,t.$t("Alert")),t.Close(),t.$parent.fetchRecords()):t.ShowAlert(t.$t("AddedError",[t.$t("ServiceAppointment")]),"failure",!0,t.$t("Alert")),t.isLoading=!1})}})}}}},n=r,c=a("2877"),l=Object(c["a"])(n,s,i,!1,null,null,null);t["a"]=l.exports},7961:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"divMainFormData"}},[t("section",{staticClass:"main-content",attrs:{id:"main-content"}},[t("loader",{attrs:{"is-visible":e.isLoading}}),t("div",{staticClass:"left-menu-tab div-click-event hr_jobpost_a"},[t("div",{staticClass:"col-md-12 p-0"},e._l(e.CrewList,(function(a,s){return t("div",{key:s,staticClass:"theme-primary partition"},[t("span",{staticClass:"p-name text-white textelipsis"},[e._v(e._s(a.CREW_NAME))])])})),0),t("ul",{staticClass:"nav nav-pills flex-column left-tab responivecustomtab",attrs:{id:"myTab",role:"tablist"}},[t("li",{staticClass:"nav-item"},[t("a",{staticClass:"nav-link left-menu",class:{"active show":1==e.activeKey},attrs:{"data-bs-target":"#tab-detail-content",href:"javascript:void(0)","data-bs-toggle":"tab",role:"tab",id:"tab-Details"},on:{click:function(t){return e.loadData("detail")}}},[t("em",{staticClass:"fa fa-list",attrs:{"aria-hidden":"true","aria-selected":"true"}}),e._v(" "+e._s(e.$t("Details"))+" ")])]),t("li",{staticClass:"nav-item"},[t("a",{staticClass:"nav-link left-menu",class:{"active show":2==e.activeKey},attrs:{"data-bs-target":"#tab-resource-content",href:"javascript:void(0)",id:"tab-resource-content","data-bs-toggle":"tab",role:"tab"},on:{click:function(t){return e.loadData("Resource")}}},[t("em",{staticClass:"fa fa-users",attrs:{"aria-hidden":"true","aria-selected":"false"}}),e._v(" "+e._s(e.$t("Resource"))+" ")])])])]),t("div",{staticClass:"right-content"},[e.isDetail?t("div",{staticClass:"col-md-12 p-0 mb-2"},[t("div",{staticClass:"theme-primary partition p-actions-expand"},[t("span",{staticClass:"p-name text-white",attrs:{id:"span_ForSelectedTabName"}},[e._v(e._s(e.tabNameTitle))]),t("input",{attrs:{type:"hidden",id:"hdnActionName"},domProps:{value:e.Acctab}}),t("span",{staticClass:"p-actions float-right"},[t("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/ServiceAppointment/index"}},[t("em",{staticClass:"fa fa-angle-double-left"}),t("br"),e._v(" "+e._s(e.$t("BacktoList"))+" ")])],1),"NU"!=e.UserType?t("span",{staticClass:"p-actions float-right"},[t("a",{staticClass:"p-action-btn text-white float-right",on:{click:function(t){return e.EditServiceAppointment()}}},[t("em",{staticClass:"fa fa-pencil"}),t("br"),e._v(" "+e._s(e.$t("EditServiceAppointment"))+" ")])]):e._e(),e._m(0)])]):e._e(),e.isDetail?t("div",{staticClass:"card mb-3 probx"},[t("div",{staticClass:"card-header"},[t("h2",[e._v(e._s(e.$t("Details")))]),e._m(1)]),t("div",{staticClass:"card-body"},e._l(e.LeftViewData,(function(a,s){return t("div",{key:s,staticClass:"panel1"},[t("div",{staticClass:"heading-border"},[t("h5",{staticClass:"h5 mb-2"},[t("span",[e._v(e._s(e.GetLocalizedValue(a.group_name,"")))])])]),t("div",{staticClass:"row"},e._l(a.LeftViewData,(function(a,s){return t("div",{key:s,staticClass:"col-md-6 col-lg-3"},[t("div",{staticClass:"form-group"},[t("label",[t("b",[e._v(e._s(e.GetLocalizedValue(a.name,a.display_name))+": ")]),"date"==a.dt_code||"datetime"==a.dt_code&&"textarea"!=a.dt_code?t("span",{staticClass:"answer rightlabeltext"},[e._v(e._s(e._f("formatDateTime")(a.value)))]):e._e(),"decimal"==a.dt_code&&"textarea"!=a.dt_code?t("span",{staticClass:"answer rightlabeltext"},[e._v(e._s(e._f("currencyformat")(e.isBlank(a.value)?"0.00":a.value)))]):e._e(),"date"!=a.dt_code&&"datetime"!=a.dt_code&&"decimal"!=a.dt_code&&"Lookup"!=a.picklist_options&&"textarea"!=a.dt_code?t("span",{staticClass:"answer rightlabeltext"},[e._v(e._s(e.isBlank(a.value)?"--":a.value))]):e._e(),"date"!=a.dt_code&&"datetime"!=a.dt_code&&"decimal"!=a.dt_code&&"Lookup"==a.picklist_options&&"textarea"!=a.dt_code?t("span",{staticClass:"answer rightlabeltext"},[e._v(e._s(e.isBlank(a.value)?"--":e.FilterDDLandNormalValue(a.value)))]):e._e(),"textarea"==a.dt_code?t("span",{staticClass:"answer rightlabeltext"},[e._v(e._s(e.isBlank(a.value)?"--":e.RemoveHtmlTagsOnDescription(a.value)))]):e._e()])])])})),0)])})),0)]):e._e(),e.isResource?t("div",{staticClass:"tab-pane fade p-0 pb-2 border-0",class:{"active show":2==e.activeKey},attrs:{id:"tab-resource-content",role:"tabpanel","aria-labelledby":"tab-resource-content"}},[t("ResourceSADatamodal",{attrs:{ResourceTypeId:e.ticketSourceId}})],1):e._e()])],1),e.showPopupAddServiceAppointment?t("AddServiceAppointmentPopUpVue",{attrs:{SchduleObj:e.SchduleObj,callfrom:e.ServiceAppointment}}):e._e()],1)},i=[function(){var e=this,t=e._self._c;return t("span",{staticClass:"collapse-head-btns"},[t("a",{staticClass:"collapse-btns",attrs:{href:"javascript:;"}},[t("em",{staticClass:"fa fa-angle-up text-white"})])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"cont_right"},[t("div",{staticClass:"bar"})])}],o=(a("14d9"),function(){var e=this,t=e._self._c;return t("section",[t("tg-list",{attrs:{IsShowAction:!0,ModuleName:"Ticketing",SubModuleCode:"SERVICE_APPOINTMENT",LegendArray:[],RenderRowActionMethod:e.renderActions,widgets:[],IdentityColumn:"resource_id",HeaderText:e.$t("Resource"),listType:["List"],ListData:e.ResourceList,HeaderData:e.Headers,HeaderButtons:e.listheaderbuttons,TotalRecords:e.TotalRecords,ListDataCallBackFunction:e.FetchResources,showCheckBox:!0,SortExp:e.SortExp,SortBy:e.SortBy,NorecordfoundText:e.$t("NoRecordfound")},on:{ActionButtonClick:e.actionButtonClick,LeftsearchButtonClick:e.leftCommonSearch,PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,SortdataButtonClick:e.sortdata},scopedSlots:e._u([{key:"slotdata",fn:function({data:a}){return["STATUS_NAME"==a.column.COLUMN_NAME?[t("a",{staticClass:"active"},["Active"==a.row.STATUS_NAME?t("span",{class:e.getStatusClassList(a.row.STATUS_NAME,"STATUS_NAME")},[e._v(" "+e._s(a.row[a.column.COLUMN_NAME])+" ")]):e._e(),"Inactive"==a.row.STATUS_NAME?t("span",{class:e.getStatusClassList(a.row.STATUS_NAME,"STATUS_NAME")},[e._v(" "+e._s(e.$t("Inactive"))+" ")]):e._e()])]:e._e()]}}])}),e.AddSAResourcePopup?t("AddSAResourcePopup",{attrs:{CrewResId:e.CrewResId}}):e._e(),e.AddMapResourcePopup?t("AddMapResourcePopup",{attrs:{CrewResId:e.CrewResId}}):e._e()],1)}),r=[];a("88a7"),a("271a"),a("5494");let n=[{title:"Add Resource",iconClass:"fa fa-plus",callbackfunction:"CommonAddResource",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"AddCommon"},{title:"Map Resource",iconClass:"fa fa-plus",callbackfunction:"CommonMapResource",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"MapCommon"}],c=[{title:"Delete",href:"javascript:void(0)",icon:"fa fa-trash action-icon",callbackfunction:"Delete",additionalSpan:""}];var l={buttons:n,listActions:c},d=a("9769"),u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-popups"},[t("loader",{attrs:{"is-visible":e.isLoading}}),t("div",{staticClass:"modal d-block"},[t("div",{staticClass:"modal-dialog modal-dialog-centered"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[t("h4",{staticClass:"modal-title"},[e._v(e._s(e.$t("ManageResource")))]),t("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[t("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t("div",{staticClass:"modal-body"},[t("dynamic-form",{attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},on:{OnSubmit:e.onSubmit}})],1)])])])],1)},p=[],m={data(){return{isLoading:!1,FormSchema:[{layoutType:"triple",Data:[{astype:"TextField",label:this.$t("ServiceAppointment"),name:"ServiceAppointment",value:"",disabled:!0,validationRules:{required:!0}},{astype:"SelectField",label:this.$t("User"),name:"User",value:"",config:{options:[]},placeholder:this.$t("SelectUser"),validationRules:{required:!0}},{astype:"SelectField",label:this.$t("ResourceType"),name:"ResourceType",value:"",config:{options:[]},placeholder:this.$t("SelectResource"),validationRules:{required:!0}}]},{layoutType:"triple",Data:[{astype:"SelectField",mode:"Status",label:this.$t("Status "),name:"Status",value:"",config:{options:[{value:"1001",name:"Active"},{value:"1002",name:"InActive"}]},placeholder:this.$t("Select"),validationRules:{required:!0}}]},{layoutType:"single",Data:[{astype:"TextAreaField",mode:"Description",label:this.$t("Description "),name:"Description",value:"",config:{options:[]},placeholder:this.$t("Description"),validationRules:""}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Close",onClick:this.Close}]}},created:async function(){this.GetDdlRecords_ResourceType(),this.GetDdlRecords_User(),this.FetchData()},methods:{FetchData:function(){var e=this;e.FormSchema[0].Data[0].value="SA-"+this.$route.params.id},GetDdlRecords_User:async function(){var e=this,t="id=&&moduleName=FSM&type=FSM_USERS&search=&refId=";await d["a"].GetDDLDataFSM(t).then((function(t){if(t.data){var a=t.data;null!=a&&t.data.result.DATA.forEach((t,a)=>{e.FormSchema[0].Data[1].config.options.push({value:t.value,name:t.name})})}}))},GetDdlRecords_ResourceType:async function(){var e=this,t="id=&&moduleName=FSM&type=FSM_RESOURCE_TYPE&search=&refId=";await d["a"].GetDDLDataFSM(t).then((function(t){if(t.data){var a=t.data;null!=a&&t.data.result.DATA.forEach((t,a)=>{e.FormSchema[0].Data[2].config.options.push({value:t.value,name:t.name})})}}))},Close:function(){this.$parent.AddSAResourcePopup=!1},onSubmit(e,t){var a=this,s={Id:null==a.ResourceTypeId?0:a.ResourceTypeId,SA_id:a.$route.params.id,ResourceName:"",FSMUserListId:e.User,ResourcetypeId:e.ResourceType,Desc:e.Description,Status:e.Status},i=JSON.stringify(s);d["a"].SaveResource(i).then(e=>{"Success"==e.data.status?(a.ResourceTypeId>0?(a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("Resource")]),"success",!0,a.$t("Alert")),a.Close()):a.ShowAlert(a.$t("AddedSuccess",[a.$t("Resource")]),"success",!0,a.$t("Alert")),a.Close(),a.$parent.FetchResources()):(a.ShowAlert(a.$t("AddedError",[a.$t("Resource")]),"failure",!0,a.$t("Alert")),a.Close())})}}},h=m,S=a("2877"),v=Object(S["a"])(h,u,p,!1,null,null,null),f=v.exports,A=function(){var e=this,t=e._self._c;return t("div",{staticClass:"my-popups"},[t("loader",{attrs:{"is-visible":e.isLoading}}),t("div",{staticClass:"modal d-block"},[t("div",{staticClass:"modal-dialog modal-dialog-centered"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header theme-primary partition-full d-flex"},[t("h4",{staticClass:"modal-title"},[e._v(e._s(e.$t("MapResource")))]),t("button",{staticClass:"close",attrs:{type:"button"},on:{click:e.Close}},[t("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),t("div",{staticClass:"modal-body"},[t("dynamic-form",{attrs:{lang:"en",buttons:e.buttons,schema:e.FormSchema},on:{OnSubmit:e.onSubmit}})],1)])])])],1)},_=[],b={data(){return{isLoading:!1,isLoading:!1,FormSchema:[{layoutType:"single",Data:[{astype:"CustomSelectField",mode:"tag",label:this.$t("ServiceResource"),name:"ServiceResource",value:"",config:{options:[]},placeholder:"",validationRules:{required:!0}}]}],buttons:[{type:"submit",class:"btn btn-success",text:"<i class='fa fa-save pr-2'></i>Save"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Close",onClick:this.Close}]}},created:async function(){this.getResourceList()},methods:{getResourceList:async function(){var e=this,t="id=&&moduleName=FSM&type=FSM_SA_RESOURCENAME&search=&refId=";await d["a"].GetDDLDataFSM(t).then((function(t){if(t.data){var a=t.data;null!=a&&t.data.result.DATA.forEach((t,a)=>{e.FormSchema[0].Data[0].config.options.push({value:t.value,name:t.name})})}}))},Close:function(){this.$parent.AddMapResourcePopup=!1},onSubmit(e,t){var a=this,s="",i=0;for(i=0;i<e.ServiceResource.length;i++)s=0==i?e.ServiceResource[i].value:s+","+e.ServiceResource[i].value;var o={SA_id:a.$route.params.id,ResourceId:s,Type:"Map"},r=JSON.stringify(o);d["a"].SaveMapResource(r).then(e=>{if("Success"==e.data.status){var t=JSON.parse(e.data.result);"ALREADY_MAPPED"==t.MSG?a.ShowAlert(a.$t("ResourceAlreadyMapped",[a.$t("ResourceName")]),"failure",!0,a.$t("Alert")):a.ShowAlert(a.$t("ResourceMapSuccessfully",[a.$t("Resource")]),"success",!0,a.$t("Alert")),a.Close(),a.$parent.FetchResources()}else a.ShowAlert(a.$t("AddedError",[a.$t("Resource")]),"failure",!0,a.$t("Alert")),a.Close()})}}},C=b,R=Object(S["a"])(C,A,_,!1,null,null,null),g=R.exports,D={components:{AddSAResourcePopup:f,AddMapResourcePopup:g},data(){return{AddSAResourcePopup:!1,AddMapResourcePopup:!1,noRecords:!1,TotalRecords:0,CurrentPage:1,TotalPages:0,SearchCondition:"",GroupStart:1,GroupEnd:3,listActions:l.listActions,Headers:[{COLUMN_NAME:"resource_name",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Resource Name",DISPLAY_ORDER:1},{COLUMN_NAME:"UserName",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"User",DISPLAY_ORDER:2},{COLUMN_NAME:"ResourcesType",DATA_TYPE:"string",SORTABLE:!0,VISIBLE:!0,DISPLAY_NAME:"Resource type",DISPLAY_ORDER:3},{COLUMN_NAME:"STATUS_NAME",DATA_TYPE:"",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status",DISPLAY_ORDER:5}],listheaderbuttons:l.buttons,SortBy:"",SortExp:"",PageSize:"10",PageNumber:"1",search:"",GroupStart:1,GroupEnd:3,leftSearchFields:null,ResourceList:[],CrewResId:0,user_id:null,companyId:null}},created:async function(){var e=this;e.user_id=this.GetUserInfo.ID,e.user_type=this.GetUserInfo.UserType,e.companyId=this.GetUserInfo.CompanyId,await e.FetchResources()},methods:{FetchResources:function(){var e=this,t=`Sa_Id=${this.$route.params.id}&sortBy=${e.SortBy}&sortExp=${e.SortExp}&pageSize=${e.PageSize}&pageNumber=${e.PageNumber}`;d["a"].GetFsmResourceListBySA_Id(t).then((function(t){e.Headers.forEach(e=>{e.settings=null,"STATUS_NAME"==e.COLUMN_NAME&&(e.DISPLAY_NAME="Status",e.settings={isInSlot:!0,isForTag:!0})}),e.ResourceList=[],null!=t.data&&""!=t.data&&("Success"==t.data.status?(e.ResourceList=t.data.result.data,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize),e.CurrentPage=e.PageNumber,e.ResourceList.length>0?(e.TotalRecords=t.data.result.data[0].TOTALRECORDS,e.TotalPages=Math.ceil(e.TotalRecords/e.PageSize),e.NoRecord=!1):e.NoRecord=!0):e.NoRecord=!0,setTimeout((function(){e.ResponsiveDataTable("tablelistingdata")}),500))}))},leftCommonSearch:function(e){const t=new URLSearchParams(e.searchConditionJson),a=t.entries(),s=this.paramsToObject(a);s.hasOwnProperty("search")?this.search=s["search"]:this.search="",this.PageNumber=e.PageNumber,this.isPaged=1,"undefined"!=typeof e.searchCondition?this.searchCondition=e.searchCondition:this.searchCondition="",this.FetchResources()},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchResources()},renderActions:function(e){var t=this;let a=[];return t.listActions.forEach(e=>{let t={...e};switch(t.title){case"Delete":t.isVisible=!0;break;default:t.isVisible=!0}a.push(t)}),a},actionButtonClick(e,t,a,s){switch(e){case"Delete":this.UnMapById(t.resource_id);break}},UnMapById:function(e){var t=this;t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Resource"),(function(){var a={SA_id:e,ResourceId:e,Type:"UnMap"},s=JSON.stringify(a);d["a"].MapUnMapResource(s).then(e=>{if("Success"==e.data.status){var a=JSON.parse(e.data.result);"UNMAPPED"==a.MSG?(t.ShowAlert(t.$t("DeletedSuccess",[t.$t("Resource")]),"Success",!0,t.$t("Alert")),t.FetchResources()):ShowAlert(String.Format(Globalize.localize("AddedError"),Globalize.localize("Resource")),!0,Globalize.localize("Alert"))}})}))},sortdata:function(e){this.SortBy=e;var t="ASC";"ASC"==this.SortExp&&(t="DESC"),this.SortExp=t,this.SortBy=e,this.SortExp=t,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.FetchResources()},commonHeaderButtonClick:function(e){switch(e.callbackfunction){case"CommonAddResource":this.openPopupForAddSAResource(null);break;case"CommonMapResource":this.openPopupForMapSAResource(null);break}},openPopupForAddSAResource:function(e){void 0==e&&(e=0),this.AddSAResourcePopup=!this.AddSAResourcePopup},openPopupForMapSAResource:function(e){void 0==e&&(e=0),this.AddMapResourcePopup=!this.AddMapResourcePopup},getStatusClassList:function(e){var t="";switch(e){case"Active":t="px-2 text-center text-white d-block bg-success";break;case"Inactive":t="px-2 text-center text-white d-block bg-danger";break;default:t=""}return t}}},T=D,E=Object(S["a"])(T,o,r,!1,null,null,null),y=E.exports,I=a("6c0e"),w={components:{ResourceSADatamodal:y,AddServiceAppointmentPopUpVue:I["a"]},data(){return{LeftViewData:[],isLoading:!1,isDetail:!1,isResource:!1,NoRecord:!1,ResourceSADatamodal:!1,tabNameTitle:"",showPopupAddServiceAppointment:!1,ServiceAppointment:"ServiceAppointment",UserType:null}},created:function(){this.loadData("detail"),this.FetchData(),this.UserType=this.GetUserInfo.UserType},methods:{FetchData:function(){var e=this,t=`id=${this.$route.params.id}&moduleName=Ticketing&subModuleCode=SERVICE_APPOINTMENT`;d["a"].ViewServiceAppointment(t).then((function(t){var a=t.data.LEFTDATA;t.data.TICKETDETAIL;if(t.data.TICKETDETAIL.length>0&&(e.ticketsubject=t.data.TICKETDETAIL[0].TICKET_SUBJECT,e.ticketpriority=t.data.TICKETDETAIL[0].PRIORITY_NAME,e.ticketcategory=t.data.TICKETDETAIL[0].TICKET_CATEGORY_NAME,e.ticketnumber=t.data.TICKETDETAIL[0].TICKET_NUMBER,e.assignedto=t.data.TICKETDETAIL[0].ASSIGNED_TO,e.Worktype=t.data.TICKETDETAIL[0].WORKTYPE_NAME,e.cdc=t.data.TICKETDETAIL[0].CDC),a=$.grep(a,(function(e,t){return"YES"==e.form_field_visibility})),null!=a&&a.length>0){var s=a[0].group_id;$.each(a,$.proxy((function(t,i){"SA_Number"==i.name&&(e.SA_Number=i.value),"ticket_subject"==i.name&&(i.value=e.ticketsubject),"ticket_priority"==i.name&&(i.value=e.ticketpriority),"ticket_category"==i.name&&(i.value=e.ticketcategory),"SA_Related_Object_Id"==i.name&&(i.value=e.ticketnumber),"assigned_to"==i.name&&(i.value=e.assignedto),"worktype_name"==i.name&&(i.value=e.Worktype),"cdc_name"==i.name&&(i.value=e.cdc),"Status"==i.name&&(e.SAStatus=i.value);var o=$.grep(e.LeftViewData,(function(e,t){return e.group_id==s}));if(0==o.length){var r=$.grep(a,(function(e,t){return e.group_id==s}));if(r=r.sort((function(e,t){var a=e.display_order,s=t.display_order;return a==s?0:a>s?1:-1})),r.length>0){var n={group_id:s,group_name:r[0].group_name,LeftViewData:r};e.LeftViewData.push(n)}}s=i.group_id}),this))}e.additionalOwnerPermission=t.data.PERMISSION_DATA,e.isDetail=!0})),e.isDetail=!0},loadData:function(e,t){var a=this;"detail"==e?(a.isResource=!1,a.isDetail=!0,a.activeKey=1):"Resource"==e&&(a.isDetail=!1,a.isResource=!0,a.tabNameTitle="Resource",a.activeKey=2,a.openPopupForSAResourceDetail(this.$route.params.id))},RemoveHtmlTagsOnDescription:function(e){if(null!=e){var t="";return t=e.replace(/<\/?[^>]+(>|$)/g,""),t}},EditServiceAppointment(){this.showPopupAddServiceAppointment=!0,this.SchduleObj={SA_Id:this.$route.params.id,SA_Related_Object_Id:this.$route.query.TicketNumber,SA_Duration_Type:this.$route.query.DurationType}},openPopupForSAResourceDetail:function(e){this.ResourceSADatamodal=!this.ResourceSADatamodal}}},L=w,M=Object(S["a"])(L,s,i,!1,null,null,null);t["default"]=M.exports}}]);
//# sourceMappingURL=chunk-1b72148e.js.map