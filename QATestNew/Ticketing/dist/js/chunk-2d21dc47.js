(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21dc47"],{d368:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("section",[e("tg-list",{directives:[{name:"show",rawName:"v-show",value:t.IsMapView,expression:"IsMapView"}],attrs:{IsShowAction:!0,ModuleName:"Ticketing",SubModuleCode:"FSM_MapExtend",LegendArray:[],widgets:[],RenderRowActionMethod:t.renderActions,IdentityColumn:"ID",HeaderText:t.$t("MapExtend"),listType:["List"],ListData:t.mapList,HeaderData:t.Headers,HeaderButtons:t.listheaderbuttons,TotalRecords:t.TotalRecords,ListDataCallBackFunction:t.fetchMapConfigList,showCheckBox:!0,SortExp:t.SortExp,SortBy:t.SortBy,NorecordfoundText:t.$t("NoRecordfound")},on:{ActionButtonClick:t.actionButtonClick,SortdataButtonClick:t.sortdata,PagerButtonClick:t.pagerMethod,HeaderButtonClick:t.commonHeaderButtonClick},scopedSlots:t._u([{key:"slotdata",fn:function({data:a}){return["STATUS_ID"==a.column.COLUMN_NAME?[t.isCRMShowStausDrop(a.row.STATUS_ID,"Ticketing")?e("listing-status",{ref:"updatestatus",attrs:{isfor:"MapExtend",dataid:a.row.ID,"data-controller":"FSM",statuslist:t.StatusListForListing,item:a.STATUS_ID,"data-action":"index",dataselected:1001==a.row.STATUS_ID?"Active":"Inactive",callbackfunction:t.fetchMapConfigList,isselectedvaluestring:!0}}):t._e(),t.isCRMShowStausDrop(a.row.status_id,"Ticketing")?t._e():e("a",{staticClass:"inactive-disabled"},[e("span",{class:t.getStatusClass(a.row.status_id,"status_id")},[t._v(" "+t._s(a.row[a.column.COLUMN_NAME])+" ")])])]:t._e()]}}])}),t.showMapExtendPopup?e("modalAddMapExtend",{attrs:{mapContainer:"MapExtend",mapType:"Google",mapObj:t.mapObj,mapExtendId:t.mapExtendId},on:{Close:t.Close,fetchMapConfigList:t.fetchMapConfigList}}):t._e()],1)},i=[];a("14d9");let n=[{title:"Add New",iconClass:"fa fa-plus",callbackfunction:"openaddMap",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"Addticketing"},{title:"Delete",iconClass:"fa-trash-o",callbackfunction:"commonDeleteData",additionalClass:"",isdisabled:!0,isvisible:!0,checkPrivilege:!1,isEnabledOnSelectedRow:!0}],s=[{title:"Edit",href:"javascript:void(0)",icon:"fa fa-pencil action-icon",callbackfunction:"Edit",additionalSpan:""}];var l={buttons:n,listActions:s},d=a("9769"),r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"my-popups"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"modal d-block"},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header theme-primary partition-full"},[e("h4",{staticClass:"modal-title"},[t._v(t._s(t.mapType))]),e("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return t.$emit("Close")}}},[e("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"modal-body"},[e("MapComponent",{attrs:{mapType:t.mapType,mapContainer:"mapExtend",Data:t.mapObj,config:t.config},on:{SaveMapExtent:t.SaveMapExtent}})],1)])])])],1)])},c=[],p=a("33e4"),u={props:{mapObj:{required:!1},mapExtendId:{required:!1},mapType:{required:!1}},components:{MapComponent:p["a"]},data(){return{mapLatLng:[],config:{isShowDrawButton:!0,isShowEtaMap:!1,isShowLocator:!1,isEditable:!0,isShowSaveExtentButton:!0,isShowSearchBox:!0}}},methods:{SaveMapExtent:function(t,e){var a=this;if(0==t.length)return a.ShowAlert("Please select location","warning"),!1;var o=t[0].CompleteAddress.FullAddress,i=void 0==t[0].LatLng[0].Lat?t[0].LatLng[0].latitude:t[0].LatLng[0].Lat,n=void 0==t[0].LatLng[0].Lng?t[0].LatLng[0].longitude:t[0].LatLng[0].Lng;"Google"==e?void 0!=t[0].LatLng[0].Lat?(t[0].LatLng.forEach((function(t,e){a.mapLatLng.push([t.Lng,t.Lat])})),a.mapLatLng.push([i,n])):(t[0].LatLng.forEach((function(t,e){a.mapLatLng.push([t.longitude,t.latitude])})),a.mapLatLng.push([n,i])):void 0!=t[0].LatLng[0].Lat?(t[0].LatLng.forEach((function(t,e){a.mapLatLng.push([t.Lat,t.Lng])})),a.mapLatLng.push([i,n])):(t[0].LatLng.forEach((function(t,e){a.mapLatLng.push([t.latitude,t.longitude])})),a.mapLatLng.push([i,n]));t={ID:null==a.mapExtendId?0:a.mapExtendId,Latitude:i,Longitude:n,CityName:o,StatusForUpdate:"",QUERY_TYPE:null==a.mapExtendId?"INS":"UPD",Map_Type:"Google",Map_Lat_lng:JSON.stringify(a.mapLatLng)};var s=JSON.stringify(t);d["a"].SaveMapCityLatLng(s).then((function(t){"Success"==t.data.status&&(a.ShowAlert(a.$t("DataSavedContextMenu"),"success"),a.$emit("Close"),a.$emit("fetchMapConfigList"))}))}}},m=u,g=a("2877"),L=Object(g["a"])(m,r,c,!1,null,null,null),S=L.exports,h={components:{modalAddMapExtend:S},data(){return{showMapExtendPopup:!1,MapId:null,companyId:null,userId:null,Headers:[{COLUMN_NAME:"CITY_NAME",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Name",DISPLAY_ORDER:1},{COLUMN_NAME:"CREATED_AT",DATA_TYPE:"date",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Created at",DISPLAY_ORDER:2},{COLUMN_NAME:"STATUS_ID",DATA_TYPE:"string",SORTABLE:!1,VISIBLE:!0,DISPLAY_NAME:"Status","DISPLAY_ORDER ":3}],TotalRecords:0,PageNumber:1,PageSize:10,SortBy:"",SortExp:"",searchKeyWord:"",mapList:[],ItemObject:null,showaddNewModal:!1,noRecord:!1,latVal:"",lngVal:"",mapboxApi:"",mapType:"",modelType:"",modelItem:"",mapBoxName:"",mapLatLng:"",listActions:l.listActions,IsMapView:!0,listheaderbuttons:l.buttons,mapObj:[],mapExtendId:null,StatusListForListing:[{STATUS:"Active",STATUS_ID:1001,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#28a745"},{STATUS:"Inactive",STATUS_ID:1002,STATUS_COLOR:"#ffffff",STATUS_BG_COLOR:"#d72435"}]}},created:function(){this.fetchMapConfigList()},methods:{pagerMethod:function(t){this.PageSize=t.PageSize,this.PageNumber=t.PageNumber,this.fetchMapConfigList()},sortdata:function(t){this.SortBy=t;var e="ASC";"ASC"==this.SortExp&&(e="DESC"),this.SortExp=e,this.SortBy=t,this.SortExp=e,this.PageNumber=1,this.GroupStart=this.PageNumber,this.GroupEnd=this.PageNumber+2,this.fetchMapConfigList()},Searchdata:function(){var t=this;t.SearchCondition=t.SearchCondition,t.fetchMapConfigList()},actionButtonClick(t,e,a,o){switch(t){case"Edit":this.Edit(e);break}},Edit:function(t){var e=this;e.mapExtendId=null,e.mapExtendId=t.ID,e.mapObj=[];var a={refValue:"",popupHeaderHtml:"",popupHeaderColor:"",popupBodyHtml:"",popupFooterHtml:"",pinLatLong:{latitude:"",longitude:""},polygons:[],address:"",priority:"",color_code:""};let o=[],i=[],n=JSON.parse(t.LAT_LNG);n.forEach((function(t,e){o.push({latitude:t[0],longitude:t[1]})})),i.push({latLong:o}),a.polygons=i,e.mapObj.push(a),e.showMapExtendPopup=!0},openaddMap:function(){var t=this;t.mapExtendId=null,t.mapObj=[],t.showMapExtendPopup=!0},renderActions:function(t){var e=this;let a=[];return e.listActions.forEach(t=>{let e={...t};switch(e.title){case"Edit":e.isVisible=!0;break;default:e.isVisible=!0}a.push(e)}),a},getStatusClass:function(t){var e="";switch(t){case"ACTIVE":e="px-2 text-center bg-success text-white d-block";break;case"INACTIVE":e="px-2 text-center bg-danger text-white d-block";break;default:e=""}return e},changeMapStatus:function(t,e){showLoader(),e=1001==e?"ACTIVE":"INACTIVE";var a=this,o={ID:t,Latitude:a.latVal,Longitude:a.lngVal,CityName:"Google"==a.mapType?document.getElementById("autocomplete").value:document.getElementById("mapBoxName").value,StatusForUpdate:e,QUERY_TYPE:"UPDSTS",Map_Type:a.mapType,Map_Lat_lng:a.mapLatLng},i=JSON.stringify(o);d["a"].SaveMapCityLatLng(i).then((function(t){null!=t.data&&"Success"===JSON.parse(t.bodyText).status?(a.ShowAlert(a.$t("RecordUpdatedSuccessfully"),"success",!0,a.$t("Alert")),a.fetchMapConfigList()):a.ShowAlert(a.$t("UnknownErrorOccur"),"failure",!0,a.$t("Alert"))}))},DeleteMultiple:function(){var t=this,e="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){e.length>0&&(e+=","),e+=$(this).val()})),e.length>0&&t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Map"),(function(){var a={ids:e,moduleName:"FSM",subModuleCode:"FSM_MAP"},o=JSON.stringify(a);d["a"].deleteActivityDataFSM(o).then((function(e){"Success"==e.data.status?(t.ShowAlert(t.$t("DeletedSuccess",[t.$t("Map")]),"Success",!0,t.$t("Alert")),t.fetchMapConfigList()):t.ShowAlert(t.$t("DeletedError",[t.$t("Map")]),"failure",!0,t.$t("Alert"))}))}))},SaveMapCityLocation:function(){var t=this;t.mapBoxName=document.getElementById("mapBoxName").value;var e="Google"==t.mapType?document.getElementById("autocomplete").value:"LeafLet"==t.mapType||"Esri"==t.mapType?document.getElementById("searchtext9").value:t.mapBoxName;if(""==e.trim())return ShowAlert(String.Format(Globalize.localize("SelectLocation"),Globalize.localize("Map")),"warning",!0,Globalize.localize("Alert"),!0),!1;if($("#divmapcitysave a").addClass("disabled"),t.mapLatLng=document.getElementById("mapLatLng").value,t.latVal=document.getElementById("latval").value,t.lngVal=document.getElementById("lngval").value,""==t.latVal||""==t.lngVal||""==t.mapLatLng)return ShowAlert(String.Format("Please draw a polygon",Globalize.localize("Map")),"warning",!0,Globalize.localize("Alert"),!0),!1;var a={ID:"Add"==t.modelType?null:t.modelItem.ID,Latitude:t.latVal,Longitude:t.lngVal,CityName:"Google"==t.mapType?document.getElementById("autocomplete").value:"LeafLet"==t.mapType||"Esri"==t.mapType?document.getElementById("searchtext9").value:t.mapBoxName,StatusForUpdate:"",QUERY_TYPE:"Add"==t.modelType?"INS":"UPD",Map_Type:t.mapType,Map_Lat_lng:t.mapLatLng},o=JSON.stringify(a);d["a"].SaveMapCityLatLng(o).then(e=>{"Success"==JSON.parse(e.bodyText).status&&(t.ShowAlert(t.$t("DataSavedContextMenu"),"success",!0,t.$t("Alert")),"Google"==t.mapType?$("#googleMap").dialog("close"):"LeafLet"==t.mapType||"Esri"==t.mapType?$("#leaflet").dialog("close"):$("#mapBox").dialog("close"),t.fetchMapConfigList())})},fetchMapConfigList:function(){var t=this,e=`SortBy=${t.SortBy}&SortExp=${t.SortExp}&PageSize=${t.PageSize}&PageNumber=${t.PageNumber}`;d["a"].GetMapCityListByUserId(e).then((function(e){t.TotalRecords=0,t.Headers.forEach(t=>{t.settings=null,"STATUS_ID"==t.COLUMN_NAME&&(t.settings={isInSlot:!0})}),t.mapList=[],""!=e.data&&null!=e.data?"Success"==e.data.status?e.data.result.DATA.length>0&&(t.mapList=e.data.result.DATA,t.mapType=e.data.result.DATA[0].MAP_TYPE,t.TotalRecords=t.mapList[0].TOTALRECORDS,t.TotalPages=Math.ceil(t.TotalRecords/t.PageSize),t.CurrentPage=t.PageNumber,t.listheaderbuttons[1].isdisabled=!0,t.noRecord=!1):(t.noRecord=!0,t.mapList=[],t.TotalRecords=0):(t.noRecord=!0,t.mapList=[],t.Headers=[],t.TotalRecords=0),setTimeout((function(){t.ResponsiveDataTable("tablelistingdata")}),500)}))},Close:function(){var t=this;t.showMapExtendPopup=!1},commonHeaderButtonClick:function(t){switch(t.callbackfunction){case"openaddTicket":this.openaddTicket();break;case"commonDeleteData":this.DeleteMultiple();break;case"openaddMap":this.openaddMap();break}}}},f=h,E=Object(g["a"])(f,o,i,!1,null,null,null);e["default"]=E.exports}}]);
//# sourceMappingURL=chunk-2d21dc47.js.map