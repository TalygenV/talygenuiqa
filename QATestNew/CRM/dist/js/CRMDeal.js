(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CRMDeal"],{"1b4a":function(e,t,a){"use strict";a("200c")},"200c":function(e,t,a){var i=a("5166");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var s=a("499e").default;s("6b7fc876",i,!0,{sourceMap:!1,shadowMode:!1})},"3e9a":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline"}},[a("span",{domProps:{innerHTML:e._s(e.returnShortNoteString())}}),e.isShowReadMoreButtton()?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.openFullDateModal()}}},[e._v("   "+e._s(e.$t("readmore"))+" ...")]):e._e(),e.isShowFullData?a("div",{staticClass:"modal d-block my-popups dialog"},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(e._s(e.heading))]),a("button",{staticClass:"close",attrs:{type:"button",href:"javascript:;"},on:{click:function(t){e.isShowFullData=!1}}},[a("em",{staticClass:"fa fa-times"})])]),a("div",{staticClass:"modal-body crmnote-description"},["Notes"!=e.callFrom?a("div",{staticStyle:{"max-height":"500px","overflow-y":"auto"},domProps:{innerHTML:e._s(e.tempData)}}):e._e(),"Notes"==e.callFrom?a("ckeditor",{staticStyle:{height:"400px"},attrs:{id:"editor-a",editor:e.editor,config:e.editorConfig},on:{ready:e.onReady}}):e._e()],1)])])]):e._e()])},s=[],o=a("fb3d"),n=a.n(o),l={name:"crm-readmore",props:{data:{type:String,required:!0},heading:{type:String,required:!0},length:{type:String},callFrom:null},data:function(){return{isShowFullData:!1,tempData:"",editor:n.a}},methods:{onReady:function(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement())},openFullDateModal:function(){this.isShowFullData=!0},returnShortNoteString:function(){var e=document.implementation.createHTMLDocument().createElement("div");"Notes"==this.callFrom&&this.data.length,e.innerHTML=this.data;var t=e.innerText;return this.tempData=t,t.length<=this.length?this.data:t.substring(0,this.length)},isShowReadMoreButtton:function(){var e=document.implementation.createHTMLDocument().createElement("div");e.innerHTML=this.data;var t=e.innerText;return!(t.length<=this.length)}}},r=l,d=a("2877"),c=Object(d["a"])(r,i,s,!1,null,null,null);t["a"]=c.exports},"48bb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("loader",{attrs:{"is-visible":e.isLoading}}),a("TgList",{attrs:{IsShowAction:"true",ModuleName:"CRM",SubModuleCode:"CRM_DEALS",IdentityColumn:"deal_id",HeaderText:e.$t("Deal"),ListData:e.DealData,HeaderData:e.Headers,HeaderButtons:e.listheaderbuttons,TotalRecords:e.TotalRecords,SearchFields:e.leftSearchFields,RenderRowActionMethod:e.renderActions,ListDataCallBackFunction:e.FetchData,LegendArray:e.LegendArray,IsFilterApplied:!!e.searchCondition,SortExp:e.SortExp,SortBy:e.SortBy,CurrentPageNumber:e.PageNumber},on:{LeftsearchButtonClick:e.leftCommonSearch,PagerButtonClick:e.pagerMethod,HeaderButtonClick:e.commonHeaderButtonClick,ActionButtonClick:e.actionButtonClick,SortdataButtonClick:e.sortdata},scopedSlots:e._u([{key:"slotdata",fn:function(t){var i=t.data;return["status_id"==i.column.COLUMN_NAME?[e.isCRMShowStausDrop(i.row.status_id,"CRM_DEALS")?a("listing-status",{ref:"updatestatus",attrs:{isfor:"CRM_DEALS",dataid:i.row.deal_id,"data-controller":"Crm",statuslist:e.StatusListForListing,item:i,"data-action":"index",dataselected:i.row.status_id,callbackfunction:e.FetchData,isselectedvaluestring:!0}}):e._e(),e.isCRMShowStausDrop(i.row.status_id,"CRM_DEALS")?e._e():a("a",{staticClass:"inactive-disabled"},[a("span",{class:e.getStatusClass(i.row.status_id,"status_id")},[e._v(" "+e._s(i.row[i.column.COLUMN_NAME])+" ")])])]:e._e()]}}])}),e.showQuickLeadViewModal?a("modalquickviewdetails",{attrs:{sourceIds:e.idForViewRecord,modulename:"CRM",submodulecode:"CRM_DEALS",controller:"crm",actions:"ViewDealDetails"},on:{close:function(t){return e.closeQuickViewModal()}}}):e._e(),e.showNoteModal?a("modalnote",{attrs:{DealInfo:e.DealIdForViewNote,modulename:"CRM",submodulecode:"CRM_DEALS",controller:"crm",actions:"ViewDealDetails",userid:e.userid,curindex:e.CurIndex},on:{close:function(t){e.showNoteModal=!1}}}):e._e(),e.showAddEventModal?a("modalfollowupslist",{attrs:{srcId:e.souceID,DealInfo:e.selectedItem,modulename:"CRM",submodulecode:"CRM_DEALS",userid:e.userid},on:{close:e.closeEventViewModal}}):e._e(),e.showFilter?a("searchfilter",{attrs:{submodulecode:"CRM_DEALS",modulename:"CRM",callbackfunction:e.FetchData},on:{close:function(t){e.showFilter=!1},FilterData:e.FilterData}},[a("h5",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.$t("Search")))])]):e._e(),e.ShowManageView?a("viewlayout",{directives:[{name:"show",rawName:"v-show",value:e.ShowManageView,expression:"ShowManageView"}],attrs:{submodulecode:"CRM_DEALS",modulename:"CRM",callbackfunction:e.FetchData,usertype:e.usertype},on:{close:function(t){e.ShowManageView=!1}}},[a("h5",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.$t("Search")))])]):e._e(),e.showDealOwnerModal?a("modalleadowner",{attrs:{OwnerIds:e.OwnerIds,ModuleType:e.ModuleType},on:{close:e.onCloseDealOwner}},[a("h5",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.$t("DealOwner")))])]):e._e(),e.showAdditionalOwnerPopup?a("addadditionalowner",{attrs:{subModuleCode:"CRM_DEALS"},on:{close:function(t){e.showAdditionalOwnerPopup=!1,e.onChange()}}}):e._e()],1)},s=[],o=a("53ca"),n=a("5530"),l=a("c7eb"),r=a("1da1"),d=(a("d3b7"),a("159b"),a("c740"),a("e9c4"),a("6e8d")),c=a("779d"),u=a("e29d"),h=a("9769"),m=[{title:"Page Tour",iconClass:"fa fa-road",callbackfunction:"setTourGuideSteps",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"Reset",iconClass:"fa-filter text-danger",callbackfunction:"removeFilter",href:"",additionalClass:"",isdisabled:!1,isvisible:!1,checkPrivilege:!1},{title:"Filter",iconClass:"fa-filter",callbackfunction:"openFilterPopUp",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"Manage View",iconClass:"fa-list-alt",callbackfunction:"ManageView",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!1},{title:"Add Deal",iconClass:"fa-plus",href:"/CRM/ManageDeal/0/No/CRM/CRM_DEALS",additionalClass:"",isdisabled:!1,isvisible:!0,checkPrivilege:!0,id:"AddDealContent_a"},{id:"ChangeOwnerId",title:"Change Deal Owner",iconClass:"fa-user",callbackfunction:"ChangeDealOwner",isdisabled:!0,isvisible:!0},{id:"AdditionalOwnerId",title:"AdditionalOwner",iconClass:"fa-user-plus",callbackfunction:"checkPrivilegeDetailsForOwner",isdisabled:!0,isvisible:!0},{title:"ExportToExcel",iconClass:"fa-file-excel-o",callbackfunction:"downloadExceldata",isdisabled:!1,isvisible:!0},{id:"DeleteMultiple",title:"Delete",iconClass:"fa-trash-o",callbackfunction:"commonDeleteData",isdisabled:!0,isvisible:!0}],p=[{fieldName:"DEAL NAME",fieldType:"text",fieldIcon:"fa-file",fieldSearchConditionName:["DEL.DEAL_NAME"],isSearch:!1,value:"",listOptions:[]},{fieldName:"Deal Owner",fieldType:"ddl-check",fieldIcon:"fa-user",fieldSearchConditionName:["deal_owner_id"],isSearch:!1,value:"",listOptions:[]},{fieldName:"Stage",fieldType:"ddl-check",fieldIcon:"fa-server",fieldSearchConditionName:["STG.STAGE_ID"],isSearch:!1,value:"",listOptions:[]},{fieldName:"Status",fieldType:"ddl-check",fieldIcon:"fa fa-file-text-o",fieldSearchConditionName:["DEL.STATUS_ID"],isSearch:!1,value:"",listOptions:[]}],f=[{title:"View",href:"/CRM/ViewDealDetails/{deal_id}/CRM/CRM_DEALS",icon:"fa fa-eye action-icon",additionalSpan:""},{title:"Edit",href:"/CRM/ManageDeal/{deal_id}/Yes/CRM/CRM_DEALS",icon:"fa fa-pencil text-success action-icon",additionalSpan:""},{title:"Notes",callbackfunction:"openNoteListPopUp",href:"javascript:void(0)",icon:"fa fa-sticky-note-o text-primary action-icon",additionalSpan:'<span class="text-primary">({NOTE_COUNT})</span>'},{title:"Follow-Ups",callbackfunction:"openAddNewEvent",href:"javascript:void(0)",icon:"fa fa-flag text-muted action-icon",additionalSpan:""},{title:"Revert to Lead",callbackfunction:"RevertToLead",icon:"fa fa-reply text-danger action-icon",additionalSpan:""}];function v(e,t,a){return _.apply(this,arguments)}function _(){return _=Object(r["a"])(Object(l["a"])().mark((function e(t,a,i){var s,o;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t,o={},o["moduleName"]=a,o["type"]=i,e.next=6,h["a"].GetLeftSearchStatus(o).then((function(e){var t=e.data;if(null!=t){if("LEAD_DEAL_STATUS"==i)return s.leftSearchFields[3].listOptions=t.DATA,s.StatusListForListing=t.DATA,s.StatusListForListing;if("DEAL_OWNER_SEARCH"==i)return s.leftSearchFields[1].listOptions=t.DATA,s.DealOwnerList=t.DATA,s.DealOwnerList;if("CRM_STAGE"==i)return s.leftSearchFields[2].listOptions=t.DATA,s.DealStageList=t.DATA,s.DealStageList}}));case 6:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}var g={buttons:m,leftsearchSchema:p,listActions:f,bindleftCommonSearchdropdown:v},w=a("fc0b"),C=a("555e"),b=a("a2a4"),S=a("cdd5"),D=a("2aeb"),A={components:{viewlayout:S["a"],addadditionalowner:b["a"],modalleadowner:C["a"],TgList:D["a"],modalfollowupslist:u["a"],modalquickviewdetails:d["a"],modalnote:c["a"],searchfilter:w["a"]},data:function(){return{ShowManageView:!1,showDealOwnerModal:!1,isLoading:!1,listheaderbuttons:g.buttons,leftSearchFields:g.leftsearchSchema,DealStatusList:null,DealData:[],clientemail:"",NameSearch:"",CompanyName:"",hdnOwnerId:"",Headers:[],souceID:0,showAddEventModal:!1,TotalRecords:0,PageNumber:1,PageSize:10,SortBy:"",SortExp:"",PageSizeOption:null,CurrentPage:1,TotalPages:0,GroupStart:1,GroupEnd:3,Status:"",OwnerId:"",OwnerIds:[],ModuleType:"",SearchClient:"",leadDateFrom:"",leadDateTo:"",SearchCompay:"",Channel:"",showImportModal:!1,showConvertLead:!1,showAddEmailTemplate:!1,convertLeadValue:{value:null,name:""},modalItem:[],showExportModal:!1,showModal:!1,noRecord:!1,showFilter:!1,searchCondition:"",showQuickLeadViewModal:!1,showNoteModal:!1,isShowLeadNoteDialogue:!1,idForViewRecord:null,NoRecordForTabNotes:!1,LeadIdForViewNote:null,LeadOwnerList:null,LeadStatusList:null,selectedLeadOwner:[],IsAnySearch:!1,CurIndex:0,conditionForInstantSearch:"",showAdditionalOwnerPopup:!1,listActions:g.listActions,StatusListForListing:[],userid:null,companyId:null,LegendArray:[],usertype:null,LoggedinUserId:null,privilegeParams:null,appliedFilter:[]}},created:function(){var e=Object(r["a"])(Object(l["a"])().mark((function e(){var t;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.userid=this.GetUserInfo.ID,this.usertype=this.GetUserInfo.UserType,this.companyId=this.GetUserInfo.CompanyId,this.privilegeParams="controller=CRM&action=",t=this,e.next=6,g.bindleftCommonSearchdropdown(t,"CRM","DEAL_OWNER_SEARCH");case 6:return e.next=8,g.bindleftCommonSearchdropdown(t,"CRM","LEAD_DEAL_STATUS");case 8:return e.next=10,g.bindleftCommonSearchdropdown(t,"CRM","CRM_STAGE");case 10:t.FetchData(),t.LegendArray=[{class:"legend-pending colorboxsquare",text:t.$t("CloseLeadLegend",["Lead"])}];case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{renderActions:function(e){var t=this,a=[];return t.listActions.forEach((function(i){var s=Object(n["a"])({},i);switch(s.title){case"Edit":s.isVisible=(t.isBlank(e.existing_client_id)||t.isBlank(e.project_id))&&"Closed"!=e.status_id&&"Cancelled"!=e.status_id;break;case"FollowUps":s.isVisible="Closed"!=e.status_id;break;case"Revert to Lead":s.isVisible="Active"==e.status_id&&0!=e.Lead_ID&&0==e.Quot_id;break;default:s.isVisible=!0;break}a.push(s)})),a},clickEventOfColumn:function(e,t){"deal_name"==t.COLUMN_NAME&&this.$router.push({path:"/CRM/ViewDealDetails/"+e.deal_id+"/CRM/CRM_DEALS"})},columnDataFormatter:function(e,t){return e[t.COLUMN_NAME]},commonHeaderButtonClick:function(e){switch(e.callbackfunction){case"downloadExceldata":this.FetchData(!0);break;case"sendBulkEmail":break;case"ManageView":this.ManageView();break;case"openFilterPopUp":this.openFilterPopUp();break;case"ChangeDealOwner":this.ChangeDealOwner();break;case"commonDeleteData":this.commonDeleteData();break;case"checkPrivilegeDetailsForOwner":this.checkPrivilegeDetailsForOwner(e,null);break;case"removeFilter":var t=this;t.searchCondition="";var a=t.listheaderbuttons.findIndex((function(e){return"removeFilter"===e.callbackfunction}));t.listheaderbuttons[a].isvisible=!1;var i=t.listheaderbuttons.findIndex((function(e){return"openFilterPopUp"===e.callbackfunction}));t.listheaderbuttons[i].iconClass="fa fa-filter";try{t.appliedFilter=[]}catch(s){}t.FetchData();break;case"setTourGuideSteps":this.setTourGuideSteps(0);break}},RevertToLead:function(e){var t=this,a={ID:e.deal_id,IsFor:"CRM_DEALS"};t.confirmR("Are you sure, You want to revert Deal?",!0,"",(function(){h["a"].RevertToLead(a).then((function(e){var a=e.data;"Success"==a[0].Status&&(t.ShowAlert(t.$t("Deal has been Reverted successfully"),"success",!0,t.$t("Alert")),t.FetchData())}))}))},commonDeleteData:function(e){var t=this;h["a"].CheckPrivilege(t.privilegeParams+"DeleteDeal").then((function(e){if(e.data){var a="";$(".chkItems:checkbox:checked").not("[id^='chkAll']").each((function(){a.length>0&&(a+=","),a+=$(this).val()})),a.length>0?t.confirmR(t.$t("ConfirmDelete"),!0,t.$t("Delete")+"  "+t.$t("Deal"),(function(){var e={ids:a,moduleName:"CRM",subModuleCode:"CRM_DEALS"},i=JSON.stringify(e);h["a"].deleteActivityData(i).then((function(e){var a="";"Success"==e.data[0].Status?($("[id^='chkAll']").prop("checked",!1).removeAttr("checked"),$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),$("[id^='ChangeOwnerId']").removeClass("enable").addClass("disabled"),$("[id^='AdditionalOwnerId']").removeClass("enable").addClass("disabled"),$("[id^='CloseLeadId']").removeClass("enable").addClass("disabled"),$("[id^='DeleteMultiple']").removeClass("enable").addClass("disabled"),t.PageNumber=parseInt(t.PageNumber)-1,t.PageNumber<=0&&(t.PageNumber=1),t.FetchData(),a=t.ShowAlert(t.$t("DeletedSuccess",[t.$t("Deal")]),"success",!0,t.$t("Alert"))):a=t.ShowAlert(t.$t("DeletedError",[t.$t("Deal")]),"success",!0,t.$t("Alert")),setTimeout((function(){a.modal("hide")}),2e3)}))})):t.ShowAlert(t.$t("Selectanyrecordtodelete"),"failure",!0,"Alert")}else t.ShowAlert("You are not authorized","failure",!0,"Alert")}))},currentPageMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchData()},ManageView:function(){var e=this;e.ShowManageView=!0,setTimeout((function(){$("#modalManageView").modal("show"),setTimeout((function(){e.SetBootstraptoolTip()}),200)}),1e3)},leftCommonSearch:function(e){this.PageNumber=e.PageNumber,"undefined"!=typeof e.searchCondition?this.searchCondition=e.searchCondition:this.searchCondition="",this.FetchData()},getRequestParams:function(e,t,a,i,s,o){var n={};return e&&(n["pageNum"]=e),o&&(n["searchcondition"]=o),s&&(n["isPaged"]=s),a&&(n["sortBy"]=a),i&&(n["sortExp"]=i),t&&(n["pageSize"]=t),n},FilterData:function(e,t,a,i,s,n){this.pageNum=e,this.pageSize=t,this.sortBy=a,this.sortExp=i,this.searchCondition=s,null!=Object(o["a"])(n)&&this.appliedFilter.push(n),this.FetchData()},FetchData:function(e){var t=this.getRequestParams(this.pageNum,this.pageSize,this.sortBy,this.sortExp,this.isPaged,this.searchCondition),a=this;this.isLoading=!0,t.pageSize=e?a.TotalRecords:a.PageSize,t.PageNumber=a.PageNumber,t.searchCondition=a.searchCondition,a.PageNumber?t.pageNum=a.PageNumber:a.PageNumber=t.pageNum=1,"undefined"!=a.isPaged?t.isPaged=a.isPaged:a.isPaged=t.isPaged=1,t.isPaged=a.isPaged,t.isPaged=a.isPaged,t.sortBy=a.SortBy,t.sortExp=a.SortExp;var i="";if(this.isBlank(this.searchCondition)||(i+=this.searchCondition),this.isBlank(this.conditionForInstantSearch)||(i+=this.isBlank(this.searchCondition)?this.conditionForInstantSearch:" AND "+this.conditionForInstantSearch),""!=i){if(t.searchCondition=i,a.appliedFilter.length>0){var s=a.listheaderbuttons.findIndex((function(e){return"removeFilter"===e.callbackfunction}));a.listheaderbuttons[s].isvisible=!0;var o=a.listheaderbuttons.findIndex((function(e){return"openFilterPopUp"===e.callbackfunction}));a.listheaderbuttons[o].iconClass="fa fa-filter text-success"}}else if(0==a.appliedFilter.length){var n=a.listheaderbuttons.findIndex((function(e){return"removeFilter"===e.callbackfunction}));a.listheaderbuttons[n].isvisible=!1;var l=a.listheaderbuttons.findIndex((function(e){return"openFilterPopUp"===e.callbackfunction}));a.listheaderbuttons[l].iconClass="fa fa-filter"}e?(console.log(t),t.isPaged=0,a.isLoading=!0,h["a"].DealListing(t).then((function(e){""!=e.data&&null!=e.data?a.JSONToCSVConvertor(e.data,"Deal-Detail",!0):a.ModelnoRecord=!0,a.isLoading=!1}))):(console.log(t),h["a"].DealListing(t).then((function(e){""!=e.data&&null!=e.data?(a.Headers=e.data.schema,a.Headers.forEach((function(e){e.settings=null,"deal_name"==e.COLUMN_NAME&&(e.settings={clickEvent:a.clickEventOfColumn,formatter:a.columnDataFormatter}),"status_id"==e.COLUMN_NAME&&(e.settings={isInSlot:!0})})),e.data.data.length>0?(a.DealData=e.data.data,a.DealData.forEach((function(e){e.isCheckBoxDisabled=!1,e.additionalClass="","Closed"==e.status_id&&(e.isCheckBoxDisabled=!0,e.additionalClass="warning-bar"),e.rowDetailsUrl="",""==e.rowDetailsUrl&&(e.rowDetailsUrl="/CRM/ViewDealDetails/"+e.deal_id+"/CRM/CRM_DEALS")})),a.TotalRecords=e.data.data[0].totalrecords,a.TotalPages=Math.ceil(a.TotalRecords/a.PageSize),a.CurrentPage=a.PageNumber,a.noRecord=!1):(a.noRecord=!0,a.DealData=[],a.TotalRecords=0),a.getStatuslistForListing("CRM","en")):(a.noRecord=!0,a.DealData=[],a.Headers=[],a.TotalRecords=0),setTimeout((function(){a.ResponsiveDataTable("tablelistingdata")}),500),a.isLoading=!1})))},sortdata:function(e){var t="sort tb_headerSortDown";this.SortBy=e,e===this.SortBy&&(""==this.SortExp?(this.SortExp="ASC",t="sort tb_headerSortDown"):"ASC"==this.SortExp?(this.SortExp="DESC",t="sort tb_headerSortUp"):(this.SortExp="ASC",t="sort tb_headerSortDown")),this.FetchData(),$("#"+e+"  span:first-child").attr("class",t)},GetPageSizeOption:function(){for(var e=[],t=10,a=t;a<t+95;a+=5)e.push(a);this.PageSizeOption=e},actionButtonClick:function(e,t,a,i){var s=this;switch(e){case"openQuickLeadViewModal":s.openQuickLeadViewModal(t.deal_id);break;case"checkPrivilegeView":break;case"checkPrivilegeDetails":break;case"openNoteListPopUp":s.openNoteListPopUp(t,a);break;case"openAddNewEvent":s.openAddNewEvent(t.deal_id,t);break;case"RevertToLead":s.RevertToLead(t);break}},pagerMethod:function(e){this.PageSize=e.PageSize,this.PageNumber=e.PageNumber,this.FetchData()},getStatuslistForListing:function(e,t){var a=this,i="langCode="+t+"&statusType="+e+"&hasglobal=true";h["a"].statusdropdown(i).then((function(e){if("Success"==e.data.status){var t=e.data.result;a.StatusListForListing=t.data}}))},checkPrivilegeDetailsForOwner:function(e,t){var a=this;h["a"].CheckPrivilege(a.privilegeParams+"AddAdditionalowner").then((function(e){e.data?a.openAdditionalOwnerpopup():a.ShowAlert("You are not authorized","failure",!0,"Alert")}))},openAdditionalOwnerpopup:function(){this.showAdditionalOwnerPopup=!0},openFilterPopUp:function(e){this.cancelOrRefresh(),this.showFilter=!0},cancelOrRefresh:function(){this.clientemail="",this.selectedLeadOwner="",this.NameSearch="",this.CompanyName="",this.hdnOwnerId="",this.conditionForInstantSearch="",this.IsAnySearch=!1,this.FetchData()},ChangeDealOwner:function(e){var t=this;h["a"].CheckPrivilege(t.privilegeParams+"ChangeLeadOwner").then((function(e){e.data?($(".chkItems:checkbox:checked").not("[id^='chkAll']").not(".CloseDealInput").each((function(){t.OwnerIds.push($(this).val()),t.ModuleType="Deal"})),t.OwnerIds.length>0?t.showDealOwnerModal=!t.showDealOwnerModal:t.ShowAlert(t.$t("Select change lead owner"),"warning",!0,t.$t("Alert"))):vm.ShowAlert("You are not authorized","failure",!0,"Alert")}))},openQuickLeadViewModal:function(e){this.idForViewRecord=e,this.showQuickLeadViewModal=!0},closeQuickViewModal:function(){this.idForViewRecord=null,this.showQuickLeadViewModal=!1},closeEventViewModal:function(){this.showAddEventModal=!1},openAddNewEvent:function(e,t){var a=this;null!=t?(a.souceID=e,a.selectedItem=t,setTimeout((function(){a.showAddEventModal=!a.showAddEventModal}),500)):(a.souceID=e,a.selectedItem=t,setTimeout((function(){console.log(a.$refs.modalfollowupslist),a.showAddEventModal=!a.showAddEventModal}),300))},openNoteListPopUp:function(e,t){var a=this;console.log(e),a.DealIdForViewNote=e,a.showNoteModal=!0,a.CurIndex=t},editDeal:function(e){var t=JSON.stringify({id:e,moduleName:"CRM",subModuleCode:"CRM_DEALS",reqfrom:"/CRM/DealListing",isEdit:"YES"});this.$router.push({name:"CRMManageDeal",params:{data:t}})},onChange:function(){var e=$(".chkItems:checked").not("[id^='chkAll']").length;e>0?($("#ChangeOwnerId").removeClass("disabled"),$("#AdditionalOwnerId").removeClass("disabled")):($("#ChangeOwnerId").addClass("disabled"),$("#AdditionalOwnerId").addClass("disabled"))},onCloseDealOwner:function(){this.showDealOwnerModal=!1,this.FetchData()}},updated:function(){this.BindActionButtonEvent()}},N=A,k=a("2877"),L=Object(k["a"])(N,i,s,!1,null,null,null);t["default"]=L.exports},5166:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".ck-editor__editable[data-v-0532fa68]{min-height:200px!important;border:1px solid #c1c1c1}.validborder[data-v-0532fa68]{border:none!important}.validborder .ck-content[data-v-0532fa68]{border-color:#dc3545!important}",""]),e.exports=t},"555e":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("LeadOwner"))+" ")]),a("button",{staticClass:"close",attrs:{href:"javascript:;"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},[a("Form",{ref:"form"},[a("div",{staticClass:"d-flex flex-wrap"},[a("div",{staticClass:"col-md-12 p-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12 col-md-6 col-lg-6 col-xl-6 float-left"},[a("div",{staticClass:"form-group"},[a("label",[e._v(" "+e._s(e.$t("SelectLeadOwner"))+":"),a("span",{staticClass:"text-danger"},[e._v("*")])]),a("Field",{attrs:{id:"ddl_changeOwner",rules:{required:!0},label:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:e.leadid,expression:"leadid"}],class:{"form-control":!0,"is-invalid":i[0]},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.leadid=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v(e._s(e.$t("Select"))+" "+e._s(e.$t("OWNER")))]),e._l(e.LeadownerArray,(function(t,i){return a("option",{key:i,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])}))],2)]}}])})],1)])]),a("div",{staticClass:"row flex-row-reverse"},[a("div",{staticClass:"col-lg-6 text-right"},[a("button",{staticClass:"btn btn-primary save-btn mr-1",attrs:{type:"button"},on:{click:e.submitChangeOwner}},[a("em",{staticClass:"fa fa-save pr-2",attrs:{"aria-hidden":"true"}}),e._v(e._s(e.$t("Save")))]),a("button",{staticClass:"btn btn-primary delete-btn",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}}),e._v(" "+e._s(e.$t("Cancel")))])]),a("div",{staticClass:"col-lg-6"},[a("div",{staticClass:"py-2"})])])])])])],1)])])])])])},s=[],o=(a("d3b7"),a("25f0"),a("e9c4"),a("9769")),n={props:{OwnerIds:null,ModuleType:""},data:function(){return{leadid:"",LeadownerArray:[],SubModuleCode:"CRM_LEADS"}},created:function(){this.GetLeadOwnerlist(),"Deal"==this.ModuleType&&(this.SubModuleCode="CRM_DEALS")},methods:{GetLeadOwnerlist:function(){var e=this,t="id=&moduleName=CRM&type=CRM_USERS";o["a"].getDDLData(t).then((function(t){var a=t.data;if(null!=a)return e.LeadownerArray=a.DATA,e.LeadownerArray}))},submitChangeOwner:function(){var e=this;console.log(e.$parent),e.$refs.form.validate().then((function(t){if(t)if("Campaign"==e.ModuleType){var a={leadOwner_id:e.leadid,campaign_id:e.$route.params.id,ModuleName:e.$route.params.moduleName,subModule_Code:e.$route.params.subModuleCode,contact_id:e.OwnerIds.toString()},i=JSON.stringify(a);o["a"].ConvertToLeadCampaign(i).then((function(t){"Success"==t.data[0].Status?($("[id^='chkAll']").prop("checked",!1).removeAttr("checked"),$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),e.ShowAlert("Contact has been converted into lead successfully","success",!0,e.$t("Alert")),e.$emit("close")):e.ShowAlert("Something went wrong. Please retry!")}))}else{var s={sourceId:e.activitySourceID,moduleName:"CRM",subModuleCode:e.SubModuleCode,newleadID:e.leadid,checkedIds:e.OwnerIds,ModuleType:e.ModuleType},n=JSON.stringify(s);o["a"].ChangeOwner(n).then((function(t){"Success"==t.data[0].Status&&(e.ShowAlert(e.$t("LeadOwnerChanged",["Deal"==e.ModuleType?e.$t("DealOwner"):e.$t("LeadOwner")]),"success",!0,e.$t("Alert")),e.$emit("close"))}))}}))}}},l=n,r=a("2877"),d=Object(r["a"])(l,i,s,!1,null,null,null);t["a"]=d.exports},"5b81":function(e,t,a){"use strict";var i=a("23e7"),s=a("c65b"),o=a("e330"),n=a("1d80"),l=a("1626"),r=a("44e7"),d=a("577e"),c=a("dc4a"),u=a("90d8"),h=a("0cb2"),m=a("b622"),p=a("c430"),f=m("replace"),v=TypeError,_=o("".indexOf),g=o("".replace),w=o("".slice),C=Math.max,b=function(e,t,a){return a>e.length?-1:""===t?a:_(e,t,a)};i({target:"String",proto:!0},{replaceAll:function(e,t){var a,i,o,m,S,D,A,N,k,L=n(this),y=0,$=0,O="";if(null!=e){if(a=r(e),a&&(i=d(n(u(e))),!~_(i,"g")))throw v("`.replaceAll` does not allow non-global regexes");if(o=c(e,f),o)return s(o,e,L,t);if(p&&a)return g(d(L),e,t)}m=d(L),S=d(e),D=l(t),D||(t=d(t)),A=S.length,N=C(1,A),y=b(m,S,0);while(-1!==y)k=D?d(t(S,y,m)):h(S,m,y,[],void 0,t),O+=w(m,$,y)+k,$=y+A,y=b(m,S,y+N);return $<m.length&&(O+=w(m,$)),O}})},"6e8d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"my-popups"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("LEAD_NAME"))+": "+e._s(e.leadName)+" ")]),a("button",{staticClass:"close",attrs:{href:"javascript:;"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body"},e._l(e.LeftViewData,(function(t,i){return a("div",{key:i,staticClass:"panel1"},[a("div",{staticClass:"heading-border"},[a("h5",{staticClass:"h5 mb-2"},[a("span",[e._v(e._s(e.$t(t.group_name.toUpperCase(),"")))])])]),a("div",{staticClass:"row"},e._l(t.LeftViewData,(function(t,i){return a("div",{key:i,staticClass:"col-md-6 col-lg-3"},[a("div",{staticClass:"form-group"},[a("label",[a("strong",[e._v(e._s(e.$t(t.name.toUpperCase(),t.display_name))+":")]),"date"==t.dt_code||"datetime"==t.dt_code?a("span",{staticClass:"answer rightlabeltext ml-1"},[e._v(" "+e._s(e._f("formatDate")(t.value))+" ")]):e._e(),"decimal"==t.dt_code?a("span",{staticClass:"answer rightlabeltext ml-1"},[e._v(" "+e._s(e._f("currency")(e.isBlank(t.value)?"0.00":t.value))+" ")]):e._e(),"date"!=t.dt_code&&"datetime"!=t.dt_code&&"decimal"!=t.dt_code&&"Lookup"!=t.picklist_options?a("span",{staticClass:"answer rightlabeltext ml-1"},[e._v(" "+e._s(e.isBlank(t.value)?"--":t.value)+" ")]):e._e(),"date"!=t.dt_code&&"datetime"!=t.dt_code&&"decimal"!=t.dt_code&&"Lookup"==t.picklist_options?a("span",{staticClass:"answer rightlabeltext ml-1"},[e._v(" "+e._s(e.isBlank(t.value)?"--":e.FilterDDLandNormalValue(t.value))+" ")]):e._e()])])])})),0)])})),0)])])])],1)])},s=[],o=(a("a9e3"),a("b0c0"),a("ac1f"),a("00b4"),a("9769")),n={props:{modulename:{type:String,required:!0},submodulecode:{type:String,required:!0},sourceIds:{type:Number,required:!0},controller:{type:String,required:!0}},data:function(){return{LeftViewData:[],sourceId:null,ApiURL:"moduleName="+this.modulename+"&subModuleCode="+this.submodulecode,leadName:"--",itemOfListingScreen:null,isLoading:!1}},created:function(){console.log("source "+this.sourceIds),this.sourceId=this.sourceIds,this.itemOfListingScreen=this.$parent.LeadIdForViewNote,this.FetchLeadDetails()},methods:{FetchLeadDetails:function(){var e=this;e.isLoading=!0,e.ApiURL=e.ApiURL+"&id="+e.sourceId,o["a"].getQuickViewDetails(e.ApiURL).then((function(t){e.isLoading=!1;var a=t.data.LEFTDATA,i="",s="";if(a=$.grep(a,(function(e,t){return"client_first_name"==e.name?i=null!=e.value?e.value:"":"client_last_name"==e.name&&(s=null!=e.value?e.value:""),"YES"==e.form_field_visibility})),"--"==e.leadName&&(e.leadName=i+" "+s),null!=a&&a.length>0){var o=a[0].group_id;$.each(a,$.proxy((function(t,i){var s=$.grep(e.LeftViewData,(function(e,t){return e.group_id==o}));if(0==s.length){var n=$.grep(a,(function(e,t){return e.group_id==o}));if(n.length>0){var l={group_id:o,group_name:n[0].group_name,LeftViewData:n};e.LeftViewData.push(l)}}o=i.group_id}),this))}setTimeout((function(){e.CheckBoxBootstrap()}),100),setTimeout((function(){e.RadioButtonBootstrap()}),500)}))},isBlank:function(e){return!e||/^\s*$/.test(e)},FilterDDLandNormalValue:function(e){if(!(e.length>0))return"";try{return JSON.parse(e)[0].name}catch(t){return""}}}},l=n,r=a("2877"),d=Object(r["a"])(l,i,s,!1,null,null,null);t["a"]=d.exports},"779d":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"my-popups"},[a("div",{staticClass:"modal d-block"},[a("div",{staticClass:"modal-dialog modal-dialog-centered"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v(e._s(e.header))]),a("span",{staticClass:"float-right"},["list"==e.NoteListType?a("a",{staticClass:"text-white",attrs:{href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"Card View"},on:{click:function(t){e.NoteListType="card"}}},[a("em",{staticClass:"fa fa-th-large mr-2"}),e._v(e._s(e.$t("CardView"))+" ")]):e._e(),"list"!=e.NoteListType?a("a",{staticClass:"text-white",attrs:{href:"javascript:;","data-toggle-tooltip":"tooltip","data-original-title":"List View"},on:{click:function(t){e.NoteListType="list"}}},[a("em",{staticClass:"fa fa-list mr-2"}),e._v(e._s(e.$t("ListView"))+" ")]):e._e()]),a("button",{staticClass:"close",attrs:{href:"javascript:;"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"modal-body",staticStyle:{"max-height":"600px","overflow-y":"auto"}},[a("div",{},[a("crmnote",{attrs:{notedata:e.noteData,sourceid:e.allIds,modulename:e.modulename,submodulecode:e.submodulecode,callfrom:"quickViewAndNoteJS",userid:e.userid,curIndex:e.curindex,listtype:e.NoteListType,showNotePopUp:e.isShowNotePopup}})],1)]),e.isShowNotePopup?e._e():a("div",{staticClass:"modal-footer AddNote"},[a("div",{staticClass:"col-lg-6 text-right p-0"},[a("a",{staticClass:"btn btn-success formbtn text-white",attrs:{href:"javascript:;"},on:{click:function(t){return e.openShowNotePopup()}}},[a("em",{staticClass:"fa fa-plus pr-2"}),e._v(e._s(e.$t("AddNote"))+" ")])])])])])])])])},s=[],o=(a("a9e3"),a("4de4"),a("d3b7"),a("84a0")),n=a("9769"),l={props:{modulename:{type:String,required:!0},submodulecode:{type:String,required:!0},userid:{type:Number,required:!0},sourcekeyname:{type:String,required:!1},curindex:{type:Number},leadInfo:{type:Object,required:!0},DealInfo:{type:Object,required:!1}},components:{crmnote:o["a"]},data:function(){return{LeadId:null,DealId:null,allIds:null,noteData:[],noteslead:null,crm_NotesId:null,NoRecordForTabNotes:!0,isShowLeadNoteDialogue:!1,editDeleteButonFor:0,header:"",isShowNotePopup:!1,NoteListType:"list"}},watch:{LeadId:function(e){this.allIds=e,this.loadNoteData(e)},DealId:function(e){this.allIds=e,this.loadNoteData(e)}},created:function(){console.log(this.userid);try{this.LeadId=this.leadInfo.lead_id}catch(e){}try{console.log(this.DealInfo.deal_id),this.DealId=this.DealInfo.deal_id}catch(e){}this.header=this.$t("Notes"),null!=this.LeadId?("CRM_LEADS"==this.submodulecode&&(this.NoteListType="list"),this.allIds=this.leadInfo.lead_id,this.loadNoteData(this.LeadId)):null!=this.DealId&&(this.allIds=this.DealInfo.deal_id,"CRM_DEALS"==this.submodulecode&&(this.NoteListType="list"),this.loadNoteData(this.DealId))},methods:{openShowNotePopup:function(){var e=this;if("CRM_LEADS"==this.submodulecode)if(null!=this.leadInfo&&"NO"!=this.leadInfo.is_additional_lead_owner){var t=JSON.parse(vm.leadInfo.is_additional_lead_owner),a=t.filter((function(e){return"AddNote"==e.permission_code}));a.length>0?(e.isShowNotePopup=!0,e.loadNoteData(e.LeadId)):e.ShowAlert(this.$t("additionalOwnerAuthorityWarning"),"warning",!0,this.$t("Alert"))}else e.isShowNotePopup=!0,e.loadNoteData(e.LeadId);else e.isShowNotePopup=!0,null!=e.LeadId?e.loadNoteData(e.LeadId):e.loadNoteData(e.DealId)},loadNoteData:function(e){var t=this,a=e,i="id="+a+"&subModuleCode="+t.submodulecode+"&moduleName="+t.modulename;n["a"].NoteListing(i).then((function(e){if(null!=e.data&&e.data.data.length>0){if(t.noteData=e.data.data,null!=t.noteData&&t.noteData.length>0){var a=t.noteData.filter((function(e){return e.created_by==t.userid}));a.length>0&&(t.editDeleteButonFor=a[0].crm_note_id)}setTimeout((function(){t.CheckBoxBootstrap()}),100),t.NoRecordForTabNotes=!1}else t.NoRecordForTabNotes=!0,t.noteData=[]}))}}},r=l,d=a("2877"),c=Object(d["a"])(r,i,s,!1,null,null,null);t["a"]=c.exports},"84a0":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[e.isShowNoteDialogue?a("div",{class:{"feedback-ticket feedback-ticket-present-answersDiv mb-2":!0,"border p-3":!e.isShowNoteDialogue||"quickViewAndNoteJS"!=e.callfrom}},[a("div",{staticClass:"heading-border"},[a("h5",{staticClass:"h5 mb-2"},[a("span",[e._v(" "+e._s(e.$t("AddNotes")))])])]),a("div",{staticClass:"feedback-ticket-content"},[a("Form",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.values,s=t.meta;return[a("div",{staticClass:"feedback-conversation-box",staticStyle:{padding:"none"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left"},[a("div",{staticClass:"form-group"},[a("label",[e._v(e._s(e.$t("Visibility"))+" :")]),a("div",{staticClass:"pl-0 border-0"},[a("div",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-radio custom-control-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.IsPrivate,expression:"IsPrivate"}],staticClass:"custom-control-input dynamic",attrs:{type:"radio",id:"radio_Public",value:"0",name:"rdo_ForNote",checked:"checked"},domProps:{checked:e._q(e.IsPrivate,"0")},on:{change:function(t){e.IsPrivate="0"}}}),a("label",{staticClass:"custom-control-label",attrs:{for:"radio_Public"}},[e._v(" "+e._s(e.$t("Public"))+" ")])])]),a("div",{staticClass:"form-check form-check-inline"},[a("div",{staticClass:"custom-control custom-radio custom-control-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.IsPrivate,expression:"IsPrivate"}],staticClass:"custom-control-input",attrs:{id:"radio_Private",type:"radio",value:"1",name:"rdo_ForNote"},domProps:{checked:e._q(e.IsPrivate,"1")},on:{change:function(t){e.IsPrivate="1"}}}),a("label",{staticClass:"custom-control-label",attrs:{for:"radio_Private"}},[e._v(" "+e._s(e.$t("Private"))+" ")])])])])])])]),a("div",{staticClass:"conversation-content feedback-conversation-content"},[a("Field",{attrs:{name:"note",rules:{required:!0},label:"Note"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[a("ckeditor",{attrs:{editor:e.editor},model:{value:e.note,callback:function(t){e.note=t},expression:"note"}}),a("span",{staticClass:"invalid-feedback d-block",attrs:{name:"note"}},[e._v(e._s(i[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 p-0 mt-3 text-right"},[a("div",{staticClass:"form-group mb-0"},[a("div",{staticClass:"search-btm-btn"},[a("a",{staticClass:"btn btn-success save-btn mr-1",attrs:{href:"javascript:;",title:"Save"},on:{"~click":function(t){return e.saveNote(i,s)}}},[a("em",{staticClass:"fa fa-save pr-2 text-white"}),e._v(e._s(e.$t("Save"))+" ")]),a("a",{staticClass:"btn btn-danger delete-btn",attrs:{href:"javascript:;",title:"Cancel"},on:{click:function(t){return e.closeNoteDialogue()}}},[a("em",{staticClass:"fa fa-close pr-2 text-white"}),e._v(e._s(e.$t("Cancel")))])]),a("div",{staticStyle:{clear:"both"}})])])]}}],null,!1,2654907794)})],1)]):e._e(),e.isShowNoteDialogue&&"quickViewAndNoteJS"==e.callfrom?e._e():a("div",{staticClass:"pb-2 d-inline-block"},[a("span",{staticClass:"legend-Progress colorboxsquare"}),e._v(e._s(e.$t("Private"))+" "+e._s(e.$t("NOTE"))+" "),a("span",{staticClass:"legend-upcoming colorboxsquare ml-3"}),e._v(e._s(e.$t("Public"))+" "+e._s(e.$t("NOTE"))+" ")]),e.isShowNoteDialogue&&"quickViewAndNoteJS"==e.callfrom?e._e():a("div",{staticClass:"col-12 p-0"},[a("div",{staticClass:"container-fluid p-0"},[e.NoRecordForTab?a("div",{staticClass:"text-center text-danger p-4 border"},[e._v(e._s(e.NoRecordFoundText))]):e._e(),a("div",{staticStyle:{clear:"both"}}),"list"!=e.ListTypeForViewChange?a("div",{staticClass:"row ticket-card-container card-view bg-border p-0"},e._l(e.NoteData,(function(t,i){return a("div",{key:i,staticClass:"col-md-12 col-lg-6 col-xl-3 mb-3",staticStyle:{"min-width":"257px"}},[a("div",{class:{"card-box":!0,"blue-bg-light":!t.IS_PRIVATE,"green-bg-light":t.IS_PRIVATE}},[a("div",{staticClass:"card-heading d-flex align-items-center"},[a("span",{staticClass:"user-img-con mr-2"},[a("img",{attrs:{src:null!=t.PROFILE_PATH&&""!=t.PROFILE_PATH?t.PROFILE_PATH:"/Content/images/uc/uc_user_new.jpg",alt:""}})]),e._v(" "+e._s(t.notes_created_by)+" ")]),a("div",{staticClass:"card-detail-main",staticStyle:{"max-height":"150px"}},[a("div",{staticClass:"card-detail"},[a("em",{staticClass:"fa fa-address-card",attrs:{"aria-hidden":"true"}}),a("span",[e._v(e._s(t.crm_designation))])]),a("div",{staticStyle:{clear:"both"}}),a("crmreadmore",{attrs:{callFrom:"Notes",data:t.crm_notes,"v-html":t.crm_notes,heading:e.$t("NOTE"),length:"100"}})],1),a("div",{staticClass:"bottom-action"},[a("div",{staticClass:"card-date"},[a("em",{staticClass:"fa fa-calendar-o",attrs:{"aria-hidden":"true"}}),a("span",[e._v("  "+e._s(e._f("formatDateTime")(t.note_date)))])]),e.userid==t.created_by&&t.crm_note_id==e.editDeleteButonFor?a("div",{staticClass:"card-action"},[e.userid==t.created_by&&t.crm_note_id==e.editDeleteButonFor?a("a",{staticClass:"round-icon-small btn-success-light",attrs:{href:"javascript:;"},on:{click:function(a){return e.editNote(t)}}},[a("em",{staticClass:"fa fa-pencil",attrs:{"aria-hidden":"true"}})]):e._e(),e.userid==t.created_by&&t.crm_note_id==e.editDeleteButonFor?a("a",{staticClass:"round-icon-small btn-danger-light",attrs:{href:"javascript:;",id:"DeleteNote"},on:{click:function(a){return e.deleteNote(t.crm_note_id)}}},[a("em",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]):e._e()]):e._e()])])])})),0):e._e()]),"list"==e.ListTypeForViewChange?e._l(e.NoteData,(function(t,i){return a("div",{key:i,staticClass:"conversation-main"},[a("div",{staticClass:"conversation-time"},[a("span",[e._v(e._s(e.formatTime(t.note_date)))])]),e.NoRecordForTab?e._e():a("div",{staticClass:"conversation-box-con"},[a("div",{class:{"conversation-box":!0,"public-note":!t.IS_PRIVATE,"private-note":t.IS_PRIVATE}},[a("div",{staticClass:"name-circle light-grey"},[a("img",{staticClass:"img-circle avatar img-max-width",attrs:{src:null!=t.PROFILE_PATH&&""!=t.PROFILE_PATH?t.PROFILE_PATH:"/Content/images/DefaultImages/uc_user_new.jpg",alt:""}})]),a("div",{staticClass:"conversation-header"},[a("span",[a("span",{staticClass:"sender-name"},[e._v(e._s(t.notes_created_by))]),a("span",{staticClass:"sender-department"},[e._v("("),a("small",{staticClass:"text-danger font-14",attrs:{title:e._f("formatDateTime")(t.note_date)}},[e._v(e._s(e._f("formatDateTime")(t.note_date)))]),e._v(")")])]),a("span",{},[e.userid==t.created_by?a("a",{staticClass:"round-icon-small btn-danger-light float-right",attrs:{href:"javascript:;",id:"DeleteNote"},on:{click:function(a){return e.deleteNote(t.crm_note_id)}}},[a("em",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]):e._e(),e.userid==t.created_by?a("a",{staticClass:"round-icon-small btn-success-light float-right",attrs:{href:"javascript:;"},on:{click:function(a){return e.editNote(t)}}},[a("em",{staticClass:"fa fa-pencil",attrs:{"aria-hidden":"true"}})]):e._e()])]),a("div",{staticClass:"conversation-content"},[a("p",{domProps:{innerHTML:e._s(t.crm_notes)}})])])])])})):e._e()],2)])},s=[],o=(a("a9e3"),a("ac1f"),a("1276"),a("5319"),a("498a"),a("4de4"),a("d3b7"),a("3ca3"),a("ddb0"),a("9861"),a("841c"),a("e9c4"),a("c1df")),n=a.n(o),l=a("3e9a"),r=a("9769"),d=a("fb3d"),c=a.n(d),u={components:{crmreadmore:l["a"],ClassicEditor:c.a},props:{notedata:{type:Array,required:!0},userid:{type:Number,required:!0},sourceid:null,modulename:{type:String,required:!0},submodulecode:{type:String,required:!0},callfrom:{type:String},curIndex:{type:Number},listtype:{type:String},showNotePopUp:{type:Boolean}},data:function(){return{NoteData:[],NoRecordForTab:!0,LeadStatus:this.$parent.LeadStatus,isShowNoteDialogue:!1,note:"",crmNoteId:null,editDeleteButonFor:0,isShowFulleNote:!1,FulleNoteToShow:"",IsPrivate:"0",TotalCount:0,ListTypeForViewChange:"list",NoRecordFoundText:this.$t("Loading"),editor:c.a,userTimeZone:null}},created:function(){this.userTimeZone=this.GetUserInfo.TimeZone.split(":"),String.prototype.format=function(){var e=arguments;return this.replace(/{([0-9]+)}/g,(function(t,a){return"undefined"==typeof e[a]?t:e[a]}))}},watch:{listtype:function(e){this.ListTypeForViewChange=e},notedata:function(e){var t=this;if(t.ListTypeForViewChange=""!=$.trim(t.listtype)?t.listtype:t.ListTypeForViewChange,t.TotalCount=e.length,t.NoteData=e,t.NoRecordForTab=!(null!=t.NoteData&&t.NoteData.length>0),t.NoRecordForTab&&(t.NoRecordFoundText=t.$t("NoRecordfound")),t.isShowNoteDialogue=t.showNotePopUp,t.crmNoteId=null,t.note="",null!=t.NoteData&&t.NoteData.length>0){var a=t.NoteData.filter((function(e){return e.created_by==t.userid}));a.length>0&&(t.editDeleteButonFor=a[0].crm_note_id)}}},methods:{onReady:function(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement())},formatTime:function(e){if(e)try{var t="h:mm A";t=String(t).replace("t","A").replace("t","");var a=new Date(n()(String(e)).year(),n()(String(e)).month(),n()(String(e)).date(),n()(String(e)).hours(),n()(String(e)).minutes());return n()(a,"h:mm A").format(String(t))}catch(i){return t=String(t).replace("t","a").replace("t",""),n()(String(e)).format(String("h:mm A").toUpperCase()+" "+String(t))}},openNoteDialogue:function(){"undefined"===typeof this.$parent.checkForAdditionalPermission||this.$parent.checkForAdditionalPermission("AddNote")?(this.isShowNoteDialogue=!0,this.IsPrivate="0",this.NoRecordForTab=!this.isShowNoteDialogue):alertR(Globalize.localize("additionalOwnerAuthorityWarning"),!0,this.$t("Alert"))},closeNoteDialogue:function(){var e=this;if(e.note="",e.IsPrivate="0","quickViewAndNoteJS"==e.callfrom){console.log(e.$parent),e.$parent.isShowNotePopup=!1;var t=new URLSearchParams(window.location.search),a=t.get("reqfrom");null==a&&(a=0);var i=parseInt(a)||0;i>0&&e.$parent.loadNoteData(e.sourceid)}else e.$parent.loadData("notes");$(".AddNote").removeClass("d-none"),e.isShowNoteDialogue=!1,e.NoRecordForTab=!(null!=e.NoteData&&e.NoteData.length>0),e.crmNoteId=null},saveNote:function(e,t){var a=this,i=new URLSearchParams(window.location.search),s=i.get("reqfrom");null==s&&(s=window.location.pathname.indexOf("Listing")>-1||window.location.pathname.indexOf("Index")>-1?1:0);var o=parseInt(s)||0;this.$refs.form.validate().then((function(e){if(e){var t={sourceId:a.sourceid,moduleName:a.modulename,subModuleCode:a.submodulecode,note:a.note,isPrivate:a.IsPrivate,crmNotesId:a.crmNoteId},i=JSON.stringify(t);r["a"].SaveNoteData(i).then((function(e){"Success"==e.data[0].Status&&("CRM_LEADS"==a.submodulecode&&o>0&&(a.$parent.leadInfo.note_count=a.TotalCount+1),"CRM_DEALS"==a.submodulecode&&o>0&&(a.$parent.DealInfo.NOTE_COUNT=a.TotalCount+1),a.closeNoteDialogue(),a.ShowAlert(a.$t("InterviewStageAdded",[a.$t("Note")]),"Success",!0,a.$t("Alert")),o>0?a.$parent.loadNoteData(a.sourceid):a.$parent.loadData("notes","savenote"),a.note="",a.isShowNoteDialogue=!1,$(".AddNote").removeClass("d-none"))}))}}))},editNote:function(e){$("#DeleteNote").addClass("disabled"),$(".AddNote").addClass("d-none");var t=this;t.isShowNoteDialogue=!0,t.note=e.crm_notes,t.IsPrivate=e.IS_PRIVATE?"1":"0",t.crmNoteId=e.crm_note_id},deleteNote:function(e){var t=this,a=new URLSearchParams(window.location.search),i=a.get("reqfrom");null==i&&(i=window.location.pathname.indexOf("Listing")>-1||window.location.pathname.indexOf("Index")>-1?1:0);var s=parseInt(i)||0;t.confirmR(this.$t("ConfirmDelete"),this.$t("Delete"),this.$t("Note"),(function(){var a={ids:e,moduleName:t.modulename,subModuleCode:t.submodulecode,refCode:"DELETE_VIEW_CRM_NOTE"},i=JSON.stringify(a);r["a"].CommonDelete(i).then((function(e){var a="";"Success"==e.data[0].Status?("CRM_LEADS"==t.submodulecode&&s>0&&(t.$parent.$parent.leadInfo.note_count=t.TotalCount-1),"CRM_DEALS"==t.submodulecode&&s>0&&(t.$parent.$parent.DealInfo.note_count=t.TotalCount-1),"quickViewAndNoteJS"==t.callfrom&&s>0?t.$parent.$parent.loadNoteData(t.sourceid):t.$parent.loadData("notes"),a=t.ShowAlert(t.$t("DeletedSuccess",[t.$t("NOTE")]),"success",!0,t.$t("Alert"))):a=t.ShowAlert(t.$t("DeletedError",[t.$t("NOTE")]),"failure",!0,t.$t("Alert")),setTimeout((function(){a.modal("hide")}),2e3)}))}))},returnShortNoteString:function(e,t){var a=document.implementation.createHTMLDocument().createElement("div");return a.innerHTML=e,noteHtmlData=a.innerText,noteHtmlData.length<=t?e:noteHtmlData.substring(0,t)},isShowReadMoreButtton:function(e,t){var a=document.implementation.createHTMLDocument().createElement("div");return a.innerHTML=e,noteHtmlData=a.innerText,!(noteHtmlData.length<=t)},openFullNoteModal:function(e){this.FulleNoteToShow=e,this.isShowFulleNote=!0}}},h=u,m=(a("1b4a"),a("2877")),p=Object(m["a"])(h,i,s,!1,null,"0532fa68",null);t["a"]=p.exports},a2a4:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal d-block my-popups dialog"},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._t("headerForModal",(function(){return[a("h5",{staticClass:"modal-title"},[e._v(e._s(e.$t("AdditionalOwner")))])]})),a("button",{staticClass:"close",attrs:{type:"button",title:"","data-original-title":"Close"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])],2),a("div",{staticClass:"modal-body"},[a("Form",{ref:"form"},[a("div",{staticClass:"d-flex flex-wrap"},[a("div",{staticClass:"col-md-12 p-0"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left"},[a("div",{staticClass:"form-group"},["CRM_DEALS"==e.subModuleCode?a("label",[e._v(" "+e._s(e.$t("DealOwner"))+": "),a("span",{staticClass:"text-danger"},[e._v("*")])]):a("label",[e._v(" "+e._s(e.$t("LeadOwner"))+": "),a("span",{staticClass:"text-danger"},[e._v("*")])]),a("Field",{attrs:{name:"name",rules:{required:!0},label:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors,s=t.changed;return[a("Multiselect",{attrs:{object:!0,label:"label","show-labels":!1,multiple:!0,taggable:!0,"track-by":"value",placeholder:"CRM_DEALS"==e.subModuleCode?"Deal Owner Search":"Lead Owner Search",searchable:!0,options:e.leadOwnerList},on:{"update:modelValue":s},model:{value:e.leadOwner,callback:function(t){e.leadOwner=t},expression:"leadOwner"}}),a("span",{staticClass:"invalid-feedback d-block",attrs:{name:"name"}},[e._v(e._s(i[0]))])]}}])})],1)]),a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 mb-3 float-left listing"},[a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-bordered mb-0",attrs:{"aria-describedby":"addaddtionalowner"}},[a("thead",{staticClass:"thead-bg"},[a("tr",[a("th",{attrs:{scope:"col"}},[a("span",[e._v(e._s(e.$t("Permission"))+" "+e._s(e.$t("For")))])]),a("th",{attrs:{scope:"col"}},[a("span",[e._v(e._s(e.$t("View")))])]),a("th",{attrs:{scope:"col"}},[a("span",[e._v(e._s(e.$t("Add")))])]),a("th",{attrs:{scope:"col"}},[a("span",[e._v(e._s(e.$t("Update")))])]),a("th",{attrs:{scope:"col"}},[a("span",[e._v(e._s(e.$t("Delete")))])])])]),a("tbody",e._l(e.permissions,(function(t){return a("tr",{attrs:{Key:t}},[a("td",{attrs:{"data-id":"item.crmModuleId"}},[e._v(e._s(t.crmModuleName))]),a("td",[t.View.length>0?a("label",{staticClass:"switch"},[t.View.length>0?a("input",{directives:[{name:"model",rawName:"v-model",value:t.View[0].isSelected,expression:"item.View[0].isSelected"}],staticClass:"form-check-input rdoticketfor custom-control-input dynamic",attrs:{type:"checkbox",disabled:t.View[0].isDisable,onchange:e.clickOnView(t)},domProps:{value:t.View[0].permission_id,checked:1==t.View[0].isSelected,checked:Array.isArray(t.View[0].isSelected)?e._i(t.View[0].isSelected,t.View[0].permission_id)>-1:t.View[0].isSelected},on:{change:function(a){var i=t.View[0].isSelected,s=a.target,o=!!s.checked;if(Array.isArray(i)){var n=t.View[0].permission_id,l=e._i(i,n);s.checked?l<0&&e.$set(t.View[0],"isSelected",i.concat([n])):l>-1&&e.$set(t.View[0],"isSelected",i.slice(0,l).concat(i.slice(l+1)))}else e.$set(t.View[0],"isSelected",o)}}}):e._e(),a("span",{staticClass:"slider round"},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])]):e._e()]),a("td",[t.Add.length>0?a("label",{staticClass:"switch"},[t.Add.length>0?a("input",{directives:[{name:"model",rawName:"v-model",value:t.Add[0].isSelected,expression:"item.Add[0].isSelected"}],staticClass:"form-check-input rdoticketfor custom-control-input dynamic",attrs:{type:"checkbox",disabled:t.Add[0].isDisable,onchange:e.clickOnAdd(t)},domProps:{value:t.Add[0].permission_id,checked:1==t.Add[0].isSelected,checked:Array.isArray(t.Add[0].isSelected)?e._i(t.Add[0].isSelected,t.Add[0].permission_id)>-1:t.Add[0].isSelected},on:{change:function(a){var i=t.Add[0].isSelected,s=a.target,o=!!s.checked;if(Array.isArray(i)){var n=t.Add[0].permission_id,l=e._i(i,n);s.checked?l<0&&e.$set(t.Add[0],"isSelected",i.concat([n])):l>-1&&e.$set(t.Add[0],"isSelected",i.slice(0,l).concat(i.slice(l+1)))}else e.$set(t.Add[0],"isSelected",o)}}}):e._e(),a("span",{staticClass:"slider round"},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])]):e._e()]),a("td",[t.Update.length>0?a("label",{staticClass:"switch"},[t.Update.length>0?a("input",{directives:[{name:"model",rawName:"v-model",value:t.Update[0].isSelected,expression:"item.Update[0].isSelected"}],staticClass:"form-check-input rdoticketfor custom-control-input dynamic",attrs:{type:"checkbox",disabled:t.Update[0].isDisable,onchange:e.clickOnUpdate(t)},domProps:{value:t.Update[0].permission_id,checked:1==t.Update[0].isSelected,checked:Array.isArray(t.Update[0].isSelected)?e._i(t.Update[0].isSelected,t.Update[0].permission_id)>-1:t.Update[0].isSelected},on:{change:function(a){var i=t.Update[0].isSelected,s=a.target,o=!!s.checked;if(Array.isArray(i)){var n=t.Update[0].permission_id,l=e._i(i,n);s.checked?l<0&&e.$set(t.Update[0],"isSelected",i.concat([n])):l>-1&&e.$set(t.Update[0],"isSelected",i.slice(0,l).concat(i.slice(l+1)))}else e.$set(t.Update[0],"isSelected",o)}}}):e._e(),a("span",{staticClass:"slider round"},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])]):e._e()]),a("td",[t.Delete.length>0?a("label",{staticClass:"switch"},[t.Delete.length>0?a("input",{directives:[{name:"model",rawName:"v-model",value:t.Delete[0].isSelected,expression:"item.Delete[0].isSelected"}],staticClass:"form-check-input rdoticketfor custom-control-input dynamic",attrs:{type:"checkbox",disabled:t.Delete[0].isDisable,onchange:e.clickOnDelete(t)},domProps:{value:t.Delete[0].permission_id,checked:1==t.Delete[0].isSelected,checked:Array.isArray(t.Delete[0].isSelected)?e._i(t.Delete[0].isSelected,t.Delete[0].permission_id)>-1:t.Delete[0].isSelected},on:{change:function(a){var i=t.Delete[0].isSelected,s=a.target,o=!!s.checked;if(Array.isArray(i)){var n=t.Delete[0].permission_id,l=e._i(i,n);s.checked?l<0&&e.$set(t.Delete[0],"isSelected",i.concat([n])):l>-1&&e.$set(t.Delete[0],"isSelected",i.slice(0,l).concat(i.slice(l+1)))}else e.$set(t.Delete[0],"isSelected",o)}}}):e._e(),a("span",{staticClass:"slider round"},[a("span",{staticClass:"slider-yes"},[e._v(e._s(e.$t("Yes")))]),a("span",{staticClass:"slider-no"},[e._v(e._s(e.$t("No")))])])]):e._e()])])})),0)])])])]),a("div",{staticClass:"row flex-row-reverse"},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success save-btn mr-1",attrs:{href:"javascript:;",title:""},on:{click:function(t){return e.saveAdditionalOwnerPermission()}}},[a("em",{staticClass:"fa fa-save pr-2"}),e._v(" "+e._s(e.$t("Save"))+" ")]),a("a",{staticClass:"btn btn-danger delete-btn",attrs:{href:"javascript:;"},on:{click:function(t){return e.$emit("close")}}},[a("em",{staticClass:"fa fa-times"}),e._v(" "+e._s(e.$t("Cancel"))+" ")])]),a("div",{staticClass:"col-lg-6"},[e.chkpermission?a("div",{staticClass:"py-2"},[a("small",{staticClass:"text-danger"},[e._v(e._s(e.$t("requiredpermission")))])]):e._e()])])])])])],1)])])])])},s=[],o=(a("d81d"),a("b0c0"),a("4de4"),a("d3b7"),a("99af"),a("ac1f"),a("5319"),a("5b81"),a("e9c4"),a("9769")),n={props:{subModuleCode:null},data:function(){return{leadOwner:[],leadOwnerList:[],leadOwnerListAll:[],permissions:[],chkpermission:!1,additionalLeadOwnerIdForEdit:null,vSelectValidate:!1}},created:function(){this.additionalLeadOwnerIdForEdit=this.$parent.additionalLeadOwnerId,this.getLeadOwnerList(),this.GetAllLeadOwnerPermission()},methods:{getLeadOwnerList:function(){var e=this,t="id=&moduleName=CRM&type=CRM_USERS";o["a"].getDDLData(t).then((function(t){var a=t.data;if(null!=a)if(e.leadOwnerList=a.DATA,e.leadOwnerList=e.leadOwnerList.map((function(e){return{value:e.value,label:e.name}})),e.leadOwnerListAll=a.DATA,e.additionalLeadOwnerIdForEdit>0){var i=e.$parent.additionalLeadOwners.filter((function(e){return 1==e.IS_DEFAULT}));$.each(i,(function(t,a){e.leadOwnerList=e.leadOwnerList.filter((function(e){return e.value!=a.LEAD_OWNER_ID}))})),e.leadOwner=e.leadOwnerList.filter((function(t){return t.value==e.additionalLeadOwnerIdForEdit})),e.leadOwnerListAll=e.leadOwnerList}else $.each(e.$parent.additionalLeadOwners,(function(t,a){e.leadOwnerList=e.leadOwnerList.filter((function(e){return e.value!=a.LEAD_OWNER_ID}))})),e.leadOwnerListAll=e.leadOwnerList}))},clickOnView:function(e){var t=this;e.View[0].isSelected?(t.chkpermission=!1,e.Add.length>0&&(e.Add[0].isDisable=!1),e.Update.length>0&&(e.Update[0].isDisable=!1),e.Delete.length>0&&(e.Delete[0].isDisable=!1)):(e.Add.length>0&&(e.Add[0].isDisable=!0,e.Add[0].isSelected=!1),e.Update.length>0&&(e.Update[0].isDisable=!0,e.Update[0].isSelected=!1),e.Delete.length>0&&(e.Delete[0].isDisable=!0,e.Delete[0].isSelected=!1))},clickOnAdd:function(e){var t=this;e.Add[0].isSelected&&(t.chkpermission=!1)},clickOnUpdate:function(e){var t=this;e.Update[0].isSelected&&(t.chkpermission=!1)},clickOnDelete:function(e){var t=this;e.Delete[0].isSelected&&(t.chkpermission=!1)},GetAllLeadOwnerPermission:function(){var e=this,t=null!=this.additionalLeadOwnerIdForEdit?this.additionalLeadOwnerIdForEdit:null,a="CRM_DEALS"==e.subModuleCode?"subModuleCode=CRM_DEALS&leadOwner=".concat(t,"&leadId=").concat(e.$route.path.indexOf("Listing")>-1||e.$route.path.indexOf("Index")>-1?null:e.$route.params.id):"subModuleCode=CRM_LEADS&leadOwner=".concat(t,"&leadId=").concat(e.$route.path.indexOf("Listing")>-1||e.$route.path.indexOf("Index")>-1?null:e.$route.params.id);a=a.replaceAll("null",""),o["a"].GetAllLeadOwnerPermission(a).then((function(t){if(null!=t.data){var a=t.data.permission,i=t.data.assignedPermission;$.each(a,(function(t,s){var o=$.grep(e.permissions,(function(e,t){return e.crmModuleId==s.crm_module_id}));if(0==o.length&&(o=$.grep(a,(function(e,t){return e.crm_module_id==s.crm_module_id})),o.length>0)){var n=[],l=o.filter((function(e){return"View"==e.permission_name}));$.each(o,(function(e,t){var a=[];i.length>0&&(a=i.filter((function(e){return e.permission_id==t.permission_id})));var s={permission_name:t.permission_name,permission_id:t.permission_id,isSelected:a.length>0,isDisable:"View"!=t.permission_name&&0!=l.length};n.push(s)}));var r={crmModuleId:s.crm_module_id,crmModuleName:s.module_name,View:n.filter((function(e){return"View"==e.permission_name})),Add:n.filter((function(e){return"Add"==e.permission_name})),Update:n.filter((function(e){return"Update"==e.permission_name})),Delete:n.filter((function(e){return"Delete"==e.permission_name}))};e.permissions.push(r)}}))}}))},saveAdditionalOwnerPermission:function(){var e=this,t="";e.chkpermission=!0,e.$refs.form.validate().then((function(a){if(a&&e.leadOwner.length>0){$.each(e.leadOwner,(function(e,a){t+=""==t?a.value:","+a.value}));var i="";$(".chkItems:checkbox:checked").each((function(){i.length>0&&(i+=","),i+=$(this).val()}));var s={leadOwner:t,leadId:""==i?e.$route.params.id:i,permissionIds:""},n="";$.each(e.permissions,(function(e,t){t.View.length>0&&t.View[0].isSelected&&(n+=""==n?t.View[0].permission_id:","+t.View[0].permission_id),t.Add.length>0&&t.Add[0].isSelected&&(n+=""==n?t.Add[0].permission_id:","+t.Add[0].permission_id),t.Update.length>0&&t.Update[0].isSelected&&(n+=""==n?t.Update[0].permission_id:","+t.Update[0].permission_id),t.Delete.length>0&&t.Delete[0].isSelected&&(n+=""==n?t.Delete[0].permission_id:","+t.Delete[0].permission_id)})),s.permissionIds=n;var l=JSON.stringify(s);"CRM_DEALS"==e.subModuleCode||window.location.pathname.indexOf("DealListing")>-1?o["a"].saveAdditionalDealOwnerPermission(l).then((function(t){null!=t&&"Success"==t.data[0].Status&&(e.ShowAlert(e.$t("RecordsSavedSuccessfully")),e.$parent.showAdditionalOwnerPopup=!1,$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),$("#DeleteMultiple").addClass("disabled"),e.$route.params.id>0&&e.$parent.loadData("CRM_DEALS"==e.subModuleCode?"additionalDealowners":"additionalleadowners"),e.$emit("close"))})):o["a"].saveAdditionalOwnerPermission(l).then((function(t){null!=t&&"Success"==t.data[0].Status&&(e.ShowAlert(e.$t("RecordsSavedSuccessfully")),e.$parent.showAdditionalOwnerPopup=!1,$(".chkItems:checkbox:checked").prop("checked",!1).removeAttr("checked"),$("#DeleteMultiple").addClass("disabled"),e.$route.params.id>0&&e.$parent.loadData("additionalleadowners"),e.$emit("close"))}))}}))}}},l=n,r=a("2877"),d=Object(r["a"])(l,i,s,!1,null,null,null);t["a"]=d.exports}}]);
//# sourceMappingURL=CRMDeal.js.map