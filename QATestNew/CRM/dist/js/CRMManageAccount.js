(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CRMManageAccount"],{"97c3":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"main-content"},[a("div",{attrs:{id:"divMainLeadData"}},[a("loader",{attrs:{"is-visible":t.isLoading}}),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 padding-t_8"},[a("div",{staticClass:"theme-primary partition-full"},[a("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("Manage"))+" "+t._s(t.$t("Account")))]),a("span",{staticClass:"p-actions float-right"},[a("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/CRM/Accounts",title:"",id:"backtolist","data-original-title":t.$t("BacktoList")}},[a("em",{staticClass:"fa fa-angle-double-left pr-2"}),a("br"),t._v(t._s(t.$t("BacktoList")))])],1)])])]),a("div",{staticClass:"border p-3"},[a("Form",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(e){var n=e.valid,o=e.errors;return[a("DynamicForm",{attrs:{schema:t.GroupBy,dateformat:t.dateformat,subModuleCode:"ManageAccount"},on:{openaddIndustrypopup:t.openaddIndustrypopup,FillDropdown:t.FillDropdown,onSearchDDL:t.onSearch,setSelectedValue:t.setSelectedValue}}),t.divchkhide?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left my-2"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"float-left"},[a("input",{staticClass:"ml-3",attrs:{id:"chkcontactinfo",value:"1",type:"checkbox"},on:{change:function(e){return t.ChkContactbox(e)}}})]),a("div",{staticClass:"float-left pt-1"},[a("span",{staticStyle:{"font-weight":"500"}},[t._v("Tick to add Contact.")])])])])]):t._e(),t.IscheckContact?a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-12 mt-4"},[a("div",{staticClass:"heading-border mb-2"},[a("h5",{staticClass:"h5"},[a("span",[t._v(t._s(t.$t("ContactInformation")))])])])]),a("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[a("div",{staticClass:"form-group"},[a("label",[t._v(t._s(t.$t("FirstName"))+":"),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("Field",{attrs:{name:"FirstName",rules:{required:!0},label:"First Name"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors,o=e.touched,i=e.invalid;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.txtfirstname,expression:"txtfirstname"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",name:"FirstName",maxlength:"100"},domProps:{value:t.txtfirstname},on:{input:function(e){e.target.composing||(t.txtfirstname=e.target.value)}}}),a("span",{staticClass:"invalid-feedback",attrs:{name:"FirstName"}},[t._v(t._s(n[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[a("div",{staticClass:"form-group"},[a("label",[t._v(t._s(t.$t("LastName"))+":"),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("Field",{attrs:{name:"LastName",rules:{required:!0},label:"Last Name"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors,o=e.touched,i=e.invalid;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.txtlastname,expression:"txtlastname"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",name:"LastName",maxlength:"100"},domProps:{value:t.txtlastname},on:{input:function(e){e.target.composing||(t.txtlastname=e.target.value)}}}),o&&i?a("span",{staticClass:"invalid-feedback",attrs:{name:"LastName"}},[t._v(t._s(n[0]))]):t._e()]}}],null,!0)})],1)]),a("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[a("div",{staticClass:"form-group"},[a("label",[t._v(t._s(t.$t("Email"))+":"),a("span",{staticClass:"text-danger"},[t._v("*")])]),a("Field",{attrs:{name:"Email",rules:{required:!0,email:!0},label:"Email"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.errors,o=e.touched,i=e.invalid;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.txtemailid,expression:"txtemailid"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",id:"Emailid",name:"Email"},domProps:{value:t.txtemailid},on:{input:function(e){e.target.composing||(t.txtemailid=e.target.value)}}}),a("span",{staticClass:"invalid-feedback",attrs:{name:"Email"}},[t._v(t._s(n[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[a("div",{staticClass:"form-group"},[a("label",[t._v(t._s(t.$t("Mobile"))+": ")]),a("vue-tel-input",{attrs:{id:"txtmobile",mode:"international",name:"txtmobile"},on:{input:t.onInputMobilePhone},model:{value:t.txtmobile,callback:function(e){t.txtmobile=e},expression:"txtmobile"}}),a("span",{staticClass:"invalid-feedback d-block",attrs:{name:t.txtmobile}},[t._v(t._s(o[0]))]),t.phoneError?a("span",{staticClass:"invalid-feedback d-block"},[t._v("Enter valid number.")]):t._e()],1)])]):t._e(),a("div",{staticClass:"row flex-row-reverse mt-2"},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success formbtn",class:{disabled:!1},attrs:{href:"javascript:;",title:"Save"},on:{click:function(e){return t.SubmitData(n,o)}}},[a("em",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save"))+" ")]),t._v("Â  "),a("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:void(0)",title:"Cancel"},on:{click:t.onCancel}},[a("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")])]),a("div",{staticClass:"col-lg-6"},[a("div",{staticClass:"py-2"},[a("small",{staticClass:"text-danger"},[t._v(t._s(t.$t("MandatoryString")))])])])]),t.showaddindustryModal?a("modaladdindustry",{on:{close:function(e){t.showaddindustryModal=!1},updatedata:t.UpdateSelectJson}}):t._e()]}}])})],1)],1)])},o=[],i=a("53ca"),l=a("c7eb"),c=a("1da1"),s=(a("b0c0"),a("99af"),a("4de4"),a("d3b7"),a("498a"),a("a15b"),a("3ca3"),a("ddb0"),a("9861"),a("ac1f"),a("841c"),a("c740"),a("e9c4"),a("1276"),a("9769")),r=a("5ba0"),u=a("4dad"),d={components:{DynamicForm:r["a"],modaladdindustry:u["a"]},data:function(){return{isLoading:!1,value:"",LeadData:null,LeadOwner:null,GroupBy:[],Channel:null,IndustryType:null,Status:null,ApiURL:"moduleName=CRM&subModuleCode=CRM_ACCOUNTS&langCode=en",options:null,selected:!1,selectoptions:[],submited:!1,IscheckContact:!1,showaddindustryModal:!1,IndustryItemObject:null,cityItemObject:null,showaddcityModal:!1,txtfirstname:"",txtlastname:"",txtemailid:"",txtmobile:"",accountID:0,divchkhide:!1,CountryData:null,phoneList:[],name:null,Id:null,dateformat:null,phoneError:!1,AccountCode:""}},created:function(){this.name=this.GetUserInfo.Name,this.Id=this.GetUserInfo.ID,this.dateformat=this.GetUserInfo.DateFormat;var t=this;t.accountID=this.$route.query.id?this.$route.query.id:0,t.AccountCode=this.$route.query.AccountCode?this.$route.query.AccountCode:"";var e=this.$route.query.id?this.$route.query.id:0;e=""==e?0:e,0==e&&(t.divchkhide=!0),t.FetchData()},methods:{onInputMobilePhone:function(t,e,a){t&&(e&&(null===e||void 0===e?void 0:e.formatted.length)>0&&(null===e||void 0===e||!e.valid||void 0==(null===e||void 0===e?void 0:e.valid))?this.phoneError=!0:null!==e&&void 0!==e&&e.formatted&&null!==e&&void 0!==e&&e.valid&&(t=e.formatted,this.fieldInfo.value=e.formatted,this.phoneError=!1))},onCancel:function(){this.$router.push({name:"CRMAccounts"})},IsPaste:function(t,e){var a=["commission_percentage","txtmobile","annual_revenue"];a.indexOf(e)>-1&&(IsNumeric(t.clipboardData.getData("text"))||t.preventDefault())},isNumber:function(t,e){var a=["commission_percentage","txtmobile"];if(a.indexOf(e)>-1){var n=t.which?t.which:t.keyCode;if(!(n>31&&(n<48||n>57)&&46!==n||t.currentTarget.value.length>15))return!0;t.preventDefault()}},ChkContactbox:function(t){var e=this;if(e.IscheckContact=$(t.target).prop("checked"),e.IscheckContact||(e.txtfirstname="",e.txtlastname="",e.txtemailid="",e.txtmobile=""),e.IscheckContact){var a=e.$route.query.id?e.$route.query.id:0;a=""==a?0:a}},onKeyDown1:function(){ajaxRequestComplete=!0},FillDropdown:function(){var t=Object(c["a"])(Object(l["a"])().mark((function t(e,a){var n,o,i,c,r,u;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this,n.Loading=!0,o="",i="",c="","status_id"==e.name){t.next=15;break}if(c="account_country"==e.name?"ACCOUNT_STATE":"",r=e.name,o=e.value,""==o){t.next=13;break}return u="id=&moduleName=CRM&type=".concat(c,"&refId=").concat(o),t.next=13,s["a"].getDDLData(u+"&search="+escape(i)).then((function(t){n.Loading=!1;var e=[];null!=t.data&&(e=t.data.DATA),$.each(n.GroupBy,(function(t,a){$.each(a.Data,(function(t,a){("account_state"==a.name&&"account_country"==r||"account_city"==a.name&&"account_state"==r)&&(a.select_options=e)}))}))}));case 13:t.next=16;break;case 15:"status_id"==e.name&&$.each(this.GroupBy,(function(t,e){$.each(e.Data,(function(t,e){"account_state"!=e.name&&"account_city"!=e.name||(e.is_required=!1)}))}));case 16:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),openaddIndustrypopup:function(t){this.IndustryItemObject=t,this.showaddindustryModal=!0},openaddcitypopup:function(t){this.cityItemObject=t,this.showaddcityModal=!0},GetValidation:function(t){var e={};return t.is_required&&(e["required"]=!0),t.length>0&&(e["max"]=t.length),"email"==t.validation_type&&(e["email"]=!0),"date"==t.dt_code&&(e["date_format"]=String(Globalize.culture().calendar.patterns.d).toUpperCase()),"decimal"==t.dt_code&&(e["decimal"]=2),"int"!=t.dt_code&&"bigint"!=t.dt_code||(e["numeric"]=!0),"url"==t.dt_code&&(e["url"]="require_protocol"),"commission_percentage"==t.name&&(e["min_value"]=0,e["max_value"]=100,e["decimal"]=2),"account_zip_code"==t.name&&(e["numeric"]=!0,e["min"]=5,e["max"]=15),"employees"==t.name&&(e["numeric"]=!0),"account_city"==t.name&&(e["regex"]=/^[a-zA-Z ]*$/),"website"==t.name&&(e["regex"]=/^(https?: \/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})*$/),e},SubmitData:function(t){var e=this,a="",n="",o="",l="",c="",r="";e.$refs.form.validate().then((function(t){if(e.vSelectValidate=!0,t){e.isLoading=!0;var u=e.LeadData,d=[],m=[],v=[],p=0;$.each(u,(function(t,s){var u={field_name:s.name,required:s.is_required,length:s.length,type:s.validation_type};if("account_name"==s.name&&(r=s.value),"account_owner"==s.name&&s.value,"company_name"==s.name&&(a=s.value),"account_address"==s.name&&(n=s.value),"account_address2"==s.name&&(o=s.value),"account_city"==s.name&&(l=s.value),"account_zip_code"==s.name&&(c=s.value),"phone"==s.name){var f=e.phoneList.filter((function(t){return t.field_id==s.custom_field_id}));f.length>0&&(s.value=f[0].value,!f[0].isValid&&$.trim(s.value).length>0&&($("#spanPhone").show(),p++))}var _="account_id"==s.name?e.accountID:s.value;if("date"==s.dt_code&&(_=s.value),"checkbox"==s.dt_code){var h=s.select_value.filter((function(t){return null!=t&&""!=t}));_=h.join(",")}if("select"==s.dt_code)try{_="object"===Object(i["a"])(_)&&null!==_?_.value:_}catch(C){}var y={field_name:s.name,field_value:_,custom_field_id:s.custom_field_id};d.push(y),m.push(u),v.push(w)}));var f=new URLSearchParams(window.location.search),_=f.get("id")||0;f.get("AccountCode");null==_&&(_=0);var h=$('select[name="account_state"] option:selected').text(),y=a+" "+n+" "+o+" "+l+" "+("Select"==h?"--":h)+" "+c,C=e.txtfirstname+" "+e.txtlastname+" "+n+" "+o+" "+l+" "+("Select"==h?"--":h)+" "+c;if(0==_&&""==r){var g=""!=a?$.trim(y):$.trim(C),b=d[d.findIndex((function(t){return"account_name"==t.field_name}))];b.field_value=g}if(e.IscheckContact){var x=e.phoneList.filter((function(t){return"txtmobile"==t.field_id}));x.length>0&&(e.txtmobile=x[0].value,x[0].isValid||($("#spantxtmobile").show(),p++))}if(p>0)return!1;var w={first_name:e.txtfirstname,last_name:e.txtlastname,email_id:e.txtemailid,mobile_number:e.txtmobile},D=null;D=e.IscheckContact?{data:d,validation:m,accountcontact:w}:{data:d,validation:m};var A=JSON.stringify(D);s["a"].SaveAccountInfo(A).then((function(t){e.isLoading=!1,"1"==t.data[0].Code?(e.accountID>0?e.ShowAlert(e.$t("UpdatedSuccess",[e.$t("Account")]),"success",!0,e.$t("Alert")):e.ShowAlert(e.$t("AddedSuccess",[e.$t("Account")]),"success",!0,e.$t("Alert")),e.$router.push({name:"CRMAccounts"})):"2"==t.data[0].Code?e.ShowAlert(e.$t("Account name already exist"),"warning",!0,e.$t("Alert")):e.ShowAlert(e.$t("AddedError",[e.$t("Account")]),"failure",!0,e.$t("Alert"))}))}}))},UpdateSelectJson:function(t,e){$.each(this.GroupBy,(function(a,n){$.each(n.Data,(function(a,n){n.name==t&&(n.select_options=e)}))}))},FetchData:function(){var t=this;t.isLoading=!0;var e="0"==t.accountID?"":t.accountID,a=[{id:t.$route.query.AccountId?t.$route.query.AccountId:"",name:t.AccountCode}],n=encodeURIComponent(JSON.stringify(a));s["a"].getFormLayout(t.ApiURL+"&id="+e+"&otherData="+n).then((function(a){if(t.isLoading=!1,t.LeadData=a.data.data,null!=t.LeadData&&t.LeadData.length>0){var n=t.LeadData[0].group_id;$.each(t.LeadData,$.proxy((function(e,a){n=a.group_id;var o=new URLSearchParams(window.location.search),i=o.get("id")||0,l=o.get("AccountCode")||"";if("industry_name"==a.name&&(a.isPlusIcon=!0),null==i&&(i=0),"date"==a.dt_code&&(a.value=""==a.value?null:a.value),0==i&&""!=l&&"account_name"==a.name&&(a.is_required=!0),"checkbox"==a.dt_code&&(a.select_value=a.value.split(",")),"account_type"==a.name&&0==t.accountID&&(a.value=t.$route.query.AccountId?t.$route.query.AccountId:""),"account_owner"==a.name&&(""==a.value?(a.select_value=t.name,a.value={name:a.select_value,value:t.Id,first_value:null,second_value:null},a.select_options=[{name:a.select_value,value:t.Id,first_value:null,second_value:null}]):a.select_options=t.MakeNormalArray(a.select_options)),"status_id"==a.name&&a.value,"account_state"!=a.name&&"account_city"!=a.name||(a.is_required=!1,a.select_options=null),"account_country"==a.name&&(t.CountryData=a),"account_country"==a.name&&t.accountID>0)if(""==a.value){var c=JSON.parse(t.CountryData.select_options);$.each(c,(function(e,a){"United States"==a.name&&(t.CountryData.value=a.value)})),t.FillDropdown(t.CountryData)}else t.FillDropdown(a,"Edit");"account_state"==a.name&&t.accountID>0&&t.FillDropdown(a,"Edit"),"phone"==a.name&&a.value;var s=$.grep(t.GroupBy,(function(t,e){return t.group_id==n}));if(0==s.length){var r=$.grep(t.LeadData,(function(t,e){return t.group_id==n}));if(t.accountID>0&&$.each(r,(function(e,a){"custom"==a.dropdown_type&&"Lookup"==a.picklist_options?(a.select_options=t.MakeNormalArray(a.select_options),a.select_value=a.select_options,null!=a.select_options&&a.select_options.length>0&&(a.value=a.select_options[0])):"decimal"==a.dt_code&&"YES"==a.form_field_visibility&&a.value>0?a.value=parseFloat(a.value,10):"date"==a.dt_code&&(a.value=a.value)})),r.length>0){var u={group_id:n,group_name:r[0].group_name,group_display_name:r[0].group_display_name,Data:r};t.GroupBy.push(u)}}}),t)),setTimeout((function(){t.CheckBoxBootstrap()}),100),setTimeout((function(){var a=JSON.parse(t.CountryData.select_options);""==e&&($.each(a,(function(e,a){"United States"==a.name&&(t.CountryData.value=a.value)})),t.FillDropdown(t.CountryData))}),300)}}))},onSearch:function(t,e,a){this.searchSelectData(t,this,e,a)},searchSelectData:function(t,e,a,n){this.ShowSearchData(t,e,a,n)},ShowSearchData:function(t,e,a,n){"undefined"==typeof n&&(n=0);var o="id=&moduleName=CRM&type="+a.field_code;"fill"!=a.dependent_type&&(o+="&refId="+n),s["a"].getDDLData(o+"&search="+escape(t)).then((function(t){var e=[];return t.data,""!=t.data&&(e=t.data),a.select_options=e.DATA,a.select_options}))},setSelectedValue:function(t,e){var a=this;try{Array.isArray(e)?t.value=e[0]:("account_owner"==t.name?a.ShowSearchData("",a,t,""):t.has_dependent>0&&$.each(a.GroupBy,$.proxy((function(n,o){$.each(o.Data,(function(n,o){o.parent_id==t.custom_field_id&&"fill"==o.dependent_type&&a.ShowSearchData("",a,o,e.value)}))}),this)),t.value=e)}catch(n){}}}},m=d,v=a("2877"),p=Object(v["a"])(m,n,o,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=CRMManageAccount.js.map