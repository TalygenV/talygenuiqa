{"version":3,"sources":["webpack:///./src/views/CRM/Deal/Manage.vue?0ccb","webpack:///src/views/CRM/Deal/Manage.vue","webpack:///./src/views/CRM/Deal/Manage.vue?2b22","webpack:///./src/views/CRM/Deal/Manage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","isLoading","staticClass","_m","ref","scopedSlots","_u","key","fn","valid","errors","GroupBy","GetUserInfo","DateFormat","on","openaddIndustrypopup","openaddRoleTitlepopup","openaddLeadSourcepopup","onchangechannel","onSearch","setSelectedValue","onBlur","$event","onSubmit","_v","onCancel","_s","$t","showaddindustryModal","UpdateSelectJson","_e","showaddroletitleModal","showaddleadsourceModal","staticRenderFns","components","DynamicForm","modaladdindustry","modaladdroletitle","modaladdleadsource","data","value","LeadData","dealId","CountryData","IndustryItemObject","RoleTitleItemObject","LeadSourceItemObject","clientData","cutomerId","isAccountSelected","phoneList","submited","userid","companyId","username","dateFormat","mounted","created","methods","FetchData","vm","DataService","groupId","item","Compphone","Phones","homephone","businessphone","setTimeout","name","first_value","second_value","$","fieldItem","group_id","group_name","group_display_name","Data","child","child1","frmFields","MakeNormalArray","FillDropdown","self","refId","typeCode","element","action","itemname","params","json","searchSelectData","ShowSearchData","search","objItem","selctedValue","url","then","val","group","field_name","required","length","type","fieldValue","field_value","custom_field_id","validation","console","getclientAssociatedWithAccount","sourceId","moduleName","subModuleCode","accountName","contactIds","accountId","user_id","first_name","last_name","email_id","account_id","component"],"mappings":"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AAAC,mBACAR,mBAAAM,oBAAA7B,eAAA8B,iBAAAC,qBAGAR,sDAGA,sCACA,wBAEA,gBACA,uCACA,wBAmBA,GAjBA,YACAS,wBACA,yDACAC,qDACAA,gCACA,oDACAA,8BAGA,gEACAA,0CAEA,oBACAA,oBAIA,YACA,OACAC,WACAC,2BACAC,2CACAC,QAEAjB,uBAIA,WACAQ,uBACA,gEACA,6DACAI,0BACAA,4BACA,wBACAM,YACA,wBACAA,gBAGA,eACAN,0BACAA,0BAGAA,0BACAA,wBACAA,gCACAA,6BACA,wBACAO,YACA,wBACAA,qBAIA,KAGAX,uBACAI,wBACAA,4BACA,KAEA,YACA,SACAZ,gCACA,+CACAoB,6BAUAC,4BACA,KACA,IACA,qBAEA,SACA,cAIAzC,MAGA0C,wBAAA,4JAEAC,EAAA,KACAA,aACAC,EAAA,GACAC,EAAA,GACA,wBACAA,kBACA,SACAb,gCACAA,6BACA,yHACAc,sBACAA,mBAMA,uBACAD,yBACAE,aAEAC,EAAAzB,OACAqB,UACAA,MAzBA,wBA0BAK,EA1BA,yBA0BAN,2BA1BA,iBA0BAE,EA1BA,kBA0BAD,GA1BA,UA2BAvB,uCACAsB,aACA,SACA,eACAO,eAEAlB,gCACAA,6BACA,yCAGA,qCAFAc,mBAKA,wCACAA,0BACA,yCACAA,gCAGAvB,YA/CA,yGAAAmB,GAoDAhE,8BACA,SACA,KACA,OACA,6BACA,gEACA,6DACAsD,0BACAA,wBACAA,wBACA,wBACAM,YACA,wBACAA,gBAGA,eACAN,wBACAA,0BACAA,wBACA,wBACAM,iBAIAN,wBACA,wBACAM,YACA,wBACAA,eAEAN,yBACAA,2BAEA,gEACA,+FACAX,uCACA,SACA,eACA6B,eAEAlB,gCACAA,iCACA,wBAEAc,kCAMA,yBAGA,GAFAD,qBACAD,UACA,OACA,8FACAvB,uCACA,SACA,eACA6B,eAEAlB,gCACAA,6BACA,yBAEAc,mCAQA,4BACAD,UACAD,UACA,QAEA,kGACAvB,uCACA,SACA,eACA6B,eAEAlB,gCACAA,6BACA,uBAEAc,+BAWAnE,uBACA,GACA,iCAGAwE,iCACA,0CAEAC,eA3TA,SA2TAC,EAAAjC,EAAAkC,EAAAC,GACA,wBACAA,KAEA,4EACA,2BACAC,gBAEAnC,0CACAoC,MAAA,YACA,SASA,OARA,OAGA,aACAP,UAGAI,wBACA,qBAIA1E,iBAlVA,SAkVA2C,EAAAmC,GACA,WAEA,IACA,iBACAnC,sEAGA,oBACAH,+BACAuC,4BACA,0DACAvC,uCAMAG,WAEA,sBACAH,0CAIA,YAIArC,uBACA,WAiBA,6CACA,MACAqC,eACA,iBACA,KACA,KACA,iDACA,qCACA,uBAEAY,wBACA,OACA4B,kBACAC,uBACAC,gBACAC,wBAEA,qEAKA,GAJAC,8BACA,oBACAA,WAEA,uBACA,yCACA,yBAEAA,cAEA,uBACA,IACAA,mDACA,UAGA,uBACAA,YAEA,wBACAA,YAEA,uBACAA,eAGA,OACAJ,kBACAK,cACAC,mCAEAnE,UACAoE,aAEA,OACApE,OACAoE,aACA5D,cAEA,oBACA6D,eACA/C,yBACA,YACAD,eACA,qBACA,WACAA,8EAGAA,4EAEAA,cAGAA,0EAEAA,sBAKAnC,oBACA,mBAAA4C,kBAEAxC,+BACA2C,mCACAA,6BACA,YACAc,2BAKAvE,iCACA,0BACA,8BAEAC,kCACA,2BACA,+BAEAC,mCACA,4BACA,gCAEAI,OAxeA,SAweA0C,GACA,IACA,2BACAA,8CACA,+CAEA,YAIA8C,2CAAA,WACA,GACAC,YACAC,iBACAC,0BACAC,eACAC,cACAC,aAEA,mBACA,wBACAtD,wCACA,gCACA,yCACA,uBACA,OACAuD,UACAC,cACAC,aACAC,YACAC,cAEA,qBACA,uBAGApD,yCACAA,gEC7jB8W,I,YCO1WqD,EAAY,eACd,EACAhI,EACAwC,GACA,EACA,KACA,KACA,MAIa,aAAAwF,E","file":"js/CRMManageDeal.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('loader',{attrs:{\"is-visible\":_vm.isLoading}}),_c('section',{staticClass:\"main-content\"},[_c('div',{attrs:{\"id\":\"divMaindealData\"}},[_vm._m(0),_c('div',{staticClass:\"border p-3\"},[_c('Form',{ref:\"form\",scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar valid = ref.valid;\nvar errors = ref.errors;\nreturn [_c('DynamicForm',{attrs:{\"schema\":_vm.GroupBy,\"dateformat\":_vm.GetUserInfo.DateFormat},on:{\"openaddIndustrypopup\":_vm.openaddIndustrypopup,\"openaddRoleTitlepopup\":_vm.openaddRoleTitlepopup,\"openaddLeadSourcepopup\":_vm.openaddLeadSourcepopup,\"onchangechannel\":_vm.onchangechannel,\"onSearchDDL\":_vm.onSearch,\"setSelectedValue\":_vm.setSelectedValue,\"onBlur\":_vm.onBlur}}),_c('div',{staticClass:\"row flex-row-reverse mt-2\"},[_c('div',{staticClass:\"col-lg-6 text-right\"},[_c('a',{staticClass:\"btn btn-success AddDealDetail_a\",attrs:{\"href\":\"javascript:;\",\"title\":\"Save\"},on:{\"click\":function($event){return _vm.onSubmit(valid,errors)}}},[_c('em',{staticClass:\"fa fa-save pr-2\"}),_vm._v(\"Save \")]),_vm._v(\"Â  \"),_c('a',{staticClass:\"btn btn-danger\",attrs:{\"href\":\"javascript:void(0)\",\"title\":\"Cancel\"},on:{\"click\":_vm.onCancel}},[_c('em',{staticClass:\"fa fa-close pr-2\"}),_vm._v(\"Cancel \")])]),_c('div',{staticClass:\"col-lg-6\"},[_c('div',{staticClass:\"py-2\"},[_c('small',{staticClass:\"text-danger\"},[_vm._v(_vm._s(_vm.$t('MandatoryString')))])])])]),(_vm.showaddindustryModal)?_c('modaladdindustry',{on:{\"close\":function($event){_vm.showaddindustryModal=false},\"updatedata\":_vm.UpdateSelectJson}}):_vm._e(),(_vm.showaddroletitleModal)?_c('modaladdroletitle',{on:{\"close\":function($event){_vm.showaddroletitleModal=false},\"updatedata\":_vm.UpdateSelectJson}}):_vm._e(),(_vm.showaddleadsourceModal)?_c('modaladdleadsource',{attrs:{\"callFrom\":\"deal\"},on:{\"close\":function($event){_vm.showaddleadsourceModal=false},\"updatedata\":_vm.UpdateSelectJson}}):_vm._e()]}}])})],1)])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-12 padding-t_8\"},[_c('div',{staticClass:\"theme-primary partition-full\"},[_c('span',{staticClass:\"p-name text-white\"},[_vm._v(\"Manage deal\")]),_c('span',{staticClass:\"float-right\"})])])])}]\n\nexport { render, staticRenderFns }","\r\n<script>\r\nimport DataService from \"../../../services/DataService\";\r\nimport DynamicForm from \"../../../components/Common/DynamicForm.vue\";\r\nimport modaladdindustry from '../../../components/Common/Modal/modaladdindustry.vue'\r\nimport modaladdroletitle from '../../../components/Common/Modal/modaladdroletitle.vue'\r\nimport modaladdleadsource from '../../../components/Common/Modal/modaladdleadsource.vue'\r\nexport default {\r\n    components: {\r\n        DynamicForm,\r\n        modaladdindustry,\r\n        modaladdroletitle,\r\n        modaladdleadsource\r\n    },\r\n    data() {\r\n        return {\r\n            isLoading:false,\r\n            value: \"\",\r\n            LeadData: null,\r\n            GroupBy: [],\r\n            dealId: this.$route.params.id,\r\n            CountryData: null,\r\n            showaddindustryModal: false,\r\n            IndustryItemObject: null,\r\n            RoleTitleItemObject: null,\r\n            showaddroletitleModal: false,\r\n            showaddleadsourceModal: false,\r\n            LeadSourceItemObject: null,\r\n            clientData: [],\r\n            cutomerId: 0,\r\n            isAccountSelected: false,\r\n            phoneList: [],\r\n            submited: false,\r\n            userid: null,\r\n        companyId: null,\r\n        username: null,\r\n        dateFormat:null\r\n        };\r\n    },\r\n    mounted: function () { },\r\n    created: function () {\r\n        this.userid = this.GetUserInfo.ID;\r\n    this.companyId = this.GetUserInfo.CompanyId;\r\n    this.username = this.GetUserInfo.Name;\r\n    this.dateFormat=this.GetUserInfo.DateFormat;\r\n        this.FetchData();\r\n\r\n    },\r\n    methods: {\r\n        FetchData: function () {\r\n            var vm = this;\r\n            vm.isLoading=true;\r\n            const params = `id=${vm.$route.params.id}&moduleName=CRM&subModuleCode=CRM_DEALS&langCode=en`;\r\n            DataService.getFormLayout(params).then(function (response) {\r\n                vm.isLoading=false;\r\n                if (response.data != \"\" && response.data != null) {\r\n                    var Compphone = '';\r\n                    var homephone = '';\r\n                    var businessphone = '';\r\n                    var Phones = [];\r\n                    vm.LeadData = response.data.data;\r\n                    if (vm.LeadData != null && vm.LeadData.length > 0) {\r\n                        var groupId = vm.LeadData[0].group_id;\r\n                        vm.LeadData.forEach(item => {\r\n                            groupId = item.group_id;\r\n                            if (item.name == 'industry_type_id' || item.name == \"lead_source_id\" || item.name == \"role_title_id\") {\r\n                                item.isPlusIcon = true;\r\n                            }\r\n                            if (item.name == 'customer_id') {\r\n                                vm.cutomerId = item.value == '' ? 0 : item.value;\r\n                            }\r\n                            if (item.dt_code == 'checkbox') {\r\n                                item.select_value = item.value.split(',');\r\n                            }\r\n                            if (item.name == \"mobile_phone\") {\r\n                                Compphone = item.value;\r\n                                if (Compphone == '' || Compphone == null || Compphone.indexOf(\"+\") == -1)\r\n                                    Phones.push(item.name);\r\n                            }\r\n                            if (item.name == \"home_phone\") {\r\n                                homephone = item.value;\r\n                                if (homephone == '' || homephone == null || homephone.indexOf(\"+\") == -1)\r\n                                    Phones.push(item.name);\r\n                            }\r\n                            if (item.name == \"business_phone\") {\r\n                                businessphone = item.value;\r\n                                if (businessphone == '' || businessphone == null || businessphone.indexOf(\"+\") == -1)\r\n                                    Phones.push(item.name);\r\n                            }\r\n                            if (item.name == 'lead_source_id' && vm.dealId > 0) {\r\n                                if (item.value != '') {\r\n                                    setTimeout(function () {\r\n                                        vm.onchangechannel(item, null);\r\n                                    }, 500)\r\n                                }\r\n                            }\r\n                            if (item.name == 'deal_owner_id') {\r\n                                    if (item.value == '') {\r\n                                        item.select_value = vm.username;\r\n                                        item.value ={name: item.select_value, value:  vm.userid, first_value: null, second_value: null};\r\n                                        item.select_options=[{name: item.select_value, value:  vm.userid, first_value: null, second_value: null}]\r\n                                    }\r\n                                    else {\r\n                                       item.select_options =vm.MakeNormalArray(item.select_options);\r\n                                    }\r\n                                };\r\n                            var chkGroup = $.grep(vm.GroupBy, function (element, index) {\r\n                                return element.group_id == groupId;\r\n                            });\r\n                            if (chkGroup.length == 0) {\r\n                                var returnedData = $.grep(vm.LeadData, function (element, index) {\r\n                                    return element.group_id == groupId;\r\n                                });\r\n                                if (vm.dealId > 0) {\r\n                                    $.each(returnedData, function (filedIndex, fieldItem) {                                       \r\n                                        if (fieldItem.dropdown_type == \"custom\" && fieldItem.picklist_options == \"Lookup\") {\r\n                                            fieldItem.select_options = vm.MakeNormalArray(fieldItem.select_options);\r\n                                            fieldItem.select_value = fieldItem.select_options;\r\n                                            if (fieldItem.select_options != null && fieldItem.select_options.length > 0) {\r\n                                                fieldItem.value = fieldItem.select_options[0];\r\n                                            }\r\n                                        }\r\n                                        else if (fieldItem.dt_code == \"decimal\" && fieldItem.form_field_visibility == \"YES\" && fieldItem.value > 0) {\r\n                                            fieldItem.value = parseFloat(fieldItem.value, 10).toFixed(2);\r\n                                        }\r\n                                        else if (fieldItem.dt_code == \"date\") {\r\n                                            fieldItem.value = fieldItem.value;                                                                               \r\n                                        }\r\n                                    });\r\n                                }\r\n                                if (returnedData.length > 0) {\r\n                                    var objGroup = {\r\n                                        group_id: groupId,\r\n                                        group_name: returnedData[0].group_name,\r\n                                        group_display_name: returnedData[0].group_display_name,\r\n                                        Data: returnedData\r\n                                    };\r\n                                    vm.GroupBy.push(objGroup);\r\n                                }\r\n                            }\r\n                        })\r\n                        if (vm.dealId > 0) {\r\n                            setTimeout(function () {\r\n                                var selectedName = $('select[name=\"lead_source_id\"] option:selected').text();\r\n                                if (selectedName == \"Partner\" || selectedName == \"Consultant\" || selectedName == \"Provider\" || selectedName == \"Customer\") {\r\n                                    $(\".campaignname\").hide();\r\n                                    $.each(items, function (indx, child) {\r\n                                        if (child.name == \"referred_by\")\r\n                                            child.value = \"\";\r\n                                        if (child.name == \"campaign_id\")\r\n                                            child.value = \"\";\r\n                                    });\r\n                                }\r\n                                else if (selectedName == \"Campaign\") {\r\n                                    $(\".campaignname\").show();\r\n                                    $(\".referredby\").hide();\r\n                                }\r\n                                else {\r\n                                    $(\".campaignname\").hide();\r\n                                    $(\".referredby\").hide();\r\n                                    $.each(vm.GroupBy, function (indx, child) {\r\n                                        $.each(child.Data, function (ind, child1) {\r\n                                            if (child1.name == \"referred_by\")\r\n                                                child1.value = \"\";\r\n                                            if (child1.name == \"campaign_id\")\r\n                                                child1.value = \"\";\r\n                                        });\r\n                                    });\r\n                                }\r\n                            }, 500);\r\n                        }\r\n                        else {\r\n                            setTimeout(function () {\r\n                                $(\".referredby\").hide();\r\n                                $(\".campaignname\").hide();\r\n                            }, 500);\r\n                        }\r\n                        if(vm.dealId>0){\r\n                            var frmFields={}\r\n                        vm.LeadData.forEach((item)=>{\r\n                             if(item.astype!='' && item.form_field_visibility == 'YES'){                               \r\n                             frmFields[item.name]=item.value;\r\n                             }\r\n                         })                         \r\n                        //  vm.$refs.form.resetForm({values:frmFields});\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        },\r\n      \r\n        MakeNormalArray: function (value) {\r\n            if (value) {\r\n                try {\r\n                    return JSON.parse(value);\r\n                }\r\n                catch (ex) {\r\n                    return value;\r\n                }\r\n            }\r\n            else {\r\n                value = [];\r\n            }\r\n        },\r\n        FillDropdown: async function (item, action) {\r\n\r\n            var self = this;\r\n            self.Loading= true;\r\n            var refId = '';\r\n            var typeCode = '';\r\n            if (item.name == 'deal_country') {\r\n                typeCode = 'ACCOUNT_STATE';\r\n                if (action == null) {\r\n                    $.each(self.GroupBy, function (index, item) {\r\n                        $.each(item.Data, function (index, element) {\r\n                            if (element.name == ' deal_city' || element.name == \"deal_state\" || element.name == 'deal_zipcode' || element.name == 'deal_address1' || element.name == '  deal_address2') {\r\n                                element.select_options = null;\r\n                                element.value = \"\";\r\n                            }\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n            else if (item.name == 'account_id') {\r\n                typeCode = \"COMMISSION_AGREEMENT\";\r\n                action = 'Account';\r\n            }\r\n            var itemname = item.name;\r\n            refId = item.value;\r\n            if (refId != '') {\r\n                var params = `id=&moduleName=${self.$route.params.moduleName}&type=${typeCode}&refId=${refId}`;\r\n               await DataService.getDDLData(params).then(response => {\r\n                self.Loading= false;\r\n                    var json = [];\r\n                    if (response.data != null) {\r\n                        json = response.data.DATA;\r\n                    }\r\n                    $.each(self.GroupBy, function (index, item) {\r\n                        $.each(item.Data, function (index, element) {\r\n                            if (element.name == 'deal_state' && itemname == 'deal_country') {\r\n                                element.select_options = json;\r\n                            }\r\n                            else if (element.name == 'deal_city' && itemname == 'deal_state') {\r\n                                element.select_options = json;\r\n                            }\r\n                            else if (element.name == 'commission_type' && action == 'Account')\r\n                                element.value = json[0].second_value;\r\n                            else if (element.name == 'agreement_type' && action == 'Account')\r\n                                element.value = json[0].first_value;\r\n                        });\r\n                    });\r\n                    item.name = itemname;\r\n                     \r\n                });\r\n            }\r\n        },\r\n        onchangechannel: function (item, items) {\r\n            var refId = '';\r\n            var typeCode = '';\r\n            var vm = this;\r\n            if (item.name == \"lead_source_id\") {\r\n                var selectedName = $('select[name=\"lead_source_id\"] option:selected').text();\r\n                if (selectedName == \"Partner\" || selectedName == \"Consultant\" || selectedName == \"Customer\" || selectedName == \"Provider\") {\r\n                    $(\".campaignname\").hide();\r\n                    $(\".referredby\").show();\r\n                    $.each(items, function (indx, child) {\r\n                        if (child.name == \"referred_by\")\r\n                            child.value = \"\";\r\n                        if (child.name == \"campaign_id\")\r\n                            child.value = \"\";\r\n                    });\r\n                }\r\n                else if (selectedName == \"Campaign\") {\r\n                    $(\".referredby\").hide();\r\n                    $(\".campaignname\").show();\r\n                    $.each(items, function (indx, child) {\r\n                        if (child.name == \"referred_by\")\r\n                            child.value = \"\";\r\n                    });\r\n                }\r\n                else {\r\n                    $.each(items, function (indx, child) {\r\n                        if (child.name == \"referred_by\")\r\n                            child.value = \"\";\r\n                        if (child.name == \"campaign_id\")\r\n                            child.value = \"\";\r\n                    });\r\n                    $(\".referred_by\").hide();\r\n                    $(\".campaignname\").hide();\r\n                }\r\n                var typename = $('select[name=\"lead_source_id\"] option:selected').text();\r\n                var params = `id=&moduleName=${vm.$route.params.moduleName}&type=ACCOUNTS_LIST&search=${typename}`;\r\n                DataService.getDDLData(params).then(function (response) {\r\n                    var json = [];\r\n                    if (response.data != null) {\r\n                        json = response.data.DATA;\r\n                    }\r\n                    $.each(vm.GroupBy, function (index, item) {\r\n                        $.each(item.LeadData, function (index, element) {\r\n                            if (element.name == 'referred_by') {\r\n\r\n                                element.select_options = json;\r\n                            }\r\n                        });\r\n                    });\r\n                })\r\n            }\r\n            else if (item.name == \"account_id\") {\r\n                typeCode = 'ACCOUNT_CONTACTS';\r\n                refId = item.value;\r\n                if (refId != '') {\r\n                    var params = `id=&moduleName=${vm.$route.params.moduleName}&type=${typeCode}&refId=${refId}`;\r\n                    DataService.getDDLData(params).then(function (response) {\r\n                        var json = [];\r\n                        if (response.data != null) {\r\n                            json = response.data.DATA;\r\n                        }\r\n                        $.each(vm.GroupBy, function (index, item) {\r\n                            $.each(item.Data, function (index, element) {\r\n                                if (element.name == 'contact_name') {\r\n\r\n                                    element.select_options = json;\r\n                                }\r\n                            });\r\n                        });\r\n                    })\r\n                }\r\n\r\n            }\r\n            else if (item.name == 'deal_country') {\r\n                typeCode = 'STATE';\r\n                refId = item.value;\r\n                if (refId != '') {\r\n                     \r\n                    var param = `id=&moduleName=${vm.$route.params.moduleName}&type=${typeCode}&refId=${refId}`;\r\n                    DataService.getDDLData(param).then(response => {\r\n                        var json = [];\r\n                        if (response.data != null) {\r\n                            json = response.data.DATA;\r\n                        }\r\n                        $.each(vm.GroupBy, function (index, item) {\r\n                            $.each(item.Data, function (index, element) {\r\n                                if (element.name == 'deal_state') {\r\n\r\n                                    element.select_options = json;\r\n                                }\r\n                            });\r\n                        });\r\n                         \r\n                    });\r\n                }\r\n            }\r\n\r\n             \r\n        },\r\n        onSearch: function onSearch(search, objItem) {\r\n            if(search)     {\r\n            this.searchSelectData(search, this, objItem);\r\n            }\r\n        },\r\n        searchSelectData: function (search, vm, objItem) {\r\n            this.ShowSearchData(search, vm, objItem,objItem.value.value);\r\n        },\r\n        ShowSearchData(search, vm, objItem,selctedValue) {\r\n            if (typeof (selctedValue) == 'undefined') {\r\n                    selctedValue = 0;\r\n                }\r\n            var url = \"id=&moduleName=\"+this.$route.params.moduleName+\"&type=\"+objItem.field_code;\r\n            if (objItem.dependent_type == 'fill') {\r\n                    url += \"&refId=\" + selctedValue;\r\n                }\r\n                DataService.getDDLData(url + \"&search=\" + escape(search))\r\n                .then(response => {\r\n                    var json = [];\r\n                    if(response.data==''){\r\n                       \r\n                    }\r\n                    if (response.data != '') {\r\n                        json = response.data;\r\n                    }                    \r\n                   \r\n                    objItem.select_options = json.DATA;\r\n                        return objItem.select_options;\r\n                    \r\n                });\r\n        },\r\n        setSelectedValue(item, val) {\r\n                var vm = this;\r\n                // vm.$refs.form.setFieldTouched(item.name, false); \r\n                try {\r\n                    if (Array.isArray(val)) {\r\n                        item.value = (typeof val[0] === 'object' && val[0] !== null) ? val[0].value : val[0];\r\n                    }\r\n                    else {                     \r\n                        if (item.has_dependent >= 0) {\r\n                            vm.GroupBy.forEach((group)=>{                               \r\n                                group.Data.forEach((childItem)=>{\r\n                                    if (childItem.parent_id == item.custom_field_id && childItem.dependent_type == 'fill') {\r\n                                        vm.ShowSearchData('', vm, childItem, val.value);\r\n                                    }\r\n                                })\r\n                            })\r\n                            \r\n                        }\r\n                        item.value = val;\r\n                    }\r\n                    if (item.name == 'account_id') {\r\n                        vm.getclientAssociatedWithAccount(item.value);\r\n                        //vm.FillDropdown('ACCOUNT_CONTACTS', item.value);\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                }\r\n            },\r\n                        \r\n        onSubmit: function (valid,errors) {\r\n            var vm = this;\r\n            // this.LeadData.forEach((item) => {\r\n            //     if (item.astype != '' && item.form_field_visibility == 'YES') {\r\n            //         if (item.dt_code == \"select\" && item.value) {\r\n            //             try {\r\n            //                 values[item.name] = String((typeof item.value === 'object' && item.value !== null) ? item.value.value : item.value);\r\n            //                 //vm.$refs.form.setFieldTouched(item.name, false); \r\n            //             } catch (ex) { console.log('error while get dropdown parse data') }\r\n            //         }\r\n            //         if (item.dt_code == 'date' && item.value) {\r\n            //             values[item.name] =vm.$options.filters.formatDate(item.value);\r\n            //             //vm.$refs.form.setFieldTouched(item.name, false);\r\n            //         } else {\r\n            //            // vm.$refs.form.setFieldTouched(item.name, true);\r\n            //         }\r\n            //     } \r\n            // })\r\n            this.$refs.form.validate().then((result) => {               \r\n                if (result) {\r\n                    vm.isLoading=true;\r\n                    var fullJson = vm.LeadData;\r\n                    var data = [];\r\n                    var validation = [];\r\n                    var selectedRadioValue = $(\"input[name='radio_clients']:checked\").val();\r\n                    var selectedClient = $.grep(vm.clientData, function (element, index) {\r\n                        return element.user_id == selectedRadioValue;\r\n                    });\r\n                    $.each(fullJson, function (key, item) {\r\n                        var validationObject = {\r\n                            field_name: item.name,\r\n                            required: item.is_required,\r\n                            length: item.length,\r\n                            type: item.validation_type\r\n                        };\r\n                        var fieldValue = (item.name == \"deal_id\" ? vm.dealId : ((typeof item.value === \"undefined\") ? '' : item.value));\r\n                        fieldValue = typeof fieldValue === \"undefined\" ? '' : fieldValue;\r\n                        if (item.dt_code == \"date\") {\r\n                            fieldValue = item.value;\r\n                        }\r\n                        if (item.dt_code == \"checkbox\") {\r\n                            var filtered = item.select_value.filter(function (el) {\r\n                                return (el != null && el != \"\");\r\n                            });\r\n                            fieldValue = filtered.join(',');\r\n                        }\r\n                        if (item.dt_code == \"select\") {\r\n                            try {\r\n                                fieldValue = (typeof fieldValue === 'object' && fieldValue !== null) ? fieldValue.value : fieldValue\r\n                            } catch (ex) { }\r\n                        }                       \r\n\r\n                        if (item.name == 'created_by') {\r\n                            fieldValue = vm.userid;\r\n                        }\r\n                        if (item.name == 'modified_by') {\r\n                            fieldValue = vm.userid;\r\n                        }\r\n                        if (item.name == 'company_id') {\r\n                            fieldValue = vm.companyId;\r\n                        }\r\n                                           \r\n                        var dataObject = {\r\n                            field_name: item.name,\r\n                            field_value: fieldValue,\r\n                            custom_field_id: item.custom_field_id\r\n                        };\r\n                        data.push(dataObject);\r\n                        validation.push(validationObject);\r\n                    });                \r\n                    var postJSON = {\r\n                        data: data,\r\n                        validation: validation,\r\n                        clientData: selectedClient\r\n                    };\r\n                    var objectPostString = JSON.stringify(postJSON);\r\n                    console.log(objectPostString);\r\n                    DataService.PostDeal(objectPostString).then(\r\n                        function (response) {\r\n                            vm.isLoading=false;\r\n                            if (response.data[0].Code == \"1\") {\r\n                                if (vm.dealId > 0) {\r\n                                    vm.ShowAlert(vm.$t('UpdatedSuccess', [vm.$t('Deal')]), \"success\", true, vm.$t(\"Alert\"));\r\n                                }\r\n                                else {\r\n                                    vm.ShowAlert(vm.$t('AddedSuccess', [vm.$t('Deal')]), \"success\", true, vm.$t(\"Alert\"));\r\n                                }\r\n                                vm.onCancel();\r\n                            }\r\n                            else {\r\n                                vm.ShowAlert(vm.$t('AddedError', [vm.$t('Deal')]), \"failure\", true, vm.$t(\"Alert\"));\r\n                            }                             \r\n                            vm.submited = false;\r\n                        })\r\n                }\r\n            });\r\n        },\r\n        onCancel: function () {\r\n            this.$router.push({ name: 'CRMDeal' });\r\n        },\r\n        UpdateSelectJson: function (name, json) {\r\n            $.each(this.GroupBy, function (index, item) {\r\n                $.each(item.Data, function (index, element) {\r\n                    if (element.name == name) {\r\n                        element.select_options = json;\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        openaddIndustrypopup: function (item) {        \r\n            this.IndustryItemObject = item;\r\n            this.showaddindustryModal = true;\r\n        },\r\n        openaddRoleTitlepopup: function (item) {\r\n            this.RoleTitleItemObject = item;\r\n            this.showaddroletitleModal = true;\r\n        },\r\n        openaddLeadSourcepopup: function (item) {\r\n            this.LeadSourceItemObject = item;\r\n            this.showaddleadsourceModal = true;\r\n        },\r\n        onBlur(item){\r\n                try {\r\n                    if(String(item.value).length>1){\r\n                    item.value = Number.parseFloat(item.value).toFixed(2);\r\n                    this.$refs.form.setFieldValue(item.name, item.value);\r\n                    }\r\n                } catch (ex) {\r\n\r\n                }\r\n            }, \r\n            getclientAssociatedWithAccount: function (accountId) {\r\n            var data = {\r\n                sourceId: '',\r\n                moduleName: 'CRM',\r\n                subModuleCode: 'CRM_DEALS',\r\n                accountName: '',\r\n                contactIds: [],\r\n                accountId: accountId\r\n            };\r\n            this.clientData = [];\r\n            var objectPostString = JSON.stringify(data);\r\n            DataService.ConvertLead(objectPostString).then(response => {\r\n                if (response.data[0].Status == \"Success\") {\r\n                    var json = this.MakeNormalArray(response.body[0].Value);\r\n                    this.clientData = json.CLIENTS;\r\n                    var textValue = {\r\n                        user_id: 0,\r\n                        first_name: '',\r\n                        last_name: '',\r\n                        email_id: '',\r\n                        account_id: accountId\r\n                    };\r\n                    this.clientData.push(textValue);\r\n                    this.isAccountSelected = true;\r\n                }\r\n                 \r\n                setTimeout(\"RadioButtonBootstrap()\", 500);\r\n                setTimeout(\"ResponsiveDataTable('tablelistingdata')\", 500);\r\n            });\r\n        }\r\n    },\r\n    \r\n};\r\n</script>\r\n\r\n<template>\r\n      <div>\r\n        <loader :is-visible=\"isLoading\"></loader>\r\n       \r\n       <section class=\"main-content\">\r\n           <div id=\"divMaindealData\" v-cloak>\r\n\r\n          <div class=\"row\">\r\n                   <div class=\"col-md-12 padding-t_8\">\r\n                       <div class=\"theme-primary partition-full\">\r\n                           <span class=\"p-name text-white\">Manage deal</span>\r\n                           <span class=\"float-right\">\r\n                               <!-- <a href=\"javascript:;\" class=\"p-action-btn text-white\" title=\"PageTour\" @click=\"setTourGuideSteps(0)\">\r\n                                   <em class=\"fa fa-road\" aria-hidden=\"true\"></em>\r\n                                   <br />PageTour\r\n                               </a> -->\r\n                           </span>\r\n                       </div>\r\n                   </div>\r\n               </div>\r\n\r\n\r\n               <div class=\"border p-3\">\r\n                   <Form v-slot=\"{ valid,errors}\" ref=\"form\">\r\n                       <DynamicForm :schema=\"GroupBy\" v-on:openaddIndustrypopup=\"openaddIndustrypopup\"\r\n                           :dateformat=\"GetUserInfo.DateFormat\" v-on:openaddRoleTitlepopup=\"openaddRoleTitlepopup\"\r\n                           v-on:openaddLeadSourcepopup=\"openaddLeadSourcepopup\" v-on:onchangechannel=\"onchangechannel\" \r\n                           v-on:onSearchDDL=\"onSearch\"  v-on:setSelectedValue=\"setSelectedValue\" v-on:onBlur=\"onBlur\"/>\r\n                       <div class=\"row flex-row-reverse mt-2\">\r\n                           <div class=\"col-lg-6 text-right\">\r\n                               <a href=\"javascript:;\" @click=\"onSubmit(valid,errors)\"\r\n                                  class=\"btn btn-success AddDealDetail_a\" title=\"Save\">\r\n                                   <em class=\"fa fa-save pr-2\"></em>Save\r\n                               </a>&nbsp;\r\n                               <a href=\"javascript:void(0)\" class=\"btn btn-danger\" title=\"Cancel\" @click=\"onCancel\">\r\n                                   <em class=\"fa fa-close pr-2\"></em>Cancel\r\n                               </a>\r\n                           </div>\r\n                           <div class=\"col-lg-6\">\r\n                               <div class=\"py-2\">\r\n<small class=\"text-danger\">{{$t('MandatoryString')}}</small>\r\n                               </div>\r\n                           </div>\r\n                       </div>\r\n                       <modaladdindustry v-if=\"showaddindustryModal\" @close=\"showaddindustryModal=false\"\r\n                           @updatedata=\"UpdateSelectJson\"></modaladdindustry>\r\n                       <modaladdroletitle v-if=\"showaddroletitleModal\" @close=\"showaddroletitleModal=false\"\r\n                           @updatedata=\"UpdateSelectJson\"></modaladdroletitle>\r\n                       <modaladdleadsource v-if=\"showaddleadsourceModal\" callFrom=\"deal\"\r\n                           @close=\"showaddleadsourceModal=false\" @updatedata=\"UpdateSelectJson\"></modaladdleadsource>\r\n\r\n                   </Form>\r\n               </div>\r\n           </div>\r\n       </section>\r\n      </div>\r\n        \r\n    \r\n</template>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Manage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Manage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Manage.vue?vue&type=template&id=810591da&\"\nimport script from \"./Manage.vue?vue&type=script&lang=js&\"\nexport * from \"./Manage.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}